<!DOCTYPE html>
<!-- saved from url=(0064)https://medium.com/@tg6897/design-in-memory-streams-e47e49068028 -->
<html lang="en" data-rh="lang"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Design In-memory Streams. Data streaming has become the backbone… | by Tushar Gupta | Medium</title><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-05-14T10:32:41.309Z"><meta data-rh="true" name="title" content="Design In-memory Streams. Data streaming has become the backbone… | by Tushar Gupta | Medium"><meta data-rh="true" property="og:title" content="Design In-memory Streams"><meta data-rh="true" property="al:android:url" content="medium://p/e47e49068028"><meta data-rh="true" property="al:ios:url" content="medium://p/e47e49068028"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="Data streaming has become the backbone of scalable systems as it helps process large volumes of real-time data which is further used in analytics or event-driven systems. Today we will work on…"><meta data-rh="true" property="og:description" content="Data streaming has become the backbone of scalable systems as it helps process large volumes of real-time data which is further used in…"><meta data-rh="true" property="og:url" content="https://medium.com/@tg6897/design-in-memory-streams-e47e49068028"><meta data-rh="true" property="al:web:url" content="https://medium.com/@tg6897/design-in-memory-streams-e47e49068028"><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*CkCNI9SsiPRmpCG45hZCzQ.png"><meta data-rh="true" property="article:author" content="https://medium.com/@tg6897"><meta data-rh="true" name="author" content="Tushar Gupta"><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" property="twitter:title" content="Design In-memory Streams"><meta data-rh="true" name="twitter:site" content="@Medium"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/e47e49068028"><meta data-rh="true" property="twitter:description" content="Data streaming has become the backbone of scalable systems as it helps process large volumes of real-time data which is further used in…"><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*CkCNI9SsiPRmpCG45hZCzQ.png"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:label1" content="Reading time"><meta data-rh="true" name="twitter:data1" content="21 min read"><meta data-rh="true" name="twitter:tile:template:testing" content="2"><meta data-rh="true" name="twitter:tile:image" content="https://miro.medium.com/v2/resize:fit:1200/1*CkCNI9SsiPRmpCG45hZCzQ.png"><meta data-rh="true" name="twitter:tile:info1:icon" content="Person"><meta data-rh="true" name="twitter:tile:info1:text" content="Tushar Gupta"><meta data-rh="true" name="twitter:tile:info2:icon" content="Calendar"><meta data-rh="true" name="twitter:tile:info2:text" content="May 14, 2023"><meta data-rh="true" name="twitter:cta" content="Read on Medium"><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/1*m-R_BkNf1Qjr1YbyOIJY2w.png"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://medium.com/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:152:152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:120:120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:76:76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:60:60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"><link data-rh="true" rel="preconnect" href="https://glyph.medium.com/" crossorigin=""><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="./Design In-memory Streams._files/unbound.css"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="./Design In-memory Streams._files/unbound.css"><link data-rh="true" rel="author" href="https://medium.com/@tg6897"><link data-rh="true" rel="canonical" href="https://medium.com/@tg6897/design-in-memory-streams-e47e49068028"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/e47e49068028"><style type="text/css" data-fela-rehydration="680" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="680" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-webkit-keyframes k2{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-moz-keyframes k2{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@keyframes k2{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-webkit-keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-moz-keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-webkit-keyframes k2{0%{opacity:0}100%{opacity:1}}@-moz-keyframes k2{0%{opacity:0}100%{opacity:1}}@keyframes k2{0%{opacity:0}100%{opacity:1}}</style><style type="text/css" data-fela-rehydration="680" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{fill:rgba(0, 0, 0, 1)}.av{height:22px}.aw{margin-left:16px}.ax{border:none}.ay{border-radius:20px}.az{width:240px}.ba{background:#F9F9F9}.bb path{fill:#6B6B6B}.bd{outline:none}.be{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bf{font-size:14px}.bg{width:100%}.bh{padding:10px 20px 10px 0}.bi{background-color:transparent}.bj{color:#242424}.bk::placeholder{color:#6B6B6B}.bl{display:inline-block}.bm{margin-left:12px}.bn{margin-right:12px}.bo{border-radius:4px}.bp{margin-left:24px}.bq{height:24px}.bw{background-color:#F9F9F9}.bx{border-radius:50%}.by{height:32px}.bz{width:32px}.ca{justify-content:center}.cg{max-width:680px}.ch{min-width:0}.ci{animation:k1 1.2s ease-in-out infinite}.cj{height:100vh}.ck{margin-bottom:16px}.cl{margin-top:48px}.cm{align-items:flex-start}.cn{flex-direction:column}.co{justify-content:space-between}.cp{margin-bottom:24px}.cv{width:80%}.cw{background-color:#F2F2F2}.dc{height:44px}.dd{width:44px}.de{margin:auto 0}.df{margin-bottom:4px}.dg{height:16px}.dh{width:120px}.di{width:80px}.do{margin-bottom:8px}.dp{width:96%}.dq{width:98%}.dr{width:81%}.dx{margin:0 24px}.eb{background:rgba(255, 255, 255, 1)}.ec{box-sizing:border-box}.ed{border:1px solid #F2F2F2}.ee{box-shadow:0 1px 4px #F2F2F2}.ef{max-height:100vh}.eg{overflow-y:auto}.eh{position:absolute}.ei{left:0}.ej{top:calc(100vh + 100px)}.ek{bottom:calc(100vh + 100px)}.el{width:10px}.em{pointer-events:none}.eo{word-break:break-word}.ep{word-wrap:break-word}.eq:after{display:block}.er:after{content:""}.es:after{clear:both}.et{line-height:1.23}.eu{letter-spacing:0}.ev{font-style:normal}.ew{font-weight:700}.fw{@media all and (max-width: 551.98px):8px}.fx{@media all and (min-width: 552px) and (max-width: 727.98px):8px}.fy{@media all and (min-width: 728px) and (max-width: 903.98px):16px}.fz{@media all and (min-width: 904px) and (max-width: 1079.98px):16px}.ga{@media all and (min-width: 1080px):16px}.gg{align-items:baseline}.gh{width:48px}.gi{height:48px}.gj{border:2px solid rgba(255, 255, 255, 1)}.gk{z-index:0}.gl{box-shadow:none}.gm{border:1px solid rgba(0, 0, 0, 0.05)}.go{position:relative}.gp{margin-bottom:2px}.gq{flex-wrap:nowrap}.gr{font-size:16px}.gs{line-height:24px}.gu{margin:0 8px}.gv{display:inline}.gw{color:#6B6B6B}.gx{color:#1A8917}.gy{fill:#1A8917}.gz:disabled{opacity:0.3}.hc{flex:0 0 auto}.hf{flex-wrap:wrap}.hg{padding-left:8px}.hh{padding-right:8px}.ii> *{flex-shrink:0}.ij{overflow-x:scroll}.ik::-webkit-scrollbar{display:none}.il{scrollbar-width:none}.im{-ms-overflow-style:none}.ip{width:74px}.iq{flex-direction:row}.ir{margin-right:4px}.iu{-webkit-user-select:none}.iv{border:0}.iw{cursor:progress}.ix{fill:rgba(117, 117, 117, 1)}.ja{opacity:0.25}.jb{outline:0}.jc{user-select:none}.jd> svg{pointer-events:none}.jm{font-size:13px}.jn{margin-left:4px}.jo{margin-top:0px}.jp{opacity:1}.jq{padding:4px 0}.jr{fill:#6B6B6B}.ju{width:16px}.jv{display:inline-flex}.kb{max-width:100%}.kc{padding:8px 2px}.kd svg{color:#6B6B6B}.ku{line-height:1.58}.kv{letter-spacing:-0.004em}.kw{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.lr{margin-bottom:-0.46em}.ls{text-decoration:underline}.lt{margin-top:32px}.lu{margin-bottom:14px}.lv{padding-top:24px}.lw{padding-bottom:10px}.lx{background-color:#000000}.ly{height:3px}.lz{width:3px}.ma{margin-right:20px}.mb{line-height:1.18}.mc{letter-spacing:-0.022em}.md{font-weight:600}.mv{margin-bottom:-0.31em}.mw{margin-left:auto}.mx{margin-right:auto}.my{max-width:2529px}.ne{clear:both}.ng{cursor:zoom-in}.nh{z-index:auto}.nj{height:auto}.nk{list-style-type:disc}.nl{margin-left:30px}.nm{padding-left:0px}.nn{font-style:italic}.ny{list-style-type:decimal}.nz{max-width:220px}.oa{max-width:1861px}.ob{line-height:1.12}.ou{margin-bottom:-0.28em}.ov{overflow-x:auto}.ow{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.ox{padding:32px}.oy{border:1px solid #E5E5E5}.oz{line-height:1.4}.pa{margin-top:-0.2em}.pb{margin-bottom:-0.2em}.pc{white-space:pre}.pd{min-width:fit-content}.pe{max-width:896px}.pf{margin-top:10px}.pg{text-align:center}.ph{max-width:728px}.pk{max-width:1180px}.pl{max-width:978px}.pm{max-width:500px}.pn{margin-bottom:26px}.po{margin-top:6px}.pp{margin-top:8px}.pq{margin-right:8px}.pr{padding:8px 16px}.ps{border-radius:100px}.pt{transition:background 300ms ease}.pv{white-space:nowrap}.pw{border-top:none}.qc{height:52px}.qd{max-height:52px}.qe{box-sizing:content-box}.qf{position:static}.qg{z-index:1}.qi{max-width:155px}.qt{align-items:flex-end}.qu{width:76px}.qv{height:76px}.qw{border:2px solid #F9F9F9}.qx{height:72px}.qy{width:72px}.qz{color:#FFFFFF}.ra{fill:#FFFFFF}.rb{background:#1A8917}.rc{border-color:#1A8917}.rg:disabled{cursor:inherit !important}.rh:disabled:hover{background:#1A8917}.ri:disabled:hover{border-color:#1A8917}.rj{border-radius:99em}.rk{width:auto}.rl{border-width:1px}.rm{border-style:solid}.rn{text-decoration:none}.ro{margin-left:8px}.rp{stroke:#F2F2F2}.rq{height:36px}.rr{width:36px}.rs{color:#F2F2F2}.rt{fill:#F2F2F2}.ru{background:#F2F2F2}.rv{border-color:#F2F2F2}.sb{font-weight:500}.sc{font-size:24px}.sd{line-height:30px}.se{letter-spacing:-0.016em}.sf{margin-top:16px}.sg{height:0px}.sh{border-bottom:solid 1px #E5E5E5}.sn{margin-bottom:32px}.so{margin-top:40px}.sp{align-items:stretch}.tz{flex-grow:0}.uf{height:100%}.ug{display:grid}.uh{grid-template-columns:repeat(12, 1fr)}.ui{grid-template-rows:auto 1fr}.ut{grid-area:image}.uu{grid-area:content}.va{border-radius:2px}.vb{aspect-ratio:2}.vc{object-fit:cover}.vd{object-position:50% 50%}.vj{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.vk{height:20px}.vl{width:20px}.vm{padding-right:4px}.vn{overflow:hidden}.vo{max-height:20px}.vp{text-overflow:ellipsis}.vq{display:-webkit-box}.vr{-webkit-line-clamp:1}.vs{-webkit-box-orient:vertical}.vt{word-break:break-all}.wp{padding-top:8px}.wq{max-height:40px}.wr{-webkit-line-clamp:2}.xh{margin-left:20px}.xi{justify-content:flex-end}.xj{flex:0 0 0}.xq{fill:#242424}.xr{background:0}.xs{border-color:#242424}.xv:disabled:hover{color:#242424}.xw:disabled:hover{fill:#242424}.xx:disabled:hover{border-color:#242424}.yi{padding-bottom:40px}.yj{padding-top:88px}.yk{margin-bottom:40px}.yl{margin-top:4px}.ym{border-right:3px solid #F9F9F9}.yn{z-index:3}.yo{z-index:2}.yp{margin-left:-24px}.yq{margin-left:-36px}.yr{border-radius:0 3px 3px 0}.ys{width:93px}.zb{margin-top:72px}.zc{padding:24px 0}.zd{margin-bottom:0px}.ze{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.gn:hover{background-color:rgba(0, 0, 0, 0.1)}.gt:hover{text-decoration:underline}.ha:hover:not(:disabled){color:#156D12}.hb:hover:not(:disabled){fill:#156D12}.iz:hover{fill:rgba(117, 117, 117, 1)}.js:hover{fill:#000000}.jt:hover p{color:#000000}.ke:hover svg{color:#000000}.pu:hover{background-color:#F2F2F2}.rd:hover{background:#156D12}.re:hover{border-color:#156D12}.rf:hover{cursor:pointer}.rw:hover{background:#F2F2F2}.rx:hover{border-color:#F2F2F2}.ry:hover{cursor:wait}.rz:hover{color:#F2F2F2}.sa:hover{fill:#F2F2F2}.xt:hover{color:#000000}.xu:hover{border-color:#242424}.bc:focus-within path{fill:#242424}.iy:focus{fill:rgba(117, 117, 117, 1)}.kf:focus svg{color:#000000}.ni:focus{transform:scale(1.01)}.je:active{border-style:none}</style><style type="text/css" data-fela-rehydration="680" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.dw{margin-bottom:68px}.ea{max-width:680px}.fr{font-size:42px}.fs{margin-top:1.19em}.ft{margin-bottom:32px}.fu{line-height:52px}.fv{letter-spacing:-0.011em}.gf{align-items:center}.hu{border-top:solid 1px #F2F2F2}.hv{border-bottom:solid 1px #F2F2F2}.hw{margin:32px 0 0}.hx{padding:3px 8px}.ig> *{margin-right:24px}.ih> :last-child{margin-right:0}.io{display:flex}.jl{margin-top:0px}.ka{margin:0}.ln{font-size:20px}.lo{margin-top:2.14em}.lp{line-height:32px}.lq{letter-spacing:-0.003em}.ms{margin-top:1.72em}.mt{line-height:24px}.mu{letter-spacing:0}.nd{margin-top:56px}.ns{margin-top:1.14em}.nx{margin-top:0.94em}.oq{font-size:24px}.or{margin-top:1.25em}.os{line-height:30px}.ot{letter-spacing:-0.016em}.qb{margin-bottom:88px}.qn{display:inline-block}.qs{padding-top:72px}.sm{margin-top:40px}.tc{width:calc(100% + 32px)}.td{margin-left:-16px}.te{margin-right:-16px}.tv{padding-left:16px}.tw{padding-right:16px}.tx{flex-basis:50%}.ty{max-width:50%}.ue{padding-bottom:56px}.ur{gap:24px 0}.us{grid-template-areas:"image image image image image image image image image image image image" "content content content content content content content content content content content content"}.uz{display:block}.vi{margin-bottom:16px}.wd{padding-bottom:16px}.we{flex:1 0 auto}.wn{max-height:48px}.wo{-webkit-line-clamp:2}.ww{padding-top:16px}.xf{max-width:56%}.xg{flex:1 0 0}.xm{margin-bottom:24px}.xp{flex-direction:row}.yc{width:min-width}.yh{margin-top:96px}.yz{margin-top:24px}.za{margin-bottom:56px}</style><style type="text/css" data-fela-rehydration="680" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.jk{margin-top:0px}.pi{margin-left:auto}.pj{text-align:center}.qm{display:inline-block}</style><style type="text/css" data-fela-rehydration="680" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.jj{margin-top:0px}.ql{display:inline-block}</style><style type="text/css" data-fela-rehydration="680" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.jh{margin-top:0px}.ji{margin-right:0px}.qk{display:inline-block}</style><style type="text/css" data-fela-rehydration="680" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.br{width:24px}.cb{margin:0 24px}.cq{height:40px}.cx{margin-bottom:44px}.dj{margin-bottom:32px}.ds{margin-bottom:4px}.ex{font-size:32px}.ey{margin-top:1.01em}.ez{margin-bottom:24px}.fa{line-height:38px}.fb{letter-spacing:-0.014em}.gb{align-items:flex-start}.hd{flex-direction:column}.hi{margin:24px -24px 0}.hj{padding:0}.hy> *{margin-right:8px}.hz> :last-child{margin-right:24px}.is{margin-left:0px}.jf{margin-top:0px}.jg{margin-right:0px}.jw{margin:0}.kg{border:1px solid #F2F2F2}.kh{border-radius:99em}.ki{padding:0px 16px 0px 12px}.kj{height:38px}.kk{align-items:center}.km svg{margin-right:8px}.kx{font-size:18px}.ky{margin-top:1.56em}.kz{line-height:28px}.la{letter-spacing:-0.003em}.me{font-size:16px}.mf{margin-top:1.23em}.mg{line-height:20px}.mh{letter-spacing:0}.mz{margin-top:40px}.no{margin-top:1.34em}.nt{margin-top:0.67em}.oc{font-size:20px}.od{margin-top:0.93em}.oe{line-height:24px}.px{margin-bottom:80px}.qj{display:inline-block}.qo{padding-top:48px}.si{margin-top:32px}.sq{width:calc(100% + 24px)}.sr{margin-left:-12px}.ss{margin-right:-12px}.tf{padding-left:12px}.tg{padding-right:12px}.th{flex-basis:100%}.ti{max-width:100%}.ua{padding-bottom:32px}.uj{gap:24px 0}.uk{grid-template-areas:"image image image image image image image image image image image image" "content content content content content content content content content content content content"}.uv{display:block}.ve{margin-bottom:16px}.vv{padding-bottom:16px}.vw{flex:1 0 auto}.wf{max-height:48px}.wg{-webkit-line-clamp:2}.ws{padding-top:16px}.wx{max-width:56%}.wy{flex:1 0 0}.xy{width:100%}.yd{margin-top:72px}.yt{margin-top:16px}.kl:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="680" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bu{width:64px}.ce{margin:0 64px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.dv{margin-bottom:68px}.dz{max-width:680px}.fm{font-size:42px}.fn{margin-top:1.19em}.fo{margin-bottom:32px}.fp{line-height:52px}.fq{letter-spacing:-0.011em}.ge{align-items:center}.hq{border-top:solid 1px #F2F2F2}.hr{border-bottom:solid 1px #F2F2F2}.hs{margin:32px 0 0}.ht{padding:3px 8px}.ie> *{margin-right:24px}.if> :last-child{margin-right:0}.in{display:flex}.jz{margin:0}.lj{font-size:20px}.lk{margin-top:2.14em}.ll{line-height:32px}.lm{letter-spacing:-0.003em}.mp{margin-top:1.72em}.mq{line-height:24px}.mr{letter-spacing:0}.nc{margin-top:56px}.nr{margin-top:1.14em}.nw{margin-top:0.94em}.om{font-size:24px}.on{margin-top:1.25em}.oo{line-height:30px}.op{letter-spacing:-0.016em}.qa{margin-bottom:88px}.qr{padding-top:72px}.sl{margin-top:40px}.sz{width:calc(100% + 32px)}.ta{margin-left:-16px}.tb{margin-right:-16px}.tr{padding-left:16px}.ts{padding-right:16px}.tt{flex-basis:50%}.tu{max-width:50%}.ud{padding-bottom:56px}.up{gap:24px 0}.uq{grid-template-areas:"image image image image image image image image image image image image" "content content content content content content content content content content content content"}.uy{display:block}.vh{margin-bottom:16px}.wb{padding-bottom:16px}.wc{flex:1 0 auto}.wl{max-height:48px}.wm{-webkit-line-clamp:2}.wv{padding-top:16px}.xd{max-width:56%}.xe{flex:1 0 0}.xl{margin-bottom:24px}.xo{flex-direction:row}.yb{width:min-width}.yg{margin-top:96px}.yx{margin-top:24px}.yy{margin-bottom:56px}</style><style type="text/css" data-fela-rehydration="680" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bt{width:64px}.cd{margin:0 48px}.cs{height:48px}.cz{margin-bottom:52px}.dl{margin-bottom:48px}.du{margin-bottom:68px}.dy{max-width:680px}.fh{font-size:42px}.fi{margin-top:1.19em}.fj{margin-bottom:32px}.fk{line-height:52px}.fl{letter-spacing:-0.011em}.gd{align-items:center}.hm{border-top:solid 1px #F2F2F2}.hn{border-bottom:solid 1px #F2F2F2}.ho{margin:32px 0 0}.hp{padding:3px 8px}.ic> *{margin-right:24px}.id> :last-child{margin-right:0}.jy{margin:0}.lf{font-size:20px}.lg{margin-top:2.14em}.lh{line-height:32px}.li{letter-spacing:-0.003em}.mm{margin-top:1.72em}.mn{line-height:24px}.mo{letter-spacing:0}.nb{margin-top:56px}.nq{margin-top:1.14em}.nv{margin-top:0.94em}.oi{font-size:24px}.oj{margin-top:1.25em}.ok{line-height:30px}.ol{letter-spacing:-0.016em}.pz{margin-bottom:88px}.qq{padding-top:72px}.sk{margin-top:40px}.sw{width:calc(100% + 28px)}.sx{margin-left:-14px}.sy{margin-right:-14px}.tn{padding-left:14px}.to{padding-right:14px}.tp{flex-basis:50%}.tq{max-width:50%}.uc{padding-bottom:56px}.un{gap:24px 0}.uo{grid-template-areas:"image image image image image image image image image image image image" "content content content content content content content content content content content content"}.ux{display:block}.vg{margin-bottom:16px}.vz{padding-bottom:16px}.wa{flex:1 0 auto}.wj{max-height:48px}.wk{-webkit-line-clamp:2}.wu{padding-top:16px}.xb{max-width:56%}.xc{flex:1 0 0}.xk{margin-bottom:24px}.xn{flex-direction:row}.ya{width:min-width}.yf{margin-top:96px}.yv{margin-top:24px}.yw{margin-bottom:56px}</style><style type="text/css" data-fela-rehydration="680" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dt{margin-bottom:4px}.fc{font-size:32px}.fd{margin-top:1.01em}.fe{margin-bottom:24px}.ff{line-height:38px}.fg{letter-spacing:-0.014em}.gc{align-items:flex-start}.he{flex-direction:column}.hk{margin:24px 0 0}.hl{padding:0}.ia> *{margin-right:8px}.ib> :last-child{margin-right:8px}.it{margin-left:0px}.jx{margin:0}.kn{border:1px solid #F2F2F2}.ko{border-radius:99em}.kp{padding:0px 16px 0px 12px}.kq{height:38px}.kr{align-items:center}.kt svg{margin-right:8px}.lb{font-size:18px}.lc{margin-top:1.56em}.ld{line-height:28px}.le{letter-spacing:-0.003em}.mi{font-size:16px}.mj{margin-top:1.23em}.mk{line-height:20px}.ml{letter-spacing:0}.na{margin-top:40px}.np{margin-top:1.34em}.nu{margin-top:0.67em}.of{font-size:20px}.og{margin-top:0.93em}.oh{line-height:24px}.py{margin-bottom:80px}.qp{padding-top:48px}.sj{margin-top:32px}.st{width:calc(100% + 24px)}.su{margin-left:-12px}.sv{margin-right:-12px}.tj{padding-left:12px}.tk{padding-right:12px}.tl{flex-basis:100%}.tm{max-width:100%}.ub{padding-bottom:32px}.ul{gap:24px 0}.um{grid-template-areas:"image image image image image image image image image image image image" "content content content content content content content content content content content content"}.uw{display:block}.vf{margin-bottom:16px}.vx{padding-bottom:16px}.vy{flex:1 0 auto}.wh{max-height:48px}.wi{-webkit-line-clamp:2}.wt{padding-top:16px}.wz{max-width:56%}.xa{flex:1 0 0}.xz{width:100%}.ye{margin-top:72px}.yu{margin-top:16px}.ks:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="680" data-fela-type="RULE" media="print">.qh{display:none}</style><style type="text/css" data-fela-rehydration="680" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.nf{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><style type="text/css" data-fela-rehydration="680" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.vu{max-height:none}</style><script async="" src="./Design In-memory Streams._files/branch-latest.min.js.download"></script><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*CkCNI9SsiPRmpCG45hZCzQ.png"],"url":"https:\u002F\u002Fmedium.com\u002F@tg6897\u002Fdesign-in-memory-streams-e47e49068028","dateCreated":"2023-05-14T10:13:00.855Z","datePublished":"2023-05-14T10:13:00.855Z","dateModified":"2023-05-14T10:32:46.665Z","headline":"Design In-memory Streams - Tushar Gupta - Medium","name":"Design In-memory Streams - Tushar Gupta - Medium","description":"Data streaming has become the backbone of scalable systems as it helps process large volumes of real-time data which is further used in analytics or event-driven systems. Today we will work on…","identifier":"e47e49068028","author":{"@type":"Person","name":"Tushar Gupta","url":"https:\u002F\u002Fmedium.com\u002F@tg6897"},"creator":["Tushar Gupta"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fmedium.com\u002F","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:308\u002F1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002F@tg6897\u002Fdesign-in-memory-streams-e47e49068028"}</script><script async="true" src="./Design In-memory Streams._files/js" data-rh="true"></script><script data-rh="true">window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-7JY7T788PK');</script><script type="text/javascript" data-rh="true">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0);
branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {metadata: {}, 'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled': null}, function(err, data) {});</script><meta http-equiv="origin-trial" content="A+N5HpM5gDAUeupaWw3J2yuMrpgH0IC7KtFHAqtmHkW8Vr+dPpJWuOpMNIRh3ybxyoIUKlvDQs7+VGPfYdQ/qQUAAABxeyJvcmlnaW4iOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb206NDQzIiwiZmVhdHVyZSI6IkZlZENtQXV0b1JlYXV0aG4iLCJleHBpcnkiOjE2OTE1MzkxOTksImlzVGhpcmRQYXJ0eSI6dHJ1ZX0="><style id="googleidentityservice_button_styles">.qJTHM{-webkit-user-select:none;color:#202124;direction:ltr;-webkit-touch-callout:none;font-family:"Roboto-Regular",arial,sans-serif;-webkit-font-smoothing:antialiased;font-weight:400;margin:0;overflow:hidden;-webkit-text-size-adjust:100%}.ynRLnc{left:-9999px;position:absolute;top:-9999px}.L6cTce{display:none}.bltWBb{word-break:break-all}.hSRGPd{color:#1a73e8;cursor:pointer;font-weight:500;text-decoration:none}.Bz112c-W3lGp{height:16px;width:16px}.Bz112c-E3DyYd{height:20px;width:20px}.Bz112c-r9oPif{height:24px;width:24px}.Bz112c-uaxL4e{-webkit-border-radius:10px;border-radius:10px}.LgbsSe-Bz112c{display:block}.S9gUrf-YoZ4jf,.S9gUrf-YoZ4jf *{border:none;margin:0;padding:0}.fFW7wc-ibnC6b>.aZ2wEe>div{border-color:#4285f4}.P1ekSe-ZMv3u>div:nth-child(1){background-color:#1a73e8!important}.P1ekSe-ZMv3u>div:nth-child(2),.P1ekSe-ZMv3u>div:nth-child(3){background-image:linear-gradient(to right,rgba(255,255,255,.7),rgba(255,255,255,.7)),linear-gradient(to right,#1a73e8,#1a73e8)!important}.haAclf{display:inline-block}.nsm7Bb-HzV7m-LgbsSe{-webkit-border-radius:4px;border-radius:4px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-transition:background-color .218s,border-color .218s;transition:background-color .218s,border-color .218s;-webkit-user-select:none;-webkit-appearance:none;background-color:#fff;background-image:none;border:1px solid #dadce0;color:#3c4043;cursor:pointer;font-family:"Google Sans",arial,sans-serif;font-size:14px;height:40px;letter-spacing:0.25px;outline:none;overflow:hidden;padding:0 12px;position:relative;text-align:center;vertical-align:middle;white-space:nowrap;width:auto}@media screen and (-ms-high-contrast:active){.nsm7Bb-HzV7m-LgbsSe{border:2px solid windowText;color:windowText}}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe{font-size:14px;height:32px;letter-spacing:0.25px;padding:0 10px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe{font-size:11px;height:20px;letter-spacing:0.3px;padding:0 8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe{padding:0;width:40px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe{width:32px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe{width:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK{-webkit-border-radius:20px;border-radius:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.pSzOP-SxQuSe{-webkit-border-radius:16px;border-radius:16px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.purZT-SxQuSe{-webkit-border-radius:10px;border-radius:10px}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc{border:none;color:#fff}.nsm7Bb-HzV7m-LgbsSe.MFS4be-v3pZbf-Ia7Qfc{background-color:#1a73e8}.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{background-color:#202124;color:#e8eaed}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:18px;margin-right:8px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:14px;min-width:14px;width:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:10px;min-width:10px;width:10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin-left:8px;margin-right:-4px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:10px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:4px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-top-left-radius:3px;border-top-left-radius:3px;-webkit-border-bottom-left-radius:3px;border-bottom-left-radius:3px;display:-webkit-box;display:-webkit-flex;display:flex;justify-content:center;-webkit-align-items:center;align-items:center;background-color:#fff;height:36px;margin-left:-10px;margin-right:12px;min-width:36px;width:36px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c,.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:28px;margin-left:-8px;margin-right:10px;min-width:28px;width:28px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:16px;margin-left:-6px;margin-right:8px;min-width:16px;width:16px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:3px;border-radius:3px;margin-left:2px;margin-right:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:18px;border-radius:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:14px;border-radius:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:8px;border-radius:8px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-bN97Pc-sM5MNb{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex-direction:row;flex-direction:row;justify-content:space-between;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;height:100%;position:relative;width:100%}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX{justify-content:center}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:1;flex-grow:1;font-family:"Google Sans",arial,sans-serif;font-weight:500;overflow:hidden;text-overflow:ellipsis;vertical-align:top}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-weight:300}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:0;flex-grow:0}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-MJoBVe{-webkit-transition:background-color .218s;transition:background-color .218s;bottom:0;left:0;position:absolute;right:0;top:0}.nsm7Bb-HzV7m-LgbsSe:hover,.nsm7Bb-HzV7m-LgbsSe:focus{-webkit-box-shadow:none;box-shadow:none;border-color:#d2e3fc;outline:none}.nsm7Bb-HzV7m-LgbsSe:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.04)}.nsm7Bb-HzV7m-LgbsSe:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.1)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.24)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.32)}.nsm7Bb-HzV7m-LgbsSe .n1UuX-DkfjY{-webkit-border-radius:50%;border-radius:50%;display:-webkit-box;display:-webkit-flex;display:flex;height:20px;margin-left:-4px;margin-right:8px;min-width:20px;width:20px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-family:"Roboto";font-size:12px;text-align:left}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .ssJRIf,.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .fmcmS{overflow:hidden;text-overflow:ellipsis}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;color:#5f6368;fill:#5f6368;font-size:11px;font-weight:400}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#e8eaed;fill:#e8eaed}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .Bz112c{height:18px;margin:-3px -3px -3px 2px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-top-left-radius:0;border-top-left-radius:0;-webkit-border-bottom-left-radius:0;border-bottom-left-radius:0;-webkit-border-top-right-radius:3px;border-top-right-radius:3px;-webkit-border-bottom-right-radius:3px;border-bottom-right-radius:3px;margin-left:12px;margin-right:-10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:18px;border-radius:18px}.L5Fo6c-sM5MNb{border:0;display:block;left:0;position:relative;top:0}.L5Fo6c-bF1uUb{-webkit-border-radius:4px;border-radius:4px;bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.L5Fo6c-bF1uUb:focus{border:none;outline:none}sentinel{}</style><link id="googleidentityservice" type="text/css" media="all" rel="stylesheet" href="./Design In-memory Streams._files/style"></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><div class="l c"><div class="l m n o c" style="transform: translateY(0px);"><div class="p q r s t u v w x i d y z"><a class="gw ag jm be ak b am an ao ap aq ar as at s u w i d q uf z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe47e49068028&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---two_column_layout_nav----------------------------------" rel="noopener follow">Open in app<svg width="10" height="10" viewBox="0 0 10 10" fill="none" class="ro"><path d="M.98 8.48a.37.37 0 1 0 .54.54l-.54-.54zm7.77-7.23h.38c0-.2-.17-.38-.38-.38v.38zM8.37 6.5a.37.37 0 1 0 .76 0h-.76zM3.5.87a.37.37 0 1 0 0 .76V.88zM1.52 9.03l7.5-7.5-.54-.54-7.5 7.5.54.54zm6.86-7.77V6.5h.74V1.25h-.74zm-4.88.38h5.25V.88H3.5v.74z" fill="currentColor"></path></svg></a><div class="ab q"><p class="be b abj mg abk mk abl abm abn abo abp abq gw"><span><button class="be b abj mg abr abk mk abs abl abm abt abn abo abu abp abq abv qz ra rb rc rd re rf rg gz rh ri rj rl rm ec bl rn pg" data-testid="headerSignUpButton">Sign up</button></span></p><div class="aw l"><p class="be b abj mg abk mk abl abm abn abo abp abq gw"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40tg6897%2Fdesign-in-memory-streams-e47e49068028&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="https://medium.com/?source=---two_column_layout_nav----------------------------------"><svg viewBox="0 0 3940 610" class="au av"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg></a><div class="aw h"><div class="ab ax ay az ba q bb bc"><div class="bl" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bm bn ab"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ax bd be bf z bg bh bi bj bk" placeholder="Search" value=""></div></div></div><div class="h k w in io"><div class="abw ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---two_column_layout_nav-----------------------new_post_topnav-----------"><div class="be b bf z gw go jr ab q abx aby"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Write"><path d="M14 4a.5.5 0 0 0 0-1v1zm7 6a.5.5 0 0 0-1 0h1zm-7-7H4v1h10V3zM3 4v16h1V4H3zm1 17h16v-1H4v1zm17-1V10h-1v10h1zm-1 1a1 1 0 0 0 1-1h-1v1zM3 20a1 1 0 0 0 1 1v-1H3zM4 3a1 1 0 0 0-1 1h1V3z" fill="currentColor"></path><path d="M17.5 4.5l-8.46 8.46a.25.25 0 0 0-.06.1l-.82 2.47c-.07.2.12.38.31.31l2.47-.82a.25.25 0 0 0 .1-.06L19.5 6.5m-2-2l2.32-2.32c.1-.1.26-.1.36 0l1.64 1.64c.1.1.1.26 0 .36L19.5 6.5m-2-2l2 2" stroke="currentColor"></path></svg><div class="ro l">Write</div></div></a></span></div></div><div class="k j i d"><div class="abw ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="https://medium.com/search?source=---two_column_layout_nav----------------------------------"><div class="be b bf z gw go jr ab q abx aby"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Search"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div></a></div></div><div class="abw h k j"><div class="ab q"><p class="be b abj mg abk mk abl abm abn abo abp abq gw"><span><button class="be b abj mg abr abk mk abs abl abm abt abn abo abu abp abq abv qz ra rb rc rd re rf rg gz rh ri rj rl rm ec bl rn pg" data-testid="headerSignUpButton">Sign up</button></span></p><div class="aw l"><p class="be b abj mg abk mk abl abm abn abo abp abq gw"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40tg6897%2Fdesign-in-memory-streams-e47e49068028&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ax abz am ab q ao aca acb acc" aria-label="user options menu" data-testid="headerUserIcon"><div class="l go"><img alt="" class="l ec bx by bz cw" src="./Design In-memory Streams._files/1_dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"><div class="vj bx l by bz eh n ax gn"></div></div></button></div></div></div><div class="l"><div class="qh" role="dialog" aria-modal="true" tabindex="-1"><div class="zm zn bg uf zo zp zq ao zr em zs" aria-hidden="true" role="presentation"></div><div class="zt zo zu zv zw zm uf ec zx zy zz jp aba abb abc abd abe abf abg abh abi" aria-hidden="true"></div></div><div class="ds dt du dv dw l"><div class="ab ca"><div class="ch bg dx dy dz ea"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="eh ei ej ek el em"></div><div class="eo ep eq er es"><div class="ab ca"><div class="ch bg dx dy dz ea"><div><h1 id="69ea" class="pw-post-title et eu ev be ew ex ey ez fa fb fc fd fe ff fg fh fi fj fk fl fm fn fo fp fq fr fs ft fu fv bj" data-testid="storyTitle" data-selectable-paragraph="">Design In-memory Streams</h1><div class="zf zg zh zi zj"><div class="speechify-ignore ab co"><div class="speechify-ignore bg l"><div class="gb gc gd ge gf ab"><div><div class="ab gg"><a rel="noopener follow" href="https://medium.com/@tg6897?source=post_page-----e47e49068028--------------------------------"><div><div class="bl" aria-hidden="false" aria-describedby="1" aria-labelledby="1"><div class="l gh gi bx gj gk"><div class="l go"><img alt="Tushar Gupta" class="l ec bx dc dd cw" src="./Design In-memory Streams._files/0_oTCZ2-qduIllbJVV.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"><div class="gl bx l dc dd eh n gm gn"></div></div></div></div></div></a></div></div><div class="bm bg l"><div class="ab"><div style="flex: 1 1 0%;"><span class="be b bf z bj"><div class="gp ab q"><div class="ab q gq"><div class="ab q"><div><div class="bl" aria-hidden="false" aria-describedby="2" aria-labelledby="2"><p class="be b gr gs bj"><a class="af ag ah ai aj ak al am an ao ap aq ar gt" data-testid="authorName" rel="noopener follow" href="https://medium.com/@tg6897?source=post_page-----e47e49068028--------------------------------">Tushar Gupta</a></p></div></div></div><span class="gu gv" aria-hidden="true"><span class="be b bf z gw">·</span></span><p class="be b gr gs gw"><span><a class="gx gy ah ai aj ak al am an ao ap aq ar gz ha hb" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbf5235fee8bb&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40tg6897%2Fdesign-in-memory-streams-e47e49068028&amp;user=Tushar+Gupta&amp;userId=bf5235fee8bb&amp;source=post_page-bf5235fee8bb----e47e49068028---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l hc"><span class="be b bf z gw"><div class="ab cm hd he hf"><span class="be b bf z gw"><div class="ab ae"><span data-testid="storyReadTime">21 min read</span><div class="hg hh l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="be b bf z gw">·</span></span></div><span data-testid="storyPublishDate">May 14</span></div></span></div></span></div></div></div><div class="ab co hi hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx"><div class="h k w in io q"><div class="ip l"><div class="ab q iq"><div class="pw-multi-vote-icon go ir is it iu"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fe47e49068028&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40tg6897%2Fdesign-in-memory-streams-e47e49068028&amp;user=Tushar+Gupta&amp;userId=bf5235fee8bb&amp;source=-----e47e49068028---------------------clap_footer-----------"><div><div class="bl" aria-hidden="false" aria-describedby="147" aria-labelledby="147"><div class="iv ao ix acd ace jb am jc jd je iu"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l jf jg jh ji jj jk jl"><div><div class="bl" aria-hidden="false" aria-describedby="148" aria-labelledby="148"><p class="be b jm z gw"><button class="af ag ah ai aj ak al am an ao ap aq ar as at acf xt">57<span class="l h g f qm qn"></span></button></p></div></div></div></div></div><div><div class="bl" aria-hidden="false" aria-describedby="3" aria-labelledby="3"><button class="ao iv jp jq ab q jr js jt" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="jo"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="be b jm z gw"><span class="pw-responses-count jn jo">1</span></p></button></div></div></div><div class="ab q hy hz ia ib ic id ie if ig ih ii ij ik zk zl"><div class="ju k j i d"></div><div class="h k"><div><div class="bl" aria-hidden="false" aria-describedby="150" aria-labelledby="150"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe47e49068028&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40tg6897%2Fdesign-in-memory-streams-e47e49068028&amp;source=-----e47e49068028---------------------bookmark_footer-----------"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" class="af jr ah ai aj ak al kc an ao ap gz ach aci acj"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="acg" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></button></a></span></div></div></div><div class="ec jv cm"><div class="l ae"><div class="ab ca"><div class="jw jx jy jz ka kb ch bg"><div class="ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fplans%3Fdimension%3Dpost_audio_button%26postId%3De47e49068028&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40tg6897%2Fdesign-in-memory-streams-e47e49068028&amp;source=-----e47e49068028---------------------post_audio_button-----------"><div><div class="bl" aria-hidden="false" aria-describedby="114" aria-labelledby="114"><button aria-label="Listen" data-testid="audioPlayButton" class="af jr ah ai aj ak al kc an ao ap gz kd ke jt kf kg kh ki kj s kk kl km kn ko kp kq u kr ks kt"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0zm9-10a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm3.38 10.42l-4.6 3.06a.5.5 0 0 1-.78-.41V8.93c0-.4.45-.63.78-.41l4.6 3.06c.3.2.3.64 0 .84z" fill="currentColor"></path></svg><div class="j i d"><p class="be b bf z gw">Listen</p></div></button></div></div></a></span></div></div></div></div></div><div class="bl" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bl" aria-hidden="false" aria-describedby="5" aria-labelledby="5"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af jr ah ai aj ak al kc an ao ap gz kd ke jt kf kg kh ki kj s kk kl km kn ko kp kq u kr ks kt"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg><div class="j i d"><p class="be b bf z gw">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="8e0d" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph="">Data streaming has become the backbone of scalable systems as it helps process large volumes of real-time data which is further used in analytics or event-driven systems.</p><p id="d80c" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph="">Today we will work on designing an in-memory data streaming service taking the motivation from <a class="af ls" href="https://kafka.apache.org/" rel="noopener ugc nofollow" target="_blank">Kafka</a>. I believe not only this will be helpful for interviews, but it will also help us improve as developers.</p><p id="ecca" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph="">Further, in this <a class="af ls" rel="noopener" href="https://medium.com/@tg6897/design-in-memory-streams-part-2-76744f7afa11">article</a>, we will integrate remote storage into this design so that we can run consumers in different processes or machines.</p></div></div></div><div class="ab ca lt lu lv lw" role="separator"><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz"></span></div><div class="eo ep eq er es"><div class="ab ca"><div class="ch bg dx dy dz ea"><h2 id="e1e9" class="mb mc ev be md me mf mg mh mi mj mk ml lf mm mn mo lj mp mq mr ln ms mt mu mv bj" data-selectable-paragraph="">Kafka Brief and terminologies:</h2><figure class="mz na nb nc nd ne mw mx paragraph-image"><div role="button" tabindex="0" class="nf ng go nh bg ni"><div class="mw mx my"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*raU1J6kQZuUGdGVoaMEKYA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*raU1J6kQZuUGdGVoaMEKYA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*raU1J6kQZuUGdGVoaMEKYA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*raU1J6kQZuUGdGVoaMEKYA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*raU1J6kQZuUGdGVoaMEKYA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*raU1J6kQZuUGdGVoaMEKYA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*raU1J6kQZuUGdGVoaMEKYA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*raU1J6kQZuUGdGVoaMEKYA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*raU1J6kQZuUGdGVoaMEKYA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*raU1J6kQZuUGdGVoaMEKYA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*raU1J6kQZuUGdGVoaMEKYA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*raU1J6kQZuUGdGVoaMEKYA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*raU1J6kQZuUGdGVoaMEKYA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*raU1J6kQZuUGdGVoaMEKYA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg kb nj c" width="700" height="289" loading="eager" role="presentation" src="./Design In-memory Streams._files/1_raU1J6kQZuUGdGVoaMEKYA.png"></picture></div></div></figure><p id="43cf" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph="">Although our design will not be completely based on Kafka, it shares some similarities. So starting with the basic terminologies:</p><ul class=""><li id="0e0d" class="ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew"><em class="nn">Topics</em></strong>: Kafka groups <strong class="kw ew">similar types of data</strong> together in topics. Producers publish data to topics, and consumers consume data from topics. For example, to capture and analyze user behavior on a website, you can create a topic named “user_behavior” and publish data to it. Other analytics services can consume data from this topic for further processing.</li><li id="24d2" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew"><em class="nn">Partitions</em></strong>: The topic stores data in partitions. Partitions are a way to horizontally split data within a topic. Each partition represents an <strong class="kw ew">ordered, immutable sequence of records.</strong> <strong class="kw ew">Data within a partition is processed in order</strong>, so partitions are the basic units of parallelism in Kafka. Increasing the number of partitions can increase parallel data consumption from a topic, provided that the data is equally distributed among them.</li><li id="ec8f" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew"><em class="nn">Brokers</em></strong>: Brokers are responsible for <strong class="kw ew">storing and replicating the topic partitions</strong>, <strong class="kw ew">handling consumer requests for fetching messages, and serving producer requests for writing messages.</strong> Brokers act as intermediaries between producers and consumers, with producers publishing data to topics via brokers and consumers consuming data from topics via brokers.</li><li id="a42d" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew"><em class="nn">Producers</em></strong>: Producers are clients responsible for pushing data to topics.</li><li id="2918" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew"><em class="nn">Consumers</em></strong>: Consumers retrieve data from topics and process it. Each consumer can be <strong class="kw ew">assigned to multiple topic partitions</strong>, but a single topic partition cannot be assigned to multiple consumers to maintain data ordering guarantees within a partition.</li><li id="6602" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew"><em class="nn">Consumer Groups</em></strong>: A consumer group is a collection of consumers working together to <strong class="kw ew">consume data from topics in parallel</strong>. For example, suppose a consumer group has five consumers and is attached to a topic “X” that has five partitions. In that case, each consumer can be assigned one topic partition so that all consumers can process data in parallel.</li><li id="7733" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew"><em class="nn">Offsets</em></strong>: In Kafka, offsets are used to get the required data from a given topic partition, since we always need the next unprocessed data. Offsets are <strong class="kw ew">maintained per group for all topic partition IDs, and consumers</strong> <strong class="kw ew">use them to get the next set of unprocessed data</strong>. Once data is processed, the updated offset is committed. For example, if a consumer group “CG” has four consumers attached to the topic “X” with four partitions, and one consumer dies, its partition will be assigned to one of the remaining alive consumers. The consumer will then use the offset to retrieve the next set of unprocessed data for that partition, as the previous consumer might have processed some data, and we don’t want to process it again.</li></ul><p id="3613" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph="">Although this basic understanding of Kafka components is enough, to follow through the rest of the article, if you want any further understanding refer to <a class="af ls" href="https://kafka.apache.org/intro#intro_concepts_and_terms" rel="noopener ugc nofollow" target="_blank">official documentation</a>.</p></div></div></div><div class="ab ca lt lu lv lw" role="separator"><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz"></span></div><div class="eo ep eq er es"><div class="ab ca"><div class="ch bg dx dy dz ea"><h2 id="bc67" class="mb mc ev be md me mf mg mh mi mj mk ml lf mm mn mo lj mp mq mr ln ms mt mu mv bj" data-selectable-paragraph="">Problem Statement:</h2><ol class=""><li id="3f7a" class="ku kv ev kw b kx nt kz la lb nu ld le lf nv lh li lj nw ll lm ln nx lp lq lr ny nl nm bj" data-selectable-paragraph="">The user can create multiple topics and should be able to provide the number of partitions and data partitioning strategies as well.</li><li id="5a51" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr ny nl nm bj" data-selectable-paragraph="">The user can choose from any underline storage implementation for each topic and can define custom serialization/deserialization for the data.</li><li id="d015" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr ny nl nm bj" data-selectable-paragraph="">The user can publish data to topics, and the defined partitioning strategy will be used to distribute data among partitions.</li><li id="668a" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr ny nl nm bj" data-selectable-paragraph="">The user can create multiple consumer groups and should be able to provide name and partition assignment strategies on the same</li><li id="3d72" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr ny nl nm bj" data-selectable-paragraph="">The user can create multiple consumers and should be able to provide the consumer group they need to be attached to.</li><li id="1ff5" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr ny nl nm bj" data-selectable-paragraph="">Consumer groups can be attached to topics to consume data.</li><li id="8752" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr ny nl nm bj" data-selectable-paragraph="">Multiple consumers should be able to consume data from topics parallelly.</li><li id="97e5" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr ny nl nm bj" data-selectable-paragraph="">If multiple partitions are assigned to a consumer, it should be able to process data parallelly from all of them.</li><li id="715b" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr ny nl nm bj" data-selectable-paragraph="">Once a consumer is added or removed from the group, partitions need to be rebalanced accordingly.</li><li id="4255" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr ny nl nm bj" data-selectable-paragraph="">If a consumer dies, Partitions need to be rebalanced accordingly among available consumer basis the defined partition assignment strategy</li><li id="553c" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr ny nl nm bj" data-selectable-paragraph="">If partitions of any topics are changed, the group should be able to rebalance and accommodate the new partitions.</li><li id="74b9" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr ny nl nm bj" data-selectable-paragraph="">The group needs to maintain offsets of topic partitions consumption, and if any partitions are rebalanced, It needs to be ensured that any data is not consumed again.</li><li id="6f2c" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr ny nl nm bj" data-selectable-paragraph="">Any partition cannot be assigned to two consumers at one time.</li><li id="1b5d" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr ny nl nm bj" data-selectable-paragraph="">Retry capabilities need to be added if data processing fails and the order of data consumption needs to be maintained in any given partition.</li></ol><figure class="mz na nb nc nd ne mw mx paragraph-image"><div class="mw mx nz"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*PzzRWFnSlSto2itU.gif 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*PzzRWFnSlSto2itU.gif 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*PzzRWFnSlSto2itU.gif 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*PzzRWFnSlSto2itU.gif 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*PzzRWFnSlSto2itU.gif 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*PzzRWFnSlSto2itU.gif 1100w, https://miro.medium.com/v2/resize:fit:440/format:webp/0*PzzRWFnSlSto2itU.gif 440w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 220px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/0*PzzRWFnSlSto2itU.gif 640w, https://miro.medium.com/v2/resize:fit:720/0*PzzRWFnSlSto2itU.gif 720w, https://miro.medium.com/v2/resize:fit:750/0*PzzRWFnSlSto2itU.gif 750w, https://miro.medium.com/v2/resize:fit:786/0*PzzRWFnSlSto2itU.gif 786w, https://miro.medium.com/v2/resize:fit:828/0*PzzRWFnSlSto2itU.gif 828w, https://miro.medium.com/v2/resize:fit:1100/0*PzzRWFnSlSto2itU.gif 1100w, https://miro.medium.com/v2/resize:fit:440/0*PzzRWFnSlSto2itU.gif 440w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 220px"><img alt="" class="bg kb nj c" width="220" height="214" loading="eager" role="presentation" src="./Design In-memory Streams._files/0_PzzRWFnSlSto2itU.gif"></picture></div></figure><p id="1c6e" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph="">From an interview perspective, the requirements might seem too much and it is, but they will fit together nicely, so just stay with me.</p><p id="034f" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph="">Let’s start by decoupling the requirements and define them using individual components, with each component being responsible for a few features:</p><ul class=""><li id="5551" class="ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">SerialStorage:</strong> This class provides <strong class="kw ew">wrappers over different storage data structures, such as arrays or linked lists</strong>, that the Topic can utilize. It exposes APIs for pushing and polling data from these structures.</li><li id="1b72" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">Topic:</strong> The Topic is responsible for <strong class="kw ew">maintaining Partitions (instances of SerialStorage) and using the defined partitioning strategy to push data into the relevant Partitions</strong>. It is also responsible for returning ranged data from any Partition.</li><li id="0dd7" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">Topic Partition ID:</strong> This references the partition of a topic. For example, T1&lt;&gt;P1 references the first partition of the topic T1.</li><li id="b440" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">Broker:</strong> The Broker stores <strong class="kw ew">topics/partitions</strong> and acts as a <strong class="kw ew">client for consumers to poll data and producers to push data.</strong></li><li id="1088" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">Group Coordinator:</strong> Each Consumer Group has one Group Coordinator, which <strong class="kw ew">manages the group membership and partition assignments for all Consumers in the group.</strong> It is responsible for maintaining Consumer nodes and assigned/unassigned partitions of all topics it is attached to. <strong class="kw ew">The Group Coordinator exposes APIs for adding/removing Consumer nodes from the group and balances partitions between all connected Consumer nodes</strong>. The Group Coordinator also monitors the health of the Consumers and triggers rebalancing if any Consumer becomes unavailable or unresponsive. It communicates with Consumers via the GroupCoordinatorClient. <strong class="kw ew">There will always be only one Group Coordinator for a Consumer Group.</strong></li><li id="800a" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">GroupCoordinatorClient:</strong> This class acts as an <strong class="kw ew">intermediary between Consumer nodes and the Group Coordinator.</strong> All communications between them are done via this class.</li><li id="02eb" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">ConsumerMember:</strong> The Consumer is responsible for <strong class="kw ew">pulling data from the Broker for a given topic&lt;&gt;partition and processing it</strong>. It uses the OffsetClient to get the offset for which data needs to be processed and commit the updated offset after processing it.</li><li id="f41e" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">OffsetClient:</strong> This class is responsible for <strong class="kw ew">maintaining offsets of a given Consumer Group for all Topic Partition IDs.</strong></li></ul></div></div></div><div class="ab ca lt lu lv lw" role="separator"><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz"></span></div><div class="eo ep eq er es"><div class="ab ca"><div class="ch bg dx dy dz ea"><h2 id="cf66" class="mb mc ev be md me mf mg mh mi mj mk ml lf mm mn mo lj mp mq mr ln ms mt mu mv bj" data-selectable-paragraph="">Class Diagram</h2><p id="d9f0" class="pw-post-body-paragraph ku kv ev kw b kx nt kz la lb nu ld le lf nv lh li lj nw ll lm ln nx lp lq lr eo bj" data-selectable-paragraph="">Here is the class diagram, which gives an overview of our design. Refer to the implementation and code comments below to understand certain fields and classes.</p><figure class="mz na nb nc nd ne mw mx paragraph-image"><div role="button" tabindex="0" class="nf ng go nh bg ni"><div class="mw mx oa"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*CkCNI9SsiPRmpCG45hZCzQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*CkCNI9SsiPRmpCG45hZCzQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*CkCNI9SsiPRmpCG45hZCzQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*CkCNI9SsiPRmpCG45hZCzQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*CkCNI9SsiPRmpCG45hZCzQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*CkCNI9SsiPRmpCG45hZCzQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CkCNI9SsiPRmpCG45hZCzQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*CkCNI9SsiPRmpCG45hZCzQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*CkCNI9SsiPRmpCG45hZCzQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*CkCNI9SsiPRmpCG45hZCzQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*CkCNI9SsiPRmpCG45hZCzQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*CkCNI9SsiPRmpCG45hZCzQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*CkCNI9SsiPRmpCG45hZCzQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*CkCNI9SsiPRmpCG45hZCzQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg kb nj c" width="700" height="410" loading="eager" role="presentation" src="./Design In-memory Streams._files/1_CkCNI9SsiPRmpCG45hZCzQ.png"></picture></div></div></figure></div></div></div><div class="ab ca lt lu lv lw" role="separator"><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz"></span></div><div class="eo ep eq er es"><div class="ab ca"><div class="ch bg dx dy dz ea"><h1 id="272a" class="ob mc ev be md oc od oe mh of og oh ml oi oj ok ol om on oo op oq or os ot ou bj" data-selectable-paragraph="">Implementation:</h1><p id="426e" class="pw-post-body-paragraph ku kv ev kw b kx nt kz la lb nu ld le lf nv lh li lj nw ll lm ln nx lp lq lr eo bj" data-selectable-paragraph="">Diving the implementation into different components. (Please Read code comments for better understanding)</p><h2 id="1029" class="mb mc ev be md me mf mg mh mi mj mk ml lf mm mn mo lj mp mq mr ln ms mt mu mv bj" data-selectable-paragraph=""><strong class="al">Storage Classes</strong></h2><p id="ea20" class="pw-post-body-paragraph ku kv ev kw b kx nt kz la lb nu ld le lf nv lh li lj nw ll lm ln nx lp lq lr eo bj" data-selectable-paragraph="">Storage classes will be wrappers over data structures, which will help maintain data in serial order.</p><p id="95e6" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph="">As you can see from the requirements, we will always append data to a topic partition and not delete/update any data. Also, we need to keep in mind, that there will be ranged queries for a provided limit and offset.</p><ul class=""><li id="046b" class="ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">Data Class</strong>: Used to serialize and deserialize data to be pushed in storage classes. We can define our own Data classes by extending Base Data</li><li id="a4ef" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">Serial Storage</strong>: Used to store serialized data objects, and provide APIs to add/query the same. We can define our own storage classes by extending SerialStorage like <strong class="kw ew"><em class="nn">ArrayStorage</em></strong> or <strong class="kw ew"><em class="nn">Linked List storage</em></strong> classes.</li></ul><pre class="mz na nb nc nd ov ow ox bo oy ba bj"><span id="3aa1" class="oz mc ev ow b bf pa pb l pc pd" data-selectable-paragraph="">import json<br>import threading<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title.class">BaseData</span>:<br>    <span class="hljs-string">""</span><span class="hljs-string">"<br>    Base class of data objects. Defines serialize/deserialize methods for data<br>    "</span><span class="hljs-string">""</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__init__</span>(<span class="hljs-params"><span class="hljs-variable.language">self</span>, ttl=None</span>):<br>        <span class="hljs-variable.language">self</span>.ttl = ttl<br><br>    <span class="hljs-variable">@classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">serialize</span>(<span class="hljs-params">cls, data, encoding_scheme=<span class="hljs-string">'utf-8'</span></span>):<br>        raise Exception(<span class="hljs-string">"No serialize method defined"</span>)<br><br>    <span class="hljs-variable">@classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">deserialize</span>(<span class="hljs-params">cls, <span class="hljs-symbol">data:</span> bytes</span>):<br>        raise Exception(<span class="hljs-string">"No deserialize method defined"</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title.class">Data</span>(BaseData):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__init__</span>(<span class="hljs-params"><span class="hljs-variable.language">self</span>, msg, ttl</span>):<br>        <span class="hljs-variable.language">super</span>(Data, <span class="hljs-variable.language">self</span>).__init__(ttl)<br>        <span class="hljs-variable.language">self</span>.msg = msg<br><br>    <span class="hljs-variable">@classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">serialize</span>(<span class="hljs-params">cls, data, encoding_scheme=<span class="hljs-string">'utf-8'</span></span>) -&gt; <span class="hljs-symbol">bytes:</span><br>        <span class="hljs-string">""</span><span class="hljs-string">"<br>        Serialize data into bytes<br>        :param data:<br>        :param encoding_scheme: encoding scheme of data<br>        :return:<br>        "</span><span class="hljs-string">""</span><br>        <span class="hljs-keyword">return</span> json.dumps({<span class="hljs-string">"msg"</span>: data.msg, <span class="hljs-string">"ttl"</span>: data.ttl}).encode(encoding_scheme)<br><br>    <span class="hljs-variable">@classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">deserialize</span>(<span class="hljs-params">cls, data, encoding_scheme=<span class="hljs-string">'utf-8'</span></span>):<br>        <span class="hljs-string">""</span><span class="hljs-string">"<br>        deserialize data and return the data object from bytes/string<br>        :param data:<br>        :param encoding_scheme:<br>        :return:<br>        "</span><span class="hljs-string">""</span><br>        <span class="hljs-keyword">if</span> isinstance(data, bytes):<br>            data = data.decode(encoding_scheme)<br>        data = json.loads(data)<br>        <span class="hljs-keyword">return</span> cls(msg=data[<span class="hljs-string">'msg'</span>], ttl=data[<span class="hljs-string">'ttl'</span>])<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title.class">SerialStorage</span>:<br>    <span class="hljs-string">""</span><span class="hljs-string">"<br>    Interface for serial storage<br>    "</span><span class="hljs-string">""</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__init__</span>(<span class="hljs-params"><span class="hljs-variable.language">self</span>, data_class=Data</span>):<br>        <span class="hljs-variable.language">self</span>.data_class = data_class<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">add_data</span>(<span class="hljs-params"><span class="hljs-variable.language">self</span>, data, ttl=None</span>):<br>        pass<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_range_data</span>(<span class="hljs-params"><span class="hljs-variable.language">self</span>, limit, offset</span>):<br>        pass<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title.class">LLNode</span>:<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__init__</span>(<span class="hljs-params"><span class="hljs-variable.language">self</span>, data</span>):<br>        <span class="hljs-variable.language">self</span>.data = data<br>        <span class="hljs-variable.language">self</span>.<span class="hljs-keyword">next</span> = None<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title.class">ArrayStorage</span>(SerialStorage):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__init__</span>(<span class="hljs-params"><span class="hljs-variable.language">self</span>, data_class=Data</span>):<br>        <span class="hljs-variable.language">super</span>(ArrayStorage, <span class="hljs-variable.language">self</span>).__init__(data_class)<br>        <span class="hljs-variable.language">self</span>.data = []<br>        <span class="hljs-variable.language">self</span>.lock = threading.Lock() <span class="hljs-comment"># to make serial storage th</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">add_data</span>(<span class="hljs-params"><span class="hljs-variable.language">self</span>, data, ttl=None</span>):<br>        with <span class="hljs-variable.language">self</span>.<span class="hljs-symbol">lock:</span><br>            <span class="hljs-variable.language">self</span>.data.append(<span class="hljs-variable.language">self</span>.data_class.serialize(data))<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_range_data</span>(<span class="hljs-params"><span class="hljs-variable.language">self</span>, limit, offset</span>):<br>        <span class="hljs-keyword">return</span> [<span class="hljs-variable.language">self</span>.data_class.deserialize(_data) <span class="hljs-keyword">for</span> _data <span class="hljs-keyword">in</span> <span class="hljs-variable.language">self</span>.data[<span class="hljs-symbol">limit:</span>limit + offset]]<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title.class">LLStorage</span>(SerialStorage):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__init__</span>(<span class="hljs-params"><span class="hljs-variable.language">self</span>, data_class=Data</span>):<br>        <span class="hljs-variable.language">super</span>(LLStorage, <span class="hljs-variable.language">self</span>).__init__(data_class)<br>        <span class="hljs-variable.language">self</span>.manage_data = {}  <span class="hljs-comment"># additional map to maintain nodes on any given offset , so that range query can be fast</span><br>        <span class="hljs-variable.language">self</span>.head = None<br>        <span class="hljs-variable.language">self</span>.tail = None<br>        <span class="hljs-variable.language">self</span>.data_len = <span class="hljs-number">0</span>  <span class="hljs-comment"># maintains current length of LL</span><br>        <span class="hljs-variable.language">self</span>.lock = threading.Lock() <span class="hljs-comment"># to make serial storage thread safe</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">add_data</span>(<span class="hljs-params"><span class="hljs-variable.language">self</span>, data, ttl=None</span>):<br>        with <span class="hljs-variable.language">self</span>.<span class="hljs-symbol">lock:</span><br>            curr_node = LLNode(<span class="hljs-variable.language">self</span>.data_class.serialize(data))<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-variable.language">self</span>.<span class="hljs-symbol">head:</span><br>                <span class="hljs-variable.language">self</span>.head = <span class="hljs-variable.language">self</span>.tail = curr_node<br>            <span class="hljs-symbol">else:</span><br>                <span class="hljs-variable.language">self</span>.tail.<span class="hljs-keyword">next</span> = curr_node<br>                <span class="hljs-variable.language">self</span>.tail = curr_node<br>            <span class="hljs-variable.language">self</span>.manage_data[<span class="hljs-variable.language">self</span>.data_len] = curr_node  <span class="hljs-comment"># add to map as well for fast access of nodes</span><br>            <span class="hljs-variable.language">self</span>.data_len += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_range_data</span>(<span class="hljs-params"><span class="hljs-variable.language">self</span>, limit, offset</span>):<br>        <span class="hljs-string">""</span><span class="hljs-string">"<br>        returns data between provided limits<br>        :param limit:<br>        :param offset:<br>        :return:<br>        "</span><span class="hljs-string">""</span><br>        data = []<br>        curr = <span class="hljs-variable.language">self</span>.manage_data.get(limit)  <span class="hljs-comment"># uses map to go to node faster instead of traversing</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-symbol">curr:</span><br>            <span class="hljs-keyword">return</span> data<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(limit, limit + offset):<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-symbol">curr:</span><br>                <span class="hljs-comment"># if no further data available , stop</span><br>                <span class="hljs-keyword">break</span><br>            data.append(<span class="hljs-variable.language">self</span>.data_class.deserialize(curr.data))<br>            curr = curr.<span class="hljs-keyword">next</span><br>        <span class="hljs-keyword">return</span> data</span></pre></div></div></div><div class="ab ca lt lu lv lw" role="separator"><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz"></span></div><div class="eo ep eq er es"><div class="ab ca"><div class="ch bg dx dy dz ea"><h2 id="236b" class="mb mc ev be md me mf mg mh mi mj mk ml lf mm mn mo lj mp mq mr ln ms mt mu mv bj" data-selectable-paragraph="">Topics and Data Partition Strategies:</h2><ul class=""><li id="6b06" class="ku kv ev kw b kx nt kz la lb nu ld le lf nv lh li lj nw ll lm ln nx lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">Topic</strong>: Topics will be defined using the name, number of partitions, data partition strategy, and storage class. The topic <strong class="kw ew">will insert data into the relevant partition, and we can query the same using partition_id, limit, and offset.</strong></li><li id="0258" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">Data Partition Strategy</strong>: It exposes a function to provide the next partition in which the topic should insert data. We can make any custom partition strategy by extending TopicDataPartitionStrategy, like the Round Robin partition strategy.</li></ul><pre class="mz na nb nc nd ov ow ox bo oy ba bj"><span id="ae5d" class="oz mc ev ow b bf pa pb l pc pd" data-selectable-paragraph=""><span class="hljs-keyword">class</span> <span class="hljs-title.class">TopicDataPartitionStrategy</span>:<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__init__</span>(<span class="hljs-params">self, **kwargs</span>):<br>        <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_next_partition</span>(<span class="hljs-params">self, no_of_partitions</span>):<br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_partition_strategy_class</span>(<span class="hljs-params">cls, class_name</span>):<br>        <span class="hljs-keyword">if</span> class_name == <span class="hljs-string">'RRPartitionStrategy'</span>:<br>            <span class="hljs-keyword">return</span> RRPartitionStrategy<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">serialize</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No Default implementation"</span>)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">deserialize</span>(<span class="hljs-params">cls, obj_str</span>):<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No Default implementation"</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title.class">RRPartitionStrategy</span>(<span class="hljs-title.class.inherited">TopicDataPartitionStrategy</span>):<br>    <span class="hljs-string">"""<br>    Round robin partition strategy: Uses each partition equally<br>    """</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__init__</span>(<span class="hljs-params">self, **kwargs</span>):<br>        self.last_used = -<span class="hljs-number">1</span><br>        <span class="hljs-built_in">super</span>(RRPartitionStrategy, self).__init__()<br>        self.last_used = <span class="hljs-built_in">int</span>(kwargs.get(<span class="hljs-string">'last_used'</span>, -<span class="hljs-number">1</span>))<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_next_partition</span>(<span class="hljs-params">self, no_of_partitions</span>):<br>        to_use = (self.last_used + <span class="hljs-number">1</span>) % no_of_partitions<br>        self.last_used = to_use<br>        <span class="hljs-keyword">return</span> to_use<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">serialize</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> json.dumps({<span class="hljs-string">"last_used"</span>: self.last_used})<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">deserialize</span>(<span class="hljs-params">cls, obj_str</span>):<br>        <span class="hljs-keyword">return</span> RRPartitionStrategy(**json.loads(obj_str))<br><br><span class="hljs-keyword">class</span> <span class="hljs-title.class">Topic</span>:<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__init__</span>(<span class="hljs-params">self, topic_name, partitions, strategy, storage_type=LLStorage, storage_metadata=<span class="hljs-literal">None</span></span>):<br>        <span class="hljs-string">"""<br>        Stores data in partitions<br>        :param topic_name: Name of the topic<br>        :param partitions: No of partitions to use<br>        :param strategy: Partitioning strategy to use<br>        :param storage_type: Serial Storage Class to use<br>        """</span><br>        self.topic_name = topic_name<br>        self.partitions = [storage_type() <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(partitions)]<br>        self.partition_strategy = strategy<br>        self.storage_type = storage_type<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">push_data</span>(<span class="hljs-params">self, data, ttl=<span class="hljs-literal">None</span></span>):<br>        <span class="hljs-string">"""<br>        Get next partition from partition strategy and push the data<br>        :param data:<br>        :param ttl:<br>        :return:<br>        """</span><br>        next_partition = self.partition_strategy.get_next_partition(<span class="hljs-built_in">len</span>(self.partitions))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">"pushing in partition"</span>, next_partition)<br>        self.partitions[next_partition].add_data(data, ttl)<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">poll_data</span>(<span class="hljs-params">self, partition, limit, offset</span>):<br>        <span class="hljs-keyword">return</span> self.partitions[partition].get_range_data(limit, offset)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">add_partition</span>(<span class="hljs-params">self</span>):<br>        self.partitions.append(self.storage_type())</span></pre></div></div></div><div class="ab ca lt lu lv lw" role="separator"><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz"></span></div><div class="eo ep eq er es"><div class="ab ca"><div class="ch bg dx dy dz ea"><h2 id="f871" class="mb mc ev be md me mf mg mh mi mj mk ml lf mm mn mo lj mp mq mr ln ms mt mu mv bj" data-selectable-paragraph=""><strong class="al">Broker Class</strong></h2><ul class=""><li id="6631" class="ku kv ev kw b kx nt kz la lb nu ld le lf nv lh li lj nw ll lm ln nx lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">Broker</strong>: It is responsible for <strong class="kw ew">managing topics and exposing APIs to create and manipulate them.</strong> It also handles push/poll data from topics. Additionally, brokers maintain a list of consumer groups attached to each topic. When there are changes made to a topic, such as the number of partitions changing, the broker will notify all attached consumer groups so they can rebalance their consumers accordingly.</li></ul><pre class="mz na nb nc nd ov ow ox bo oy ba bj"><span id="ceeb" class="oz mc ev ow b bf pa pb l pc pd" data-selectable-paragraph=""><span class="hljs-keyword">class</span> <span class="hljs-title.class">Broker</span>:<br>    <span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> defaultdict<br>    topics = {}<br>    topics_subscription = defaultdict(<span class="hljs-built_in">set</span>)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">create_topic</span>(<span class="hljs-params">cls, topic_name, partitions, strategy: TopicDataPartitionStrategy, storage_type=LLStorage</span>):<br>        <span class="hljs-string">"""<br>        Create new topic<br>        :param storage_type: storage class to use<br>        :param topic_name: Topic name<br>        :param partitions: Number of partitions<br>        :param strategy: Data Partition Strategy<br>        :return:<br>        """</span><br>        <span class="hljs-keyword">if</span> cls.topics.get(topic_name):<br>            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"topic already exists"</span>)<br>        cls.topics[topic_name] = Topic(topic_name, partitions, strategy, storage_type=storage_type)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">add_data_to_topic</span>(<span class="hljs-params">cls, topic_name, data</span>):<br>        cls.topics[topic_name].push_data(data)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">poll_data</span>(<span class="hljs-params">cls, topic_name, partition, offset, limit</span>):<br>        <span class="hljs-keyword">return</span> cls.topics[topic_name].poll_data(partition, offset, limit)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">attach_to_topic</span>(<span class="hljs-params">cls, topic_name, consumer_group, **kwargs</span>):<br>        <span class="hljs-comment"># whenever consumer group want to attach to topic, we will store subscription</span><br>        cls.topics_subscription[topic_name].add(consumer_group)<br>        <span class="hljs-keyword">return</span> cls.get_no_of_topic_partitions(topic_name)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_no_of_topic_partitions</span>(<span class="hljs-params">cls, topic_name</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(cls.topics[topic_name].partitions)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">add_partition</span>(<span class="hljs-params">cls, topic_name</span>):<br>        cls.topics[topic_name].add_partition()<br>        cls.notify_subscribers(topic_name)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">add_subscription</span>(<span class="hljs-params">cls, topic_name, consumer_group</span>):<br>        cls.topics_subscription[topic_name].add(consumer_group)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">remove_subscription</span>(<span class="hljs-params">cls, topic_name, consumer_group</span>):<br>        cls.topics_subscription[topic_name].remove(consumer_group)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">notify_subscribers</span>(<span class="hljs-params">cls, topic_name</span>):<br>        <span class="hljs-keyword">from</span> consumer.in_memory_group_coordinator_helper <span class="hljs-keyword">import</span> GroupCoordinatorClient<br>        <span class="hljs-keyword">for</span> consumer_group <span class="hljs-keyword">in</span> cls.topics_subscription[topic_name]:<br>            GroupCoordinatorClient.topic_partitions_changed(consumer_group, topic_name)<br></span></pre></div></div></div><div class="ab ca lt lu lv lw" role="separator"><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz"></span></div><div class="eo ep eq er es"><div class="ab ca"><div class="ch bg dx dy dz ea"><h2 id="ce35" class="mb mc ev be md me mf mg mh mi mj mk ml lf mm mn mo lj mp mq mr ln ms mt mu mv bj" data-selectable-paragraph="">Offset client</h2><ul class=""><li id="8dcb" class="ku kv ev kw b kx nt kz la lb nu ld le lf nv lh li lj nw ll lm ln nx lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">PartitionTopic:</strong> This class defines an individual partition of the topic. we will assign one or more instances of this to consumers so that they can consume data from the same.</li><li id="d28a" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">Offset client:</strong> It maintains the offset of the individual consumer groups on all topics&lt;&gt;partions it is consuming from.</li></ul><pre class="mz na nb nc nd ov ow ox bo oy ba bj"><span id="6934" class="oz mc ev ow b bf pa pb l pc pd" data-selectable-paragraph=""><span class="hljs-keyword">class</span> <span class="hljs-title.class">PartitionStatus</span>(enum.Enum):<br>    UNASSIGNED = <span class="hljs-string">'unassigned'</span><br>    ASSIGNED = <span class="hljs-string">'assigned'</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title.class">PartitionTopic</span>:<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__init__</span>(<span class="hljs-params">self, topic_name, partition</span>):<br>        self.topic_name = topic_name<br>        self.partition = partition<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__str__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">f'<span class="hljs-subst">{self.topic_name}</span>::<span class="hljs-subst">{self.partition}</span>'</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__hash__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">hash</span>(self.__str__())<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__eq__</span>(<span class="hljs-params">self, other</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(other, self.__class__):<br>            <span class="hljs-keyword">return</span> self.__str__() == other.__str__()<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title.class">OffsetClient</span>:<br>    offsets = defaultdict(<span class="hljs-built_in">dict</span>)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_offset_key</span>(<span class="hljs-params">cls, consumer_group, topic_name, partition</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">f'<span class="hljs-subst">{consumer_group}</span>_<span class="hljs-subst">{topic_name}</span>_<span class="hljs-subst">{partition}</span>'</span><br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">commit_offset</span>(<span class="hljs-params">cls, consumer_group, topic, partition, offset</span>):<br>        cls.offsets[cls.get_offset_key(consumer_group, topic, partition)] = offset<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_offset</span>(<span class="hljs-params">cls, consumer_group, topic, partition</span>):<br>        <span class="hljs-keyword">return</span> cls.offsets.get(cls.get_offset_key(consumer_group, topic, partition), <span class="hljs-number">0</span>)</span></pre></div></div></div><div class="ab ca lt lu lv lw" role="separator"><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz"></span></div><div class="eo ep eq er es"><div class="ab ca"><div class="ch bg dx dy dz ea"><h2 id="da28" class="mb mc ev be md me mf mg mh mi mj mk ml lf mm mn mo lj mp mq mr ln ms mt mu mv bj" data-selectable-paragraph="">Partition Assignment Strategy</h2><p id="5223" class="pw-post-body-paragraph ku kv ev kw b kx nt kz la lb nu ld le lf nv lh li lj nw ll lm ln nx lp lq lr eo bj" data-selectable-paragraph=""><strong class="kw ew">PartitionAssignment Strategy:</strong> This class is responsible for distributing partitions among consumers based on the total partitions the consumer group is consuming from and the number of consumers present in it.</p><p id="904a" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph="">It calculates <strong class="kw ew">how many partitions should be assigned to each consumer.</strong> We can define custom partition assignment strategies by extending the PartitionAssignmentStrategy class.</p><pre class="mz na nb nc nd ov ow ox bo oy ba bj"><span id="5556" class="oz mc ev ow b bf pa pb l pc pd" data-selectable-paragraph=""><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> defaultdict<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title.class">PartitionAssignmentStrategy</span>:<br>    <span class="hljs-string">"""<br>    Provides a consumer_member_id&lt;&gt;number_of_topic_partition_ids mapping.<br>    It basically tells us how many partitions to be assigned to each consumer<br>    """</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__init__</span>(<span class="hljs-params">self, consumer_member_ids</span>):<br>        <span class="hljs-string">"""<br>        :param consumer_member_ids: we will sort consumer member ids as we don't want shuffling to change in case of<br>        ties between no of partitions<br>        """</span><br>        self.consumer_member_ids = <span class="hljs-built_in">sorted</span>(consumer_member_ids)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_partitions_assignment</span>(<span class="hljs-params">self, no_of_partitions</span>):<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No Default Implementation"</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title.class">EqualAssignmentStrategy</span>(<span class="hljs-title.class.inherited">PartitionAssignmentStrategy</span>):<br>    <span class="hljs-string">"""<br>    this will split the partitions equally among all consumer members<br>    for eg. consumers : 5 and partitions : 5 , it will say assign each consumer one partition<br>            consumers: 5 and partitions : 7 , it will say assign two partitions to two consumers , and all the rest one<br>            consumer: 6 and partitions : 5 , it will say assign 5 consumers one partition and one will be unassigned<br>    """</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__init__</span>(<span class="hljs-params">self, consumer_member_ids</span>):<br>        <span class="hljs-built_in">super</span>(EqualAssignmentStrategy, self).__init__(consumer_member_ids)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_partitions</span>(<span class="hljs-params">self, no_of_partitions</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">"Len partition, len consumer_members"</span>, no_of_partitions, <span class="hljs-built_in">len</span>(self.consumer_member_ids))<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">len</span>(self.consumer_member_ids):<br>            <span class="hljs-keyword">return</span> {}<br>        _equal = no_of_partitions // <span class="hljs-built_in">len</span>(self.consumer_member_ids)<br>        _rem = no_of_partitions % <span class="hljs-built_in">len</span>(self.consumer_member_ids)<br>        sol = defaultdict(<span class="hljs-built_in">int</span>)<br>        <span class="hljs-keyword">for</span> ix, k <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(self.consumer_member_ids):<br>            sol[k] += _equal + (<span class="hljs-number">1</span> <span class="hljs-keyword">if</span> ix &lt; _rem <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> sol</span></pre></div></div></div><div class="ab ca lt lu lv lw" role="separator"><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz"></span></div><div class="eo ep eq er es"><div class="ab ca"><div class="ch bg dx dy dz ea"><h2 id="a1fe" class="mb mc ev be md me mf mg mh mi mj mk ml lf mm mn mo lj mp mq mr ln ms mt mu mv bj" data-selectable-paragraph="">Defining GroupCoordinator</h2><ul class=""><li id="632b" class="ku kv ev kw b kx nt kz la lb nu ld le lf nv lh li lj nw ll lm ln nx lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">Group Coordinator:</strong> Each consumer group has one group coordinator who manages the <strong class="kw ew">group membership and partition assignments for all consumers in the group. </strong>It exposes APIs for consumers to join/leave the group and handles the rebalancing of partitions when the group membership changes. The group coordinator also monitors the health of the consumers and<strong class="kw ew"> triggers rebalancing </strong>if any consumer becomes unavailable or unresponsive.</li><li id="f4db" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">Rebalancing:</strong> Rebalancing is <strong class="kw ew">assigning overall group topic_partition_ids between available consumers</strong>. <br>An example use case to understand it better:<br>- Let’s say our consumer group is attached to 2 topics(T1, T2) each having 2 partitions(P1, P2). So overall topic_partitions in our group will be 4(T1&lt;&gt;P1,T1&lt;&gt;P2,T2&lt;&gt;P1,T2&lt;&gt;P2). Let’s say the consumer group has 2 consumers (C1, C2). One way to rebalance would be that C1 can be assigned (T1&lt;&gt;P1 and T2&lt;&gt;P1) and C2 can be assigned (T1&lt;&gt;P2 and T2&lt;&gt;P2). Similarly in this way, we can have a total number of 4C2 types of partition assignments.</li></ul><p id="a936" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph=""><strong class="kw ew"><em class="nn">Rebalancing Edge Cases:</em></strong> There are a few things that we must keep in mind while rebalancing:</p><ol class=""><li id="1a9b" class="ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ny nl nm bj" data-selectable-paragraph="">When a new consumer member joins a Kafka consumer group, the current partitions are <strong class="kw ew">rebalanced in order to assign the new consumer some partitions.</strong> For example, let’s say a consumer group has two consumer members (C1 and C2) and is attached to only one topic T1 with three partitions. Currently, one partition is assigned to C1, and two partitions are assigned to C2.</li><li id="8f5c" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr ny nl nm bj" data-selectable-paragraph="">If a new <strong class="kw ew">consumer “C3” joins the group, the coordinator will rebalance the partitions according to the assigned policy.</strong> If the policy is the equal assignment policy, the coordinator will remove one partition from C2 and assign it to C3.</li><li id="5947" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr ny nl nm bj" data-selectable-paragraph="">However, <strong class="kw ew">simply removing a partition from a consumer may cause problems if the consumer is still processing data from that partition and has not committed the offset yet.</strong> <strong class="kw ew">In such cases, if a partition is removed from C2 and assigned to C3, it may be possible that C2 is still in the middle of a polling cycle and has not committed the offset</strong>. As a result, C3 may start processing data from a stale offset, causing data to be processed multiple times.</li><li id="228c" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr ny nl nm bj" data-selectable-paragraph="">To handle this, the coordinator will <strong class="kw ew">first issue a request to C2 to revoke some partitions.</strong> Once C2 revokes the partitions, it will notify the coordinator so that the <strong class="kw ew">revoked partitions are marked unassigned,</strong> and on further rebalance can be assigned to C3 ( we are monitoring for unassigned partitions regularly to rebalance). This ensures that each partition is assigned to only one group at any given time, preventing duplicate processing of data.</li></ol><pre class="mz na nb nc nd ov ow ox bo oy ba bj"><span id="29f6" class="oz mc ev ow b bf pa pb l pc pd" data-selectable-paragraph=""><span class="hljs-keyword">class</span> <span class="hljs-title.class">GroupCoordinator</span>:<br>    <span class="hljs-string">"""<br>    Manages consumers assigned to the group<br>    constantly monitors the consumers and reassign if anything is killed<br>    Rebalance partitions between consumers attached to group<br>    """</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__init__</span>(<span class="hljs-params">self, name, partition_assignment_strategy=<span class="hljs-string">'EqualAssignmentStrategy'</span>, is_leader=<span class="hljs-literal">False</span></span>):<br>        <span class="hljs-string">"""<br>        :param name: Consumer group name<br>        :param partition_assignment_strategy: Partition assignment strategy<br>        :param is_leader : Specify if the group coordinator is leader or not, only leader can rebalance partitions to<br>        avoid race conditions.<br>        """</span><br>        self.name = name<br>        self.rebalance_lock = Lock()  <span class="hljs-comment"># this lock will help prevent race conditions during partition rebalances</span><br>        self.partition_assignment_strategy = PartitionAssignmentStrategy.get_partition_strategy(<br>            partition_assignment_strategy)<br>        self.broker_client = Broker<br>        self.is_leader = is_leader<br>        self.offsetClient = OffsetClient<br>        self.partitions = {}  <span class="hljs-comment"># overall topic_partitions assigned to the group</span><br>        self.heart_beat = {}  <span class="hljs-comment"># heart beat tracker of all consumers</span><br>        self.consumer_nodes = <span class="hljs-built_in">set</span>()  <span class="hljs-comment"># consumer ids of consumer nodes assigned to the group</span><br>        self.consumer_nodes_mapping = defaultdict(<span class="hljs-built_in">set</span>)  <span class="hljs-comment"># partition mappings assigned to consumer nodes</span><br><br>        GroupCoordinatorClient.register_group_coordinator(name, self)<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.is_leader:<br>            <span class="hljs-keyword">return</span><br><br>        <span class="hljs-comment"># start check on unassigned partitions</span><br>        t1 = threading.Thread(target=self.check_unassigned_partitions, daemon=<span class="hljs-literal">True</span>)<br>        t1.name = <span class="hljs-string">"unassigned_partition"</span><br>        t1.start()<br><br>        <span class="hljs-comment"># start check on consumer group health</span><br>        t2 = threading.Thread(target=self.check_consumer_health, daemon=<span class="hljs-literal">True</span>)<br>        t2.name = <span class="hljs-string">"consumer_healths"</span><br>        t2.start()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">notify_consumer_members_changed</span>(<span class="hljs-params">self, *args, **kwargs</span>):<br>        <span class="hljs-string">"""<br>        call this method if consumer members are changed.<br>        :param args:<br>        :param kwargs:<br>        :return:<br>        """</span><br>        self.rebalance_partitions()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">register_consumer_member</span>(<span class="hljs-params">self, consumer_id</span>):<br>        <span class="hljs-string">"""<br>        register consumer member to the group<br>        :param consumer_id:<br>        :return:<br>        """</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"registering_consumer_member <span class="hljs-subst">{consumer_id}</span>"</span>)<br>        self.consumer_nodes.add(consumer_id)<br>        self.notify_consumer_members_changed()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">mark_partitions_unassigned</span>(<span class="hljs-params">self, consumer_id, topic_partition_ids</span>):<br>        <span class="hljs-string">"""<br>        Remove partitions from consumer and mark it unassigned<br>        :param topic_partition_ids: partitions to remove<br>        :param consumer_id:: consumer id to remove partitions from<br>        :return:<br>        """</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"removing_partition_from <span class="hljs-subst">{consumer_id}</span> <span class="hljs-subst">{topic_partition_ids}</span>"</span>)<br>        <span class="hljs-keyword">with</span> self.rebalance_lock:<br>            <span class="hljs-keyword">for</span> topic_partition_id <span class="hljs-keyword">in</span> topic_partition_ids:<br>                self.consumer_nodes_mapping[consumer_id].remove(topic_partition_id)<br>                self.partitions[topic_partition_id] = PartitionStatus.UNASSIGNED.value<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_assigned_partitions</span>(<span class="hljs-params">self, consumer_id</span>):<br>        <span class="hljs-string">"""<br>        get assigned partitions for a consumer member<br>        :param consumer_id:<br>        :return:<br>        """</span><br>        <span class="hljs-keyword">return</span> self.consumer_nodes_mapping[consumer_id]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">print_curr_assignment</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> cnsr_id <span class="hljs-keyword">in</span> self.consumer_nodes:<br>            <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> self.consumer_nodes_mapping[cnsr_id]:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f'<span class="hljs-subst">{p}</span> in <span class="hljs-subst">{cnsr_id}</span>'</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">add_partition_mapping</span>(<span class="hljs-params">self, consumer_member_id, topic_partition</span>):<br>        <span class="hljs-string">"""<br>        Add partition mapping to consumer and mark it assigned.<br>        Here we can directly add the partition, without notifying the consumer , since consumer is getting updated<br>        partitions in every poll request, so this new partition will be returned in next get_partitions_assigned request.<br>        :param consumer_member_id:<br>        :param topic_partition:<br>        :return:<br>        """</span><br>        self.partitions[topic_partition] = PartitionStatus.ASSIGNED.value<br>        self.consumer_nodes_mapping[consumer_member_id].add(topic_partition)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">notify_partitions_changed</span>(<span class="hljs-params">self, topic_name</span>):<br>        <span class="hljs-string">"""<br>        Listener in case partitions in topic is changed, to assign new partitions to the nodes<br>        """</span><br>        <span class="hljs-keyword">for</span> partition_id <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.broker_client.get_no_of_topic_partitions(topic_name)):<br>            curr = PartitionTopic(topic_name, partition_id)<br>            <span class="hljs-keyword">if</span> curr <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> self.partitions:<br>                self.partitions[curr] = PartitionStatus.UNASSIGNED.value<br>        self.rebalance_partitions()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_unassigned_partitions</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">"""<br>        Get unassigned partitions in the group<br>        :return:<br>        """</span><br><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">set</span>([topic_partition_id <span class="hljs-keyword">for</span> topic_partition_id, status <span class="hljs-keyword">in</span> self.partitions.items() <span class="hljs-keyword">if</span><br>                    status == PartitionStatus.UNASSIGNED.value])<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">check_unassigned_partitions</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">"""<br>        Check unassigned partitions and trigger a re-balance if found any.<br>        Note: consumer nodes may not have any partition , if no of consumers &gt; no of partitions<br>        :return:<br>        """</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            <span class="hljs-keyword">with</span> self.rebalance_lock:<br>                unassigned = self.get_unassigned_partitions()<br>            <span class="hljs-keyword">if</span> unassigned:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Found unassigned partitions, <span class="hljs-subst">{unassigned}</span>"</span>)<br>                self.rebalance_partitions()<br>            time.sleep(<span class="hljs-number">5</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_consumer_nodes_in_group</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> self.consumer_nodes<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">partitions_len_in_group</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(self.partitions)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">notify_remove_partition</span>(<span class="hljs-params">self, consumer_id, partition_ids</span>):<br>        <span class="hljs-string">"""<br>        Notify consumer member to remove partition.<br>        Note: We cannot just blindly remove a partition from consumer, since it might be that consumer is still processing<br>        data from that partition and has not committed offset yet. So in this case if we remove the partition and assign<br>        to another one, same data can be processed multiple times.<br>        :param consumer_id:<br>        :param partition_ids:<br>        :return:<br>        """</span><br>        GroupCoordinatorClient.notify_remove_partition(consumer_id,<br>                                                       partition_ids)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">rebalance_partitions</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">"""<br>        Re-balances the partitions between all assigned consumers<br>        """</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.is_leader:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">"not a leader"</span>)<br>            <span class="hljs-keyword">return</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.partitions_len_in_group():<br>            <span class="hljs-keyword">return</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">"REBALANCING"</span>)<br>        self.rebalance_lock.acquire()<br>        members = self.get_consumer_nodes_in_group()<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> members:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">"no consumer member attached to group"</span>)<br>            self.rebalance_lock.release()<br>            <span class="hljs-keyword">return</span><br><br>        partitions_assignment = self.partition_assignment_strategy(members).get_partitions(<br>            self.partitions_len_in_group())<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'Partitions assignments should be <span class="hljs-subst">{partitions_assignment}</span>'</span>)<br><br>        <span class="hljs-keyword">for</span> consumer_id, no_of_partitions <span class="hljs-keyword">in</span> partitions_assignment.items():<br>            curr_assigned_partitions_to_node = self.get_assigned_partitions(consumer_id)<br>            _len_curr_assigned_partitions_to_node = <span class="hljs-built_in">len</span>(curr_assigned_partitions_to_node)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"curr_assigned_partition_to_<span class="hljs-subst">{consumer_id}</span>_are_<span class="hljs-subst">{curr_assigned_partitions_to_node}</span>"</span>)<br><br>            <span class="hljs-comment"># If consumer has less than required partitions, assign any unassigned partition to the consumer</span><br>            <span class="hljs-keyword">while</span> _len_curr_assigned_partitions_to_node &lt; no_of_partitions:<br>                unassigned_partitions = self.get_unassigned_partitions()<br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> unassigned_partitions:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">"No unassigned partitions left"</span>)<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"unassigned_partitions_are_<span class="hljs-subst">{unassigned_partitions}</span>"</span>)<br>                curr_unassigned_partition = unassigned_partitions.pop()<br>                self.add_partition_mapping(consumer_id, curr_unassigned_partition)<br>                _len_curr_assigned_partitions_to_node += <span class="hljs-number">1</span><br><br>            <span class="hljs-comment"># If consumer has more than required partitions, remove the extra partitions so they can be distributed</span><br>            <span class="hljs-comment"># accordingly</span><br>            <span class="hljs-keyword">while</span> _len_curr_assigned_partitions_to_node &gt; no_of_partitions:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"removing extra partitions from <span class="hljs-subst">{consumer_id}</span>"</span>)<br>                no_of_partitions_to_remove = _len_curr_assigned_partitions_to_node - no_of_partitions<br>                partitions_to_remove = random.sample(<span class="hljs-built_in">list</span>(self.get_assigned_partitions(consumer_id)),<br>                                                     no_of_partitions_to_remove)<br>                threading.Thread(target=self.notify_remove_partition, args=(consumer_id, partitions_to_remove)).start()<br>                _len_curr_assigned_partitions_to_node -= no_of_partitions_to_remove<br><br>        self.rebalance_lock.release()<br>        self.print_curr_assignment()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">"Rebalancing Completed"</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">notify_consumer_member_removed</span>(<span class="hljs-params">self, consumer_member_id</span>):<br>        <span class="hljs-string">"""<br>        remove_consumer_member from the group ie. mark it partitions unassigned and delete mappings<br>        consumer_member_id : member id to remove<br>        """</span><br>        <span class="hljs-keyword">with</span> self.rebalance_lock:<br>            <span class="hljs-keyword">for</span> topic_partition_id <span class="hljs-keyword">in</span> self.consumer_nodes_mapping[consumer_member_id]:<br>                self.partitions[topic_partition_id] = PartitionStatus.UNASSIGNED.value<br>            <span class="hljs-keyword">del</span> self.consumer_nodes_mapping[consumer_member_id]<br>            self.consumer_nodes.remove(consumer_member_id)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">attach_to_topic</span>(<span class="hljs-params">self, topic_name</span>):<br>        <span class="hljs-string">"""<br>        Get topics of partitions and mark them unassigned so that rebalance can assign them to relevant consumers<br>        :param topic_name:<br>        :return:<br>        """</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.is_leader:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">"Not a leader"</span>)<br>            <span class="hljs-keyword">return</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"attaching to topic <span class="hljs-subst">{topic_name}</span>"</span>)<br>        <span class="hljs-keyword">with</span> self.rebalance_lock:<br>            <span class="hljs-keyword">for</span> partition_id <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.broker_client.attach_to_topic(topic_name, self.name)):<br>                topic_partition = PartitionTopic(topic_name, partition_id)<br>                <span class="hljs-keyword">if</span> topic_partition <span class="hljs-keyword">in</span> self.partitions:<br>                    <span class="hljs-keyword">continue</span><br>                self.partitions[topic_partition] = PartitionStatus.UNASSIGNED.value<br><br>        self.rebalance_partitions()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">check_consumer_health</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">"""<br>        Check consumer health from the continuous heart beat they are sending.<br>        If we do not receive a heart beat for some time, we will assume the consumer to be dead and<br>        remove it from the group.<br>        :return:<br>        """</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            threshold = <span class="hljs-number">10</span><br>            <span class="hljs-keyword">for</span> consumer_node <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>(self.consumer_nodes):<br>                <span class="hljs-keyword">if</span> time.time() - self.heart_beat[consumer_node] &gt; threshold:<br>                    self.notify_consumer_member_removed(consumer_node)<br>            time.sleep(<span class="hljs-number">3</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">ping_heart_beat</span>(<span class="hljs-params">self, consumer_id</span>):<br>        <span class="hljs-string">"""<br>        Update heart beat of a consumer<br>        :param consumer_id:<br>        :return:<br>        """</span><br>        self.heart_beat[consumer_id] = time.time()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_offset</span>(<span class="hljs-params">self, topic_name, partition_id</span>):<br>        <span class="hljs-string">"""<br>        get offset for a topic&lt;&gt;partition ID<br>        :param topic_name:<br>        :param partition_id:<br>        :return:<br>        """</span><br>        <span class="hljs-keyword">return</span> self.offsetClient.get_offset(self.name, topic_name, partition_id)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">commit_offset</span>(<span class="hljs-params">self, topic_name, partition_id, value</span>):<br>        <span class="hljs-string">"""<br>        commit offset for topic&lt;&gt;partiton ID<br>        :param topic_name:<br>        :param partition_id:<br>        :param value:<br>        :return:<br>        """</span><br>        <span class="hljs-keyword">return</span> self.offsetClient.commit_offset(self.name, topic_name, partition_id, value)</span></pre></div></div></div><div class="ab ca lt lu lv lw" role="separator"><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz"></span></div><div class="eo ep eq er es"><div class="ab ca"><div class="ch bg dx dy dz ea"><h2 id="76bf" class="mb mc ev be md me mf mg mh mi mj mk ml lf mm mn mo lj mp mq mr ln ms mt mu mv bj" data-selectable-paragraph=""><strong class="al">GroupCoordinator Client</strong></h2><p id="cee9" class="pw-post-body-paragraph ku kv ev kw b kx nt kz la lb nu ld le lf nv lh li lj nw ll lm ln nx lp lq lr eo bj" data-selectable-paragraph="">It exposes a simple interface so that the consumer and group coordinator can interact with each other.</p><pre class="mz na nb nc nd ov ow ox bo oy ba bj"><span id="92fa" class="oz mc ev ow b bf pa pb l pc pd" data-selectable-paragraph=""><span class="hljs-keyword">class</span> <span class="hljs-title.class">GroupCoordinatorClient</span>:<br>    <span class="hljs-string">"""<br>    This class acts as communication intermediary between consumer and consumerGroupCoordinator<br>    """</span><br><br>    group_coordinator = {}<br>    consumers = {}<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">join_group_request</span>(<span class="hljs-params">cls, group_name, consumer_id, consumer</span>):<br>        <span class="hljs-string">"""<br><br>        :param group_name:<br>        :param consumer_id:<br>        :param consumer:<br>        :return:<br>        """</span><br>        cls.consumers[consumer.<span class="hljs-built_in">id</span>] = consumer<br>        cls.group_coordinator[group_name].register_consumer_member(consumer_id)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_assigned_partitions</span>(<span class="hljs-params">cls, group_name, consumer_id</span>):<br>        <span class="hljs-keyword">return</span> cls.group_coordinator[group_name].get_assigned_partitions(consumer_id)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">register_group_coordinator</span>(<span class="hljs-params">cls, name, group_coordinator</span>):<br>        cls.group_coordinator[name] = group_coordinator<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">notify_remove_partition</span>(<span class="hljs-params">cls, consumer_id, topic_partition_ids</span>):<br>        <span class="hljs-keyword">return</span> cls.consumers[consumer_id].notify_partition_removed(topic_partition_ids=topic_partition_ids)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">revoke_partition</span>(<span class="hljs-params">cls, group_name, partition_ids, consumer_id</span>):<br>        cls.group_coordinator[group_name].mark_partitions_unassigned(consumer_id, partition_ids)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">send_heart_beat</span>(<span class="hljs-params">cls, group_name, consumer_id</span>):<br>        cls.group_coordinator[group_name].ping_heart_beat(consumer_id=consumer_id)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">stop_consumer</span>(<span class="hljs-params">cls, consumer_id</span>):<br>        cls.consumers[consumer_id].stop_consumer_gracefully()<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">topic_partitions_changed</span>(<span class="hljs-params">cls, group_name, topic_name</span>):<br>        cls.group_coordinator[group_name].notify_partitions_changed(topic_name)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_consumer_group_offset</span>(<span class="hljs-params">cls, group_name, topic_name, partition</span>):<br>        <span class="hljs-keyword">return</span> cls.group_coordinator[group_name].get_offset(topic_name, partition)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">commit_consumer_group_offset</span>(<span class="hljs-params">cls, group_name, topic_name, partition, value</span>):<br>        <span class="hljs-keyword">return</span> cls.group_coordinator[group_name].commit_offset(topic_name, partition,value)</span></pre></div></div></div><div class="ab ca lt lu lv lw" role="separator"><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz"></span></div><div class="eo ep eq er es"><div class="ab ca"><div class="ch bg dx dy dz ea"><h2 id="8b09" class="mb mc ev be md me mf mg mh mi mj mk ml lf mm mn mo lj mp mq mr ln ms mt mu mv bj" data-selectable-paragraph=""><strong class="al">Consumer member and Data Handler</strong></h2><p id="4a59" class="pw-post-body-paragraph ku kv ev kw b kx nt kz la lb nu ld le lf nv lh li lj nw ll lm ln nx lp lq lr eo bj" data-selectable-paragraph=""><strong class="kw ew">The consumer member is responsible for joining a group and getting assigned partitions to consume data from</strong>. This assignment is a list of PartitionTopics(&lt;topic_id&gt;_&lt;partition_id&gt;) received from the group coordinator. A consumer <strong class="kw ew">can only join one group at a time</strong> and sends periodic heartbeats to the group coordinator to indicate its health.</p><p id="5ded" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph="">For each assigned Topic&lt;&gt;Partition_id, the consumer member performs the following actions:</p><ul class=""><li id="5f49" class="ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr nk nl nm bj" data-selectable-paragraph=""><em class="nn">Gets the current offset from the Group Coordinator.</em></li><li id="0ebc" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><em class="nn">Retrieves the next data from the broker for that topic&lt;&gt;partition.</em></li><li id="8525" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><em class="nn">Processes the data and commits the new offset.</em></li></ul><p id="935b" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph="">There are a few interesting fields for the consumer member, such as:</p><ul class=""><li id="a53c" class="ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew"><em class="nn">max_polling_concurrency</em></strong>: This field defines the degree of parallel processing for all assigned partitions to the consumer. Processing for each topic_partition_id will be done on a parallel basis with a set of worker threads.</li><li id="b612" class="ku kv ev kw b kx no kz la lb np ld le lf nq lh li lj nr ll lm ln ns lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew"><em class="nn">msg_to_consume</em></strong>: This field is used by the consumer to poll the next set of messages from the partition, i.e. it will poll from current_offset to current_offset+msg_to_consume.</li></ul><p id="c8aa" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph=""><strong class="kw ew">Data Handler:</strong> The data handler processes the data consumed by the consumer member. We can define custom data handlers by extending the DataHandler class.</p><pre class="mz na nb nc nd ov ow ox bo oy ba bj"><span id="7bd9" class="oz mc ev ow b bf pa pb l pc pd" data-selectable-paragraph=""><span class="hljs-keyword">class</span> <span class="hljs-title.class">DataHandler</span>:<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">handle</span>(<span class="hljs-params">self, data</span>):<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"Not Implemented"</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title.class">DefaultDataHandler</span>(<span class="hljs-title.class.inherited">DataHandler</span>):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">handle</span>(<span class="hljs-params">self, data</span>):<br>        <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> data:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"processing data <span class="hljs-subst">{d}</span>"</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title.class">ConsumerMember</span>:<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">__init__</span>(<span class="hljs-params">self, consumer_group_name, msg_to_consume=<span class="hljs-number">10</span>, max_polling_concurrency=<span class="hljs-number">5</span>, handler_class=<span class="hljs-literal">None</span></span>):<br>        self.active = <span class="hljs-literal">True</span><br>        self.consumer_group = consumer_group_name<br>        self.handler = handler_class <span class="hljs-keyword">or</span> DefaultDataHandler()  <span class="hljs-comment"># handler class to use</span><br>        self.<span class="hljs-built_in">id</span> = <span class="hljs-built_in">str</span>(uuid.uuid4())<br>        self.commit_lock = Lock()  <span class="hljs-comment"># this lock will be used in polling cycle</span><br>        self.group_coordinator_client = GroupCoordinatorClient  <span class="hljs-comment"># group coordinator client to communicate with group coordinator</span><br>        self.topic_client = Broker  <span class="hljs-comment"># topic client to communicate with broker</span><br>        self.msg_to_consume = msg_to_consume  <span class="hljs-comment"># msg to consume from each partition</span><br>        self.max_polling_concurrency = max_polling_concurrency  <span class="hljs-comment"># max partitions to poll parallely</span><br>        self.join_group()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">send_heart_beat</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">"""<br>        Send heart beat to coordinator<br>        :return:<br>        """</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            <span class="hljs-keyword">if</span> self.active:<br>                self.group_coordinator_client.send_heart_beat(self.consumer_group, self.<span class="hljs-built_in">id</span>)<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">join_group</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">"""<br>        Join Consumer group<br>        :return:<br>        """</span><br>        self.active = <span class="hljs-literal">True</span><br><br>        <span class="hljs-comment"># start heart beat</span><br>        threading.Thread(target=self.send_heart_beat).start()<br><br>        time.sleep(<span class="hljs-number">1</span>)<br>        self.group_coordinator_client.join_group_request(self.consumer_group, self.<span class="hljs-built_in">id</span>, self)<br><br>        <span class="hljs-comment"># start polling</span><br>        threading.Thread(target=self.poll).start()<br>        <br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">get_assigned_partitions</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">"""<br>        Get assigned partitions from group coordinator<br>        :return:<br>        """</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span>(self.group_coordinator_client.get_assigned_partitions(self.consumer_group, self.<span class="hljs-built_in">id</span>))<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">notify_partition_removed</span>(<span class="hljs-params">self, topic_partition_ids, *args, **kwargs</span>):<br>        <span class="hljs-string">"""<br>        Since group coordinator cannot simply remove partition from consumer, as it may lead to uncommitted offsets.<br>        This function receives request from group coordinator to remove partition and notifies back once it stops<br>        polling so that group coordinator can remove the partitions from this consumer.<br>        :param topic_partition_ids: partitions to remove<br>        :param args:<br>        :param kwargs:<br>        :return:<br>        """</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"removing topic partition ids <span class="hljs-subst">{topic_partition_ids}</span>"</span>)<br>        retry_count = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">with</span> self.commit_lock:<br>            <span class="hljs-comment"># take the commit lock so that polling stops, and will be released once partitions</span><br>            <span class="hljs-comment"># are removed and consumer fetches updated partitions from group coordinator.</span><br>            <span class="hljs-comment"># This is to ensure no uncommitted offset remains</span><br>            <span class="hljs-keyword">while</span> retry_count &lt; <span class="hljs-number">3</span>:<br>                <span class="hljs-comment"># commit lock to ensure no uncommitted offsets are left before removing the partition</span><br>                <span class="hljs-keyword">try</span>:<br>                    <span class="hljs-comment"># send request to group coordinator to remove partition</span><br>                    self.group_coordinator_client.revoke_partition(self.consumer_group, topic_partition_ids,<br>                                                                   consumer_id=self.<span class="hljs-built_in">id</span>)<br><br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Unable to remove partition<span class="hljs-subst">{e}</span>"</span>)<br>                retry_count += <span class="hljs-number">1</span><br><br>            <span class="hljs-comment"># if retries exceeded , terminate consumer</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">"max retries exceeded, terminating consumer"</span>)<br>            self.active = <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">stop_consumer_gracefully</span>(<span class="hljs-params">self, *args, **kwargs</span>):<br>        <span class="hljs-string">"""<br>        Mark consumer inactive<br>        :param args:<br>        :param kwargs:<br>        :return:<br>        """</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">"Stopping consumer"</span>)<br>        <span class="hljs-keyword">with</span> self.commit_lock:<br>            <span class="hljs-comment"># take commit lock to avoid uncommitted partition</span><br>            self.active = <span class="hljs-literal">False</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">"stopped_consumer"</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">poll</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">"""<br>        This method polls the data from assigned partitions in parallel, processes and commit the updated offset<br>        :return:<br>        """</span><br><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.active:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>        <span class="hljs-comment"># If no partitions is assigned, there is noting to do :(</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> self.get_assigned_partitions():<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.active:<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">"no_partition_assigned_to_poll"</span>)<br>        <br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br><br>            <span class="hljs-comment"># acquire lock for polling cycle</span><br>            self.commit_lock.acquire()<br><br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.active:<br>                self.commit_lock.release()<br>                <span class="hljs-keyword">break</span><br>            <br>            <span class="hljs-keyword">with</span> concurrent.futures.ThreadPoolExecutor(max_workers=self.max_polling_concurrency) <span class="hljs-keyword">as</span> executor:<br>                <span class="hljs-comment"># Process data from each assigned partition parallely</span><br>                polling_result = [executor.submit(self.poll_data_from_partition, topic_partition_id) <span class="hljs-keyword">for</span><br>                                  topic_partition_id <span class="hljs-keyword">in</span> self.get_assigned_partitions()]<br><br>                <span class="hljs-comment"># Wait for polling cycle to complete before releasing commit lock</span><br>                results = [task.result() <span class="hljs-keyword">for</span> task <span class="hljs-keyword">in</span> polling_result]<br><br>            <span class="hljs-comment"># release lock after polling cycle</span><br>            self.commit_lock.release()<br>            time.sleep(<span class="hljs-number">1</span>)  <span class="hljs-comment"># some delay to avoid lock starvation</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title.function">poll_data_from_partition</span>(<span class="hljs-params">self, topic_partition</span>):<br>        <span class="hljs-string">"""<br>        :param topic_partition:<br>        Call offset client to get the current offset of topic&lt;&gt;partition until which data is consumed<br>        Call broker client to get data from topic partition from offset to offset+msg to consume<br>        Process the data<br>        Commit updated offset to offset client<br>        Note: If committing new offset fails after data processing or anything in data processing fails itself,<br>        consumer will be polling for the same data(as offset is not changed) and keeps processing same data again.<br>        (Additional measures can be added to avoid this , like msg deduplication key)<br>        :return:<br>        """</span><br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(topic_partition, <span class="hljs-built_in">str</span>):<br>                topic_partition = PartitionTopic(topic_name=topic_partition.split(<span class="hljs-string">"::"</span>)[<span class="hljs-number">0</span>],<br>                                                 partition=<span class="hljs-built_in">int</span>(topic_partition.split(<span class="hljs-string">"::"</span>)[<span class="hljs-number">1</span>]))<br>            _topic_name = topic_partition.topic_name<br>            _partition_id = topic_partition.partition<br>            _curr_offset_of_partition = self.group_coordinator_client.get_consumer_group_offset(self.consumer_group,<br>                                                                                                _topic_name,<br>                                                                                                _partition_id)<br>            <span class="hljs-keyword">if</span> _curr_offset_of_partition <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>                <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"unable to get latest offset"</span>)<br>            _data = self.topic_client.poll_data(_topic_name, _partition_id, _curr_offset_of_partition,<br>                                                _curr_offset_of_partition + self.msg_to_consume)<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> _data:<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>            <span class="hljs-built_in">print</span>(_data)<br>            <span class="hljs-comment"># handle data</span><br>            self.handler.handle(_data)<br><br>            <span class="hljs-comment"># commit offset</span><br>            result = self.group_coordinator_client.commit_consumer_group_offset(self.consumer_group, _topic_name,<br>                                                                                _partition_id,<br>                                                                                _curr_offset_of_partition + <span class="hljs-built_in">len</span>(_data))<br><br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> result:<br>                <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"unable to commit offset"</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"committed offset for topic_partition_id <span class="hljs-subst">{_topic_name}</span>_<span class="hljs-subst">{_partition_id}</span>"</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Error while processing data <span class="hljs-subst">{e}</span>"</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span></span></pre></div></div></div><div class="ab ca lt lu lv lw" role="separator"><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz ma"></span><span class="lx bx bl ly lz"></span></div><div class="eo ep eq er es"><div class="ab ca"><div class="ch bg dx dy dz ea"><h2 id="6161" class="mb mc ev be md me mf mg mh mi mj mk ml lf mm mn mo lj mp mq mr ln ms mt mu mv bj" data-selectable-paragraph="">Testing</h2><p id="fd6a" class="pw-post-body-paragraph ku kv ev kw b kx nt kz la lb nu ld le lf nv lh li lj nw ll lm ln nx lp lq lr eo bj" data-selectable-paragraph="">Our implementation is complete, we can now write a simple test to verify the functionality.</p><pre class="mz na nb nc nd ov ow ox bo oy ba bj"><span id="d5ca" class="oz mc ev ow b bf pa pb l pc pd" data-selectable-paragraph=""><span class="hljs-keyword">def</span> <span class="hljs-title.function">test</span>():<br>    <span class="hljs-keyword">from</span> group_coordinator.group_coordinator <span class="hljs-keyword">import</span> GroupCoordinator<br>    <span class="hljs-keyword">from</span> consumer.group_coordinator_client <span class="hljs-keyword">import</span> GroupCoordinatorClient<br>    <span class="hljs-keyword">from</span> broker.broker <span class="hljs-keyword">import</span> Broker<br>    <span class="hljs-keyword">from</span> consumer.consumer_member <span class="hljs-keyword">import</span> ConsumerMember<br>    <span class="hljs-keyword">from</span> broker.partition_strategy.RR_partition_strategy <span class="hljs-keyword">import</span> RRPartitionStrategy<br>    <span class="hljs-keyword">from</span> broker.topic <span class="hljs-keyword">import</span> Data<br>    topic_name = <span class="hljs-string">"new_topic"</span><br>    group_name = <span class="hljs-string">"new_group"</span><br>    <br>    <span class="hljs-comment"># create topic</span><br>    Broker.create_topic(topic_name, <span class="hljs-number">6</span>, RRPartitionStrategy(), storage_type=ArrayStorage)<br>    <br>    <span class="hljs-comment"># create group coordinator</span><br>    consumer_group_coordinator = GroupCoordinator(group_name, is_leader=<span class="hljs-literal">True</span>)<br>    <br>    <span class="hljs-comment"># create consumer members</span><br>    c1 = ConsumerMember(consumer_group_name=group_name)<br>    c2 = ConsumerMember(consumer_group_name=group_name)<br>    <br>    <span class="hljs-comment"># attach group coordinator to topic(we can attach to multiple topics as well)</span><br>    consumer_group_coordinator.attach_to_topic(topic_name)<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        x = <span class="hljs-built_in">input</span>(<span class="hljs-string">"choose action"</span>)<br>        <span class="hljs-keyword">if</span> x == <span class="hljs-string">"add_data_to_topic"</span>:<br>            <span class="hljs-comment"># add 100 data items to topic</span><br>            topic_to_add_data = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">"Topic Name ?"</span>))<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>                Broker.add_data_to_topic(topic_to_add_data, Data(msg=<span class="hljs-built_in">str</span>(i), ttl=<span class="hljs-literal">None</span>))<br>        <span class="hljs-keyword">elif</span> x == <span class="hljs-string">"print_offsets"</span>:<br>            <span class="hljs-comment"># print all offsets</span><br>            <span class="hljs-keyword">from</span> offset_manager.offset_manager <span class="hljs-keyword">import</span> OffsetClient<br>            <span class="hljs-built_in">print</span>(OffsetClient.offsets)<br>        <span class="hljs-keyword">elif</span> x == <span class="hljs-string">"add_consumer"</span>:<br>            <span class="hljs-comment"># add consumer to the group</span><br>            c4 = ConsumerMember(group_name)<br>        <span class="hljs-keyword">elif</span> x == <span class="hljs-string">"kill_consumer"</span>:<br>            <span class="hljs-comment"># kill consumer</span><br>            node_id = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">"provide node id"</span>))<br>            GroupCoordinatorClient.stop_consumer(node_id)<br>        <span class="hljs-keyword">elif</span> x == <span class="hljs-string">"add_partition_to_topic"</span>:<br>            <span class="hljs-comment"># add partition to topic</span><br>            topic_to_add_partition = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">"Topic Name ?"</span>))<br>            Broker.add_partition(topic_to_add_partition)</span></pre><p id="b453" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph="">Here, Initially, topic partitions will be balanced between 2 consumer nodes:</p><ul class=""><li id="a3d0" class="ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr nk nl nm bj" data-selectable-paragraph="">After connecting to the topic</li></ul><figure class="mz na nb nc nd ne mw mx paragraph-image"><div role="button" tabindex="0" class="nf ng go nh bg ni"><div class="mw mx pe"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*AXMPlLWb_8oyfTjmOoKLeA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*AXMPlLWb_8oyfTjmOoKLeA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*AXMPlLWb_8oyfTjmOoKLeA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*AXMPlLWb_8oyfTjmOoKLeA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*AXMPlLWb_8oyfTjmOoKLeA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*AXMPlLWb_8oyfTjmOoKLeA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AXMPlLWb_8oyfTjmOoKLeA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*AXMPlLWb_8oyfTjmOoKLeA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*AXMPlLWb_8oyfTjmOoKLeA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*AXMPlLWb_8oyfTjmOoKLeA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*AXMPlLWb_8oyfTjmOoKLeA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*AXMPlLWb_8oyfTjmOoKLeA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*AXMPlLWb_8oyfTjmOoKLeA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*AXMPlLWb_8oyfTjmOoKLeA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="Initial rebalance after we attach the topic" class="bg kb nj c" width="700" height="272" loading="lazy" src="./Design In-memory Streams._files/1_AXMPlLWb_8oyfTjmOoKLeA.png"></picture></div></div><figcaption class="pf pg ph mw mx pi pj be b bf z gw" data-selectable-paragraph="">Initial rebalance with 2 consumers</figcaption></figure><ul class=""><li id="5b31" class="ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">add_data_to_topic</strong>: Adds data to the provided topic. For testing, we will insert 100 records. Here you can check the data partition strategy in use.</li></ul><figure class="mz na nb nc nd ne mw mx paragraph-image"><div role="button" tabindex="0" class="nf ng go nh bg ni"><div class="mw mx pk"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*OEuSm93yjc5lGVrruBP-kw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*OEuSm93yjc5lGVrruBP-kw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*OEuSm93yjc5lGVrruBP-kw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*OEuSm93yjc5lGVrruBP-kw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*OEuSm93yjc5lGVrruBP-kw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*OEuSm93yjc5lGVrruBP-kw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OEuSm93yjc5lGVrruBP-kw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*OEuSm93yjc5lGVrruBP-kw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*OEuSm93yjc5lGVrruBP-kw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*OEuSm93yjc5lGVrruBP-kw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*OEuSm93yjc5lGVrruBP-kw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*OEuSm93yjc5lGVrruBP-kw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*OEuSm93yjc5lGVrruBP-kw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*OEuSm93yjc5lGVrruBP-kw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg kb nj c" width="700" height="254" loading="lazy" role="presentation" src="./Design In-memory Streams._files/1_OEuSm93yjc5lGVrruBP-kw.png"></picture></div></div><figcaption class="pf pg ph mw mx pi pj be b bf z gw" data-selectable-paragraph="">Insert data in topic</figcaption></figure><ul class=""><li id="f9ef" class="ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr nk nl nm bj" data-selectable-paragraph=""><strong class="kw ew">add_consumer</strong>: Add a new consumer, and rebalancing will assign it required partitions</li></ul><figure class="mz na nb nc nd ne mw mx paragraph-image"><div role="button" tabindex="0" class="nf ng go nh bg ni"><div class="mw mx pl"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*K_BluB42V--SyoOL-nGeJw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*K_BluB42V--SyoOL-nGeJw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*K_BluB42V--SyoOL-nGeJw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*K_BluB42V--SyoOL-nGeJw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*K_BluB42V--SyoOL-nGeJw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*K_BluB42V--SyoOL-nGeJw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K_BluB42V--SyoOL-nGeJw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*K_BluB42V--SyoOL-nGeJw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*K_BluB42V--SyoOL-nGeJw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*K_BluB42V--SyoOL-nGeJw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*K_BluB42V--SyoOL-nGeJw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*K_BluB42V--SyoOL-nGeJw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*K_BluB42V--SyoOL-nGeJw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*K_BluB42V--SyoOL-nGeJw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg kb nj c" width="700" height="258" loading="lazy" role="presentation" src="./Design In-memory Streams._files/1_K_BluB42V--SyoOL-nGeJw.png"></picture></div></div><figcaption class="pf pg ph mw mx pi pj be b bf z gw" data-selectable-paragraph="">Rebalance after a new consumer added</figcaption></figure><h2 id="30e1" class="mb mc ev be md me mf mg mh mi mj mk ml lf mm mn mo lj mp mq mr ln ms mt mu mv bj" data-selectable-paragraph="">Conclusion</h2><figure class="mz na nb nc nd ne mw mx paragraph-image"><div class="mw mx pm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*pP0Jy4uQ1aClkwEz.gif 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*pP0Jy4uQ1aClkwEz.gif 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*pP0Jy4uQ1aClkwEz.gif 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*pP0Jy4uQ1aClkwEz.gif 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*pP0Jy4uQ1aClkwEz.gif 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*pP0Jy4uQ1aClkwEz.gif 1100w, https://miro.medium.com/v2/resize:fit:1000/format:webp/0*pP0Jy4uQ1aClkwEz.gif 1000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 500px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/0*pP0Jy4uQ1aClkwEz.gif 640w, https://miro.medium.com/v2/resize:fit:720/0*pP0Jy4uQ1aClkwEz.gif 720w, https://miro.medium.com/v2/resize:fit:750/0*pP0Jy4uQ1aClkwEz.gif 750w, https://miro.medium.com/v2/resize:fit:786/0*pP0Jy4uQ1aClkwEz.gif 786w, https://miro.medium.com/v2/resize:fit:828/0*pP0Jy4uQ1aClkwEz.gif 828w, https://miro.medium.com/v2/resize:fit:1100/0*pP0Jy4uQ1aClkwEz.gif 1100w, https://miro.medium.com/v2/resize:fit:1000/0*pP0Jy4uQ1aClkwEz.gif 1000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 500px"><img alt="" class="bg kb nj c" width="500" height="272" loading="lazy" role="presentation" src="./Design In-memory Streams._files/0_pP0Jy4uQ1aClkwEz.gif"></picture></div></figure><p id="96ea" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph="">So that’s it, a complete implementation of an in-memory streaming service. Thanks for staying with me this long and I hope it has been a good learning experience.</p><p id="7f82" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph="">There might be some edge cases that I missed or was too lazy to fix. Feel free to point out and fix the same.</p><p id="4314" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph="">You can find the complete code <a class="af ls" href="https://github.com/TUSHARZ/in_memory_streams" rel="noopener ugc nofollow" target="_blank">here.</a></p><p id="fa02" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph="">Feel free to drop any questions, comments, or improvements and if you enjoyed the article please support and follow for more.</p><h2 id="39b6" class="mb mc ev be md me mf mg mh mi mj mk ml lf mm mn mo lj mp mq mr ln ms mt mu mv bj" data-selectable-paragraph="">Bonus</h2><p id="72dd" class="pw-post-body-paragraph ku kv ev kw b kx nt kz la lb nu ld le lf nv lh li lj nw ll lm ln nx lp lq lr eo bj" data-selectable-paragraph="">Well, this is too much work for just an in-memory solution. So let’s integrate remote storage into our design so we can run consumers in different processes or machines.</p><p id="b30e" class="pw-post-body-paragraph ku kv ev kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr eo bj" data-selectable-paragraph="">We will cover this in this article: <a class="af ls" rel="noopener" href="https://medium.com/@tg6897/design-in-memory-streams-part-2-76744f7afa11">Design In-memory Streams: Part 2. This is the continuation of the story… | by Tushar Gupta | May, 2023 | Medium</a></p></div></div></div></div></section></div></div></article><div class="ab ca"><div class="ch bg dx dy dz ea"></div></div></div><div class="ab ca"><div class="ch bg dx dy dz ea"><div class="pn po ab hf"><div class="pp ab"><a class="pq ax am ao" rel="noopener follow" href="https://medium.com/tag/low-level-design?source=post_page-----e47e49068028---------------low_level_design-----------------"><div class="pr go cw ps ed pt pu be b bf z bj pv">Low Level Design</div></a></div><div class="pp ab"><a class="pq ax am ao" rel="noopener follow" href="https://medium.com/tag/system-design-interview?source=post_page-----e47e49068028---------------system_design_interview-----------------"><div class="pr go cw ps ed pt pu be b bf z bj pv">System Design Interview</div></a></div><div class="pp ab"><a class="pq ax am ao" rel="noopener follow" href="https://medium.com/tag/kafka?source=post_page-----e47e49068028---------------kafka-----------------"><div class="pr go cw ps ed pt pu be b bf z bj pv">Kafka</div></a></div><div class="pp ab"><a class="pq ax am ao" rel="noopener follow" href="https://medium.com/tag/techno?source=post_page-----e47e49068028---------------techno-----------------"><div class="pr go cw ps ed pt pu be b bf z bj pv">Techno</div></a></div><div class="pp ab"><a class="pq ax am ao" rel="noopener follow" href="https://medium.com/tag/data-streaming?source=post_page-----e47e49068028---------------data_streaming-----------------"><div class="pr go cw ps ed pt pu be b bf z bj pv">Data Streaming</div></a></div></div></div></div><div class="l"></div><footer class="pw px py pz qa qb qc qd qe ab q qf qg c"><div class="l ae"><div class="ab ca"><div class="ch bg dx dy dz ea"><div class="ab co qh"><div class="ab q iq"><div class="qi l"><span class="l qj qk ql e d"><div class="ab q iq"><div class="pw-multi-vote-icon go ir is it iu"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fe47e49068028&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40tg6897%2Fdesign-in-memory-streams-e47e49068028&amp;user=Tushar+Gupta&amp;userId=bf5235fee8bb&amp;source=-----e47e49068028---------------------clap_footer-----------"><div><div class="bl" aria-hidden="false" aria-describedby="153" aria-labelledby="153"><div class="iv ao ix acd ace jb am jc jd je iu"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l jf jg jh ji jj jk jl"><div><div class="bl" aria-hidden="false" aria-describedby="154" aria-labelledby="154"><p class="be b jm z gw"><button class="af ag ah ai aj ak al am an ao ap aq ar as at acf xt">57<span class="l h g f qm qn"></span></button></p></div></div></div></div></span><span class="l h g f qm qn"><div class="ab q iq"><div class="pw-multi-vote-icon go ir is it iu"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fe47e49068028&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40tg6897%2Fdesign-in-memory-streams-e47e49068028&amp;user=Tushar+Gupta&amp;userId=bf5235fee8bb&amp;source=-----e47e49068028---------------------clap_footer-----------"><div><div class="bl" aria-hidden="false" aria-describedby="155" aria-labelledby="155"><div class="iv ao ix acd ace jb am jc jd je iu"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l jf jg jh ji jj jk jl"><div><div class="bl" aria-hidden="false" aria-describedby="156" aria-labelledby="156"><p class="be b jm z gw"><button class="af ag ah ai aj ak al am an ao ap aq ar as at acf xt">57</button></p></div></div></div></div></span></div><div class="bp ab"><div><div class="bl" aria-hidden="false" aria-describedby="6" aria-labelledby="6"><button class="ao iv jp jq ab q jr js jt" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="jo"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="be b bf z gw"><span class="pw-responses-count jn jo">1</span></p></button></div></div></div></div><div class="ab q"><div class="ma l hc"><div><div class="bl" aria-hidden="false" aria-describedby="158" aria-labelledby="158"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe47e49068028&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40tg6897%2Fdesign-in-memory-streams-e47e49068028&amp;source=--------------------------bookmark_footer-----------"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" class="af jr ah ai aj ak al kc an ao ap gz ach aci acj"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="acg" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></button></a></span></div></div></div><div class="ma l hc"><div class="bl" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bl" aria-hidden="false" aria-describedby="7" aria-labelledby="7"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af jr ah ai aj ak al kc an ao ap gz kd ke jt kf"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="qo qp qq qr qs l bw"><div class="ab ca"><div class="ch bg dx dy dz ea"><div class="ck ab qt co"><div class="ab gg"><a rel="noopener follow" href="https://medium.com/@tg6897?source=post_page-----e47e49068028--------------------------------"><div class="l qu qv bx qw gk"><div class="l go"><img alt="Tushar Gupta" class="l ec bx qx qy cw" src="./Design In-memory Streams._files/0_oTCZ2-qduIllbJVV(1).png" width="72" height="72" loading="lazy"><div class="gl bx l qx qy eh n gm gn"></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="be b bf z qz pr ra rb rc rd re rf rg gz rh ri rj rk rl rm ec bl rn pg">Follow</button></span><div class="ro l"><div><div><div class="bl" aria-hidden="false" aria-describedby="353" aria-labelledby="353"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F832ec67a9974&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40tg6897%2Fdesign-in-memory-streams-e47e49068028&amp;newsletterV3=bf5235fee8bb&amp;newsletterV3Id=832ec67a9974&amp;user=Tushar+Gupta&amp;userId=bf5235fee8bb&amp;source=-----e47e49068028---------------------subscribe_user-----------"><button class="be b bf z qz am ra rb rc rd re rf rg gz rh ri rj rl rm ec bl rn pg" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="acl rq rr"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cm co"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="https://medium.com/@tg6897?source=post_page-----e47e49068028--------------------------------"><h2 class="pw-author-name be sb sc sd se bj"><span class="eo">Written by Tushar Gupta</span></h2></a></div><div class="pp ab"><div class="l hc"><span class="pw-follower-count be b bf z bj"><a class="af ag ah ai aj ak al am an ao ap aq ar gt" rel="noopener follow" href="https://medium.com/@tg6897/followers?source=post_page-----e47e49068028--------------------------------">28 Followers</a></span></div></div><div class="sf l"></div></div><div class="h k"><div class="ab"><span><button class="be b bf z qz pr ra rb rc rd re rf rg gz rh ri rj rk rl rm ec bl rn pg">Follow</button></span><div class="ro l"><div><div><div class="bl" aria-hidden="false" aria-describedby="354" aria-labelledby="354"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F832ec67a9974&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40tg6897%2Fdesign-in-memory-streams-e47e49068028&amp;newsletterV3=bf5235fee8bb&amp;newsletterV3Id=832ec67a9974&amp;user=Tushar+Gupta&amp;userId=bf5235fee8bb&amp;source=-----e47e49068028---------------------subscribe_user-----------"><button class="be b bf z qz am ra rb rc rd re rf rg gz rh ri rj rl rm ec bl rn pg" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="acl rq rr"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="sg bg sh si sj sk sl sm"></div></div></div><div class="ab ca"><div class="ch bg dx dy dz ea"><div class="sn so l"><h2 class="be sb gr z eu bj">More from Tushar Gupta</h2></div><div class="sp ab iq hf sq sr ss st su sv sw sx sy sz ta tb tc td te"><div class="tf tg th ti tj tk tl tm tn to tp tq tr ts tt tu tv tw tx ty tz"><div class="ua ub uc ud ue uf l"><article class="uf"><div class="uf qe l"><div class="bg uf"><div class="uf l"><div class="uf ug uh ui uj uk ul um un uo up uq ur us"><div class="ut"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="Class Diagram" rel="noopener follow" href="https://medium.com/@tg6897/design-in-memory-db-with-indexing-52d33adceb91?source=author_recirc-----e47e49068028----0---------------------04055ea3_4e29_4f35_aea2_f8565f4b512c-------"><div class="uv uw ux uy uz"><img alt="Class Diagram" class="bg va vb vc vd bw" src="./Design In-memory Streams._files/1_sjVOwlMIKGOI8ehdXtepsg.png" loading="lazy"></div></a></div><div class="uu ab ca cn"><div class="ve vf vg vh vi ab"><div class="pq l"><div><div class="bl" aria-hidden="false" aria-describedby="10" aria-labelledby="10"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@tg6897?source=author_recirc-----e47e49068028----0---------------------04055ea3_4e29_4f35_aea2_f8565f4b512c-------"><div class="l go"><img alt="Tushar Gupta" class="l ec bx vk vl cw" src="./Design In-memory Streams._files/0_oTCZ2-qduIllbJVV(2).png" width="20" height="20" loading="lazy"><div class="vj bx l vk vl eh n ax gn"></div></div></a></div></div></div><div class="vm l"><div><div class="bl" aria-hidden="false" aria-describedby="11" aria-labelledby="11"><a class="af ag ah ai aj ak al am an ao ap aq ar gt ab q" rel="noopener follow" href="https://medium.com/@tg6897?source=author_recirc-----e47e49068028----0---------------------04055ea3_4e29_4f35_aea2_f8565f4b512c-------"><p class="be b jm z vn vo vp vq vr vs vt vu bj">Tushar Gupta</p></a></div></div></div></div><div class="vv vw vx vy vz wa wb wc wd we l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@tg6897/design-in-memory-db-with-indexing-52d33adceb91?source=author_recirc-----e47e49068028----0---------------------04055ea3_4e29_4f35_aea2_f8565f4b512c-------"><div title=""><h2 class="be ew oc oe wf wg mh of oh wh wi ml lf mn wj wk mo lj mq wl wm mr ln mt wn wo mu vn vp vq vs vu bj">Design  In-Memory DB with indexing</h2></div><div class="wp l"><h3 class="be b gr z vn wq vp vq wr vs vu gw">Here we will design,implement a complete In-memory database with indexing.Helpful for machine coding/systemdesign round in  SDE interviews.</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@tg6897/design-in-memory-db-with-indexing-52d33adceb91?source=author_recirc-----e47e49068028----0---------------------04055ea3_4e29_4f35_aea2_f8565f4b512c-------"><span class="be b jm z gw"><div class="ab q"><span>10 min read</span><span class="gu l" aria-hidden="true"><span class="be b bf z gw">·</span></span><span>Dec 25, 2022</span></div></span></a><div class="ws wt wu wv ww l"><div class="ab co"><div class="am wx wy wz xa xb xc xd xe xf xg ab q"><div class="ab q iq"><div class="pw-multi-vote-icon go ir is it iu"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F52d33adceb91&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40tg6897%2Fdesign-in-memory-db-with-indexing-52d33adceb91&amp;user=Tushar+Gupta&amp;userId=bf5235fee8bb&amp;source=-----52d33adceb91----0-----------------clap_footer----04055ea3_4e29_4f35_aea2_f8565f4b512c-------"><div><div class="bl" aria-hidden="false" aria-describedby="164" aria-labelledby="164"><div class="iv ao ix acd ace jb am jc jd je iu"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l jf jg jh ji jj jk jl"><div><div class="bl" aria-hidden="false" aria-describedby="165" aria-labelledby="165"><p class="be b jm z gw"><button class="af ag ah ai aj ak al am an ao ap aq ar as at acf xt">34<span class="l h g f qm qn"></span></button></p></div></div></div></div><div class="xh l"><div><div class="bl" aria-hidden="false" aria-describedby="12" aria-labelledby="12"><a class="af jr ah iv aj ak al jq an ao ap aq ar as at jp ab q js jt" aria-label="responses" rel="noopener follow" href="https://medium.com/@tg6897/design-in-memory-db-with-indexing-52d33adceb91?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=author_recirc-----e47e49068028----0---------------------04055ea3_4e29_4f35_aea2_f8565f4b512c-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="be b jm z gw"><span class="pw-responses-count jn jo">1</span></p></a></div></div></div></div><div class="ab q xi xj"><div><div class="bl" aria-hidden="false" aria-describedby="167" aria-labelledby="167"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F52d33adceb91&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40tg6897%2Fdesign-in-memory-db-with-indexing-52d33adceb91&amp;source=-----e47e49068028----0-----------------bookmark_preview----04055ea3_4e29_4f35_aea2_f8565f4b512c-------"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="gw xt"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div><div class="j i d"><div class="sg bg sh lt"></div></div></div></div></div></div></div></article></div></div><div class="tf tg th ti tj tk tl tm tn to tp tq tr ts tt tu tv tw tx ty tz"><div class="ua ub uc ud ue uf l"><article class="uf"><div class="uf qe l"><div class="bg uf"><div class="uf l"><div class="uf ug uh ui uj uk ul um un uo up uq ur us"><div class="ut"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="Design In-memory Streams: Part 2" rel="noopener follow" href="https://medium.com/@tg6897/design-in-memory-streams-part-2-76744f7afa11?source=author_recirc-----e47e49068028----1---------------------04055ea3_4e29_4f35_aea2_f8565f4b512c-------"><div class="uv uw ux uy uz"><img alt="Design In-memory Streams: Part 2" class="bg va vb vc vd bw" src="./Design In-memory Streams._files/1_ToCNOXaPjaPzFkRRVmj_Mw.png" loading="lazy"></div></a></div><div class="uu ab ca cn"><div class="ve vf vg vh vi ab"><div class="pq l"><div><div class="bl" aria-hidden="false" aria-describedby="13" aria-labelledby="13"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@tg6897?source=author_recirc-----e47e49068028----1---------------------04055ea3_4e29_4f35_aea2_f8565f4b512c-------"><div class="l go"><img alt="Tushar Gupta" class="l ec bx vk vl cw" src="./Design In-memory Streams._files/0_oTCZ2-qduIllbJVV(2).png" width="20" height="20" loading="lazy"><div class="vj bx l vk vl eh n ax gn"></div></div></a></div></div></div><div class="vm l"><div><div class="bl" aria-hidden="false" aria-describedby="14" aria-labelledby="14"><a class="af ag ah ai aj ak al am an ao ap aq ar gt ab q" rel="noopener follow" href="https://medium.com/@tg6897?source=author_recirc-----e47e49068028----1---------------------04055ea3_4e29_4f35_aea2_f8565f4b512c-------"><p class="be b jm z vn vo vp vq vr vs vt vu bj">Tushar Gupta</p></a></div></div></div></div><div class="vv vw vx vy vz wa wb wc wd we l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@tg6897/design-in-memory-streams-part-2-76744f7afa11?source=author_recirc-----e47e49068028----1---------------------04055ea3_4e29_4f35_aea2_f8565f4b512c-------"><div title=""><h2 class="be ew oc oe wf wg mh of oh wh wi ml lf mn wj wk mo lj mq wl wm mr ln mt wn wo mu vn vp vq vs vu bj">Design In-memory Streams: Part 2</h2></div><div class="wp l"><h3 class="be b gr z vn wq vp vq wr vs vu gw">This is the continuation of the story Design In-memory Streams in which we designed a data streaming service in memory.</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@tg6897/design-in-memory-streams-part-2-76744f7afa11?source=author_recirc-----e47e49068028----1---------------------04055ea3_4e29_4f35_aea2_f8565f4b512c-------"><span class="be b jm z gw"><div class="ab q"><span>16 min read</span><span class="gu l" aria-hidden="true"><span class="be b bf z gw">·</span></span><span>May 14</span></div></span></a><div class="ws wt wu wv ww l"><div class="ab co"><div class="am wx wy wz xa xb xc xd xe xf xg ab q"><div class="ab q iq"><div class="pw-multi-vote-icon go ir is it iu"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F76744f7afa11&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40tg6897%2Fdesign-in-memory-streams-part-2-76744f7afa11&amp;user=Tushar+Gupta&amp;userId=bf5235fee8bb&amp;source=-----76744f7afa11----1-----------------clap_footer----04055ea3_4e29_4f35_aea2_f8565f4b512c-------"><div><div class="bl" aria-hidden="false" aria-describedby="170" aria-labelledby="170"><div class="iv ao ix acd ace jb am jc jd je iu"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l jf jg jh ji jj jk jl"><div><div class="bl" aria-hidden="false" aria-describedby="171" aria-labelledby="171"><p class="be b jm z gw"><button class="af ag ah ai aj ak al am an ao ap aq ar as at acf xt">2<span class="l h g f qm qn"></span></button></p></div></div></div></div><div class="xh l"><div><div class="bl" aria-hidden="false" aria-describedby="15" aria-labelledby="15"><a class="af jr ah iv aj ak al jq an ao ap aq ar as at jp ab q js jt" aria-label="responses" rel="noopener follow" href="https://medium.com/@tg6897/design-in-memory-streams-part-2-76744f7afa11?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=author_recirc-----e47e49068028----1---------------------04055ea3_4e29_4f35_aea2_f8565f4b512c-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></a></div></div></div></div><div class="ab q xi xj"><div><div class="bl" aria-hidden="false" aria-describedby="173" aria-labelledby="173"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F76744f7afa11&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40tg6897%2Fdesign-in-memory-streams-part-2-76744f7afa11&amp;source=-----e47e49068028----1-----------------bookmark_preview----04055ea3_4e29_4f35_aea2_f8565f4b512c-------"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="gw xt"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></div></div></div></div></div></article></div></div></div><div class="sg bg sh dj dk xk xl xm"></div><div class="ab hd he xn xo xp"><a class="be b bf z bj pr xq xr xs xt js xu rf rg gz xv xw xx rj xy xz ya yb yc rl rm ec bl rn pg" rel="noopener follow" href="https://medium.com/@tg6897?source=post_page-----e47e49068028--------------------------------"><div class="l pg">See all from Tushar Gupta</div></a></div></div></div><div class="sg bg sh yd ye yf yg yh"></div><div class="ab ca"><div class="ch bg dx dy dz ea"><div class="yi yj l"><h2 class="be sb oc oe mh of oh ml oi ok ol om oo op oq os ot bj">Recommended from Medium</h2><div class="mz na nb nc nd l"><div class="sp ab iq hf sq sr ss st su sv sw sx sy sz ta tb tc td te"><div class="tf tg th ti tj tk tl tm tn to tp tq tr ts tt tu tv tw tx ty tz"><div class="ua ub uc ud ue uf l"><article class="uf"><div class="uf qe l"><div class="bg uf"><div class="uf l"><div class="uf ug uh ui uj uk ul um un uo up uq ur us"><div class="ut"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="WebSockets" rel="noopener follow" href="https://medium.com/@sureshpodeti/websockets-a77edb38b191?source=read_next_recirc-----e47e49068028----0---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div class="uv uw ux uy uz"><img alt="WebSockets" class="bg va vb vc vd bw" src="./Design In-memory Streams._files/0_kHwVnlY4KH19k1Mx.jpg" loading="lazy"></div></a></div><div class="uu ab ca cn"><div class="ve vf vg vh vi ab"><div class="pq l"><div><div class="bl" aria-hidden="false" aria-describedby="16" aria-labelledby="16"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@sureshpodeti?source=read_next_recirc-----e47e49068028----0---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div class="l go"><img alt="Suresh Podeti" class="l ec bx vk vl cw" src="./Design In-memory Streams._files/1_H_EnDOcdsYqeLA5LLTzX1Q.jpg" width="20" height="20" loading="lazy"><div class="vj bx l vk vl eh n ax gn"></div></div></a></div></div></div><div class="vm l"><div><div class="bl" aria-hidden="false" aria-describedby="17" aria-labelledby="17"><a class="af ag ah ai aj ak al am an ao ap aq ar gt ab q" rel="noopener follow" href="https://medium.com/@sureshpodeti?source=read_next_recirc-----e47e49068028----0---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><p class="be b jm z vn vo vp vq vr vs vt vu bj">Suresh Podeti</p></a></div></div></div></div><div class="vv vw vx vy vz wa wb wc wd we l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@sureshpodeti/websockets-a77edb38b191?source=read_next_recirc-----e47e49068028----0---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div title=""><h2 class="be ew oc oe wf wg mh of oh wh wi ml lf mn wj wk mo lj mq wl wm mr ln mt wn wo mu vn vp vq vs vu bj">WebSockets</h2></div><div class="wp l"><h3 class="be b gr z vn wq vp vq wr vs vu gw">In the dynamic world of web applications, responsiveness and real-time communication have become crucial aspects of user experience…</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@sureshpodeti/websockets-a77edb38b191?source=read_next_recirc-----e47e49068028----0---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><span class="be b jm z gw"><div class="ab q"><span>3 min read</span><span class="gu l" aria-hidden="true"><span class="be b bf z gw">·</span></span><span>Oct 26</span></div></span></a><div class="ws wt wu wv ww l"><div class="ab co"><div class="am wx wy wz xa xb xc xd xe xf xg ab q"><div class="ab q iq"><div class="pw-multi-vote-icon go ir is it iu"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fa77edb38b191&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40sureshpodeti%2Fwebsockets-a77edb38b191&amp;user=Suresh+Podeti&amp;userId=b204920440ba&amp;source=-----a77edb38b191----0-----------------clap_footer----e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div><div class="bl" aria-hidden="false" aria-describedby="176" aria-labelledby="176"><div class="iv ao ix acd ace jb am jc jd je iu"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l jf jg jh ji jj jk jl"><div><div class="bl" aria-hidden="false" aria-describedby="177" aria-labelledby="177"><p class="be b jm z gw"><button class="af ag ah ai aj ak al am an ao ap aq ar as at acf xt">6<span class="l h g f qm qn"></span></button></p></div></div></div></div><div class="xh l"><div><div class="bl" aria-hidden="false" aria-describedby="18" aria-labelledby="18"><a class="af jr ah iv aj ak al jq an ao ap aq ar as at jp ab q js jt" aria-label="responses" rel="noopener follow" href="https://medium.com/@sureshpodeti/websockets-a77edb38b191?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----e47e49068028----0---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></a></div></div></div></div><div class="ab q xi xj"><div><div class="bl" aria-hidden="false" aria-describedby="179" aria-labelledby="179"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa77edb38b191&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40sureshpodeti%2Fwebsockets-a77edb38b191&amp;source=-----e47e49068028----0-----------------bookmark_preview----e4064737_7505_40b6_aaf4_087a2126f0ca-------"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="gw xt"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div><div class="j i d"><div class="sg bg sh lt"></div></div></div></div></div></div></div></article></div></div><div class="tf tg th ti tj tk tl tm tn to tp tq tr ts tt tu tv tw tx ty tz"><div class="ua ub uc ud ue uf l"><article class="uf"><div class="uf qe l"><div class="bg uf"><div class="uf l"><div class="uf ug uh ui uj uk ul um un uo up uq ur us"><div class="ut"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="System Design: Twitter" rel="noopener follow" href="https://medium.com/@the.york.wei/system-design-twitter-e3bf30d1044c?source=read_next_recirc-----e47e49068028----1---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div class="uv uw ux uy uz"><img alt="System Design: Twitter" class="bg va vb vc vd bw" src="./Design In-memory Streams._files/1_QgyRjMvfMwM9UdFRvHEhrQ.png" loading="lazy"></div></a></div><div class="uu ab ca cn"><div class="ve vf vg vh vi ab"><div class="pq l"><div><div class="bl" aria-hidden="false" aria-describedby="19" aria-labelledby="19"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@the.york.wei?source=read_next_recirc-----e47e49068028----1---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div class="l go"><img alt="York Wei" class="l ec bx vk vl cw" src="./Design In-memory Streams._files/1_o4Px_sFBZdfrTgjJSFEHpA.jpg" width="20" height="20" loading="lazy"><div class="vj bx l vk vl eh n ax gn"></div></div></a></div></div></div><div class="vm l"><div><div class="bl" aria-hidden="false" aria-describedby="20" aria-labelledby="20"><a class="af ag ah ai aj ak al am an ao ap aq ar gt ab q" rel="noopener follow" href="https://medium.com/@the.york.wei?source=read_next_recirc-----e47e49068028----1---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><p class="be b jm z vn vo vp vq vr vs vt vu bj">York Wei</p></a></div></div></div></div><div class="vv vw vx vy vz wa wb wc wd we l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@the.york.wei/system-design-twitter-e3bf30d1044c?source=read_next_recirc-----e47e49068028----1---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div title=""><h2 class="be ew oc oe wf wg mh of oh wh wi ml lf mn wj wk mo lj mq wl wm mr ln mt wn wo mu vn vp vq vs vu bj">System Design: Twitter</h2></div><div class="wp l"><h3 class="be b gr z vn wq vp vq wr vs vu gw">We are designing a system like the social media platform Twitter. Users can post short text and media content. Viewers can search and…</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@the.york.wei/system-design-twitter-e3bf30d1044c?source=read_next_recirc-----e47e49068028----1---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><span class="be b jm z gw"><div class="ab q"><div class="qe ab"><div class="bl" aria-hidden="false" aria-describedby="22" aria-labelledby="22"><button class="l ax ao am" aria-label="Member-only story"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="21" aria-labelledby="21"><svg width="16" height="16" viewBox="0 0 64 64" fill="none"><path d="M39.64 40.83L33.87 56.7a1.99 1.99 0 0 1-3.74 0l-5.77-15.87a2.02 2.02 0 0 0-1.2-1.2L7.3 33.88a1.99 1.99 0 0 1 0-3.74l15.87-5.77a2.02 2.02 0 0 0 1.2-1.2L30.12 7.3a1.99 1.99 0 0 1 3.74 0l5.77 15.87a2.02 2.02 0 0 0 1.2 1.2l15.86 5.76a1.99 1.99 0 0 1 0 3.74l-15.87 5.77a2.02 2.02 0 0 0-1.2 1.2z" fill="#FFC017"></path></svg></div></div></div></button></div></div><span class="gu l" aria-hidden="true"><span class="be b bf z gw">·</span></span><span>3 min read</span><span class="gu l" aria-hidden="true"><span class="be b bf z gw">·</span></span><span>Jul 22</span></div></span></a><div class="ws wt wu wv ww l"><div class="ab co"><div class="am wx wy wz xa xb xc xd xe xf xg ab q"><div class="ab q iq"><div class="pw-multi-vote-icon go ir is it iu"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fe3bf30d1044c&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40the.york.wei%2Fsystem-design-twitter-e3bf30d1044c&amp;user=York+Wei&amp;userId=a1babd0c10b6&amp;source=-----e3bf30d1044c----1-----------------clap_footer----e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div><div class="bl" aria-hidden="false" aria-describedby="182" aria-labelledby="182"><div class="iv ao ix acd ace jb am jc jd je iu"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l jf jg jh ji jj jk jl"><div><div class="bl" aria-hidden="false" aria-describedby="183" aria-labelledby="183"><p class="be b jm z gw"><button class="af ag ah ai aj ak al am an ao ap aq ar as at acf xt">51<span class="l h g f qm qn"></span></button></p></div></div></div></div><div class="xh l"><div><div class="bl" aria-hidden="false" aria-describedby="23" aria-labelledby="23"><a class="af jr ah iv aj ak al jq an ao ap aq ar as at jp ab q js jt" aria-label="responses" rel="noopener follow" href="https://medium.com/@the.york.wei/system-design-twitter-e3bf30d1044c?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----e47e49068028----1---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="be b jm z gw"><span class="pw-responses-count jn jo">1</span></p></a></div></div></div></div><div class="ab q xi xj"><div><div class="bl" aria-hidden="false" aria-describedby="185" aria-labelledby="185"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3bf30d1044c&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40the.york.wei%2Fsystem-design-twitter-e3bf30d1044c&amp;source=-----e47e49068028----1-----------------bookmark_preview----e4064737_7505_40b6_aaf4_087a2126f0ca-------"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="gw xt"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></div></div></div></div></div></article></div></div></div></div><div class="sg bg sh yk"></div><h2 class="be sb gr z eu bj">Lists</h2><div class="lt l"><div class="cm ab iq hf sq sr ss st su sv sw sx sy sz ta tb tc td te"><div class="tf tg th ti tj tk tl tm tn to tp tq tr ts tt tu tv tw tx ty tz"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab ck cm" rel="noopener follow" href="https://medium.com/@william.dai/list/newreadinglist-d8e941a8265f?source=read_next_recirc-----e47e49068028--------------------------------"><div class="yr ys vn ab hc go"><div class="go va ym bw yn"><div class="va gi vn l"><img alt="Databricks role-based and specialty certification line-up." class="" src="./Design In-memory Streams._files/1_5eWqBgW5YPFY1SXPu8YkZw.jpg" width="48" height="48" loading="lazy"></div></div><div class="go va ym bw yo yp"><div class="va gi vn l"><img alt="" class="" src="./Design In-memory Streams._files/0_zcJa6-vVfQ1ESpQh.png" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="go va bw qg yq"><div class="va gi vn l"><img alt="" class="" src="./Design In-memory Streams._files/1_Cw-ig4gq9DXIqEXANhNvqQ.jpg" width="48" height="48" loading="lazy" role="presentation"></div></div></div><div class="aw l"><h2 class="be sb gr z vn wq vp vq wr vs vu eu bj">New_Reading_List</h2><div class="be b jm z gw ab yl">174 stories<span class="gu l" aria-hidden="true"><span class="be b bf z gw">·</span></span>198 saves</div></div></a></div><div class="tf tg th ti tj tk tl tm tn to tp tq tr ts tt tu tv tw tx ty tz"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab ck cm" rel="noopener follow" href="https://medium.com/@AMGAS14/list/natural-language-processing-0a856388a93a?source=read_next_recirc-----e47e49068028--------------------------------"><div class="yr ys vn ab hc go"><div class="go va ym bw yn"><div class="va gi vn l"><img alt="" class="" src="./Design In-memory Streams._files/1_4OR13xMgpAi0luqiE_3T9w.png" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="go va ym bw yo yp"><div class="va gi vn l"><img alt="" class="" src="./Design In-memory Streams._files/1_paPlyErkyfOkRPVUNlyBig.png" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="go va bw qg yq"><div class="va gi vn l"><img alt="" class="" src="./Design In-memory Streams._files/0_KGAoMj_kp91ianj5.jpg" width="48" height="48" loading="lazy" role="presentation"></div></div></div><div class="aw l"><h2 class="be sb gr z vn wq vp vq wr vs vu eu bj">Natural Language Processing</h2><div class="be b jm z gw ab yl">889 stories<span class="gu l" aria-hidden="true"><span class="be b bf z gw">·</span></span>413 saves</div></div></a></div></div></div><div class="sg bg sh yt dj yu dk yv yw yx yy yz za"></div><div class="sp ab iq hf sq sr ss st su sv sw sx sy sz ta tb tc td te"><div class="tf tg th ti tj tk tl tm tn to tp tq tr ts tt tu tv tw tx ty tz"><div class="ua ub uc ud ue uf l"><article class="uf"><div class="uf qe l"><div class="bg uf"><div class="uf l"><div class="uf ug uh ui uj uk ul um un uo up uq ur us"><div class="ut"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="What are Webhooks and How to Use Them" rel="noopener follow" href="https://medium.com/@learnwithwhiteboard_digest/what-are-webhooks-and-how-to-use-them-2fb65605d323?source=read_next_recirc-----e47e49068028----0---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div class="uv uw ux uy uz"><img alt="What are Webhooks and How to Use Them" class="bg va vb vc vd bw" src="./Design In-memory Streams._files/0_ms15sm3quRbb0Ky4.gif" loading="lazy"></div></a></div><div class="uu ab ca cn"><div class="ve vf vg vh vi ab"><div class="pq l"><div><div class="bl" aria-hidden="false" aria-describedby="24" aria-labelledby="24"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@learnwithwhiteboard_digest?source=read_next_recirc-----e47e49068028----0---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div class="l go"><img alt="Learn With Whiteboard" class="l ec bx vk vl cw" src="./Design In-memory Streams._files/1_aJ-0u8l-tql1EEz7WQ7Wzw.jpg" width="20" height="20" loading="lazy"><div class="vj bx l vk vl eh n ax gn"></div></div></a></div></div></div><div class="vm l"><div><div class="bl" aria-hidden="false" aria-describedby="25" aria-labelledby="25"><a class="af ag ah ai aj ak al am an ao ap aq ar gt ab q" rel="noopener follow" href="https://medium.com/@learnwithwhiteboard_digest?source=read_next_recirc-----e47e49068028----0---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><p class="be b jm z vn vo vp vq vr vs vt vu bj">Learn With Whiteboard</p></a></div></div></div></div><div class="vv vw vx vy vz wa wb wc wd we l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@learnwithwhiteboard_digest/what-are-webhooks-and-how-to-use-them-2fb65605d323?source=read_next_recirc-----e47e49068028----0---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div title=""><h2 class="be ew oc oe wf wg mh of oh wh wi ml lf mn wj wk mo lj mq wl wm mr ln mt wn wo mu vn vp vq vs vu bj">What are Webhooks and How to Use Them</h2></div><div class="wp l"><h3 class="be b gr z vn wq vp vq wr vs vu gw">Webhooks 101: Everything You Need to Know About Real-Time Web Integration</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@learnwithwhiteboard_digest/what-are-webhooks-and-how-to-use-them-2fb65605d323?source=read_next_recirc-----e47e49068028----0---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><span class="be b jm z gw"><div class="ab q"><span>8 min read</span><span class="gu l" aria-hidden="true"><span class="be b bf z gw">·</span></span>5 days ago</div></span></a><div class="ws wt wu wv ww l"><div class="ab co"><div class="am wx wy wz xa xb xc xd xe xf xg ab q"><div class="ab q iq"><div class="pw-multi-vote-icon go ir is it iu"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F2fb65605d323&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40learnwithwhiteboard_digest%2Fwhat-are-webhooks-and-how-to-use-them-2fb65605d323&amp;user=Learn+With+Whiteboard&amp;userId=f0c8fcbec7a2&amp;source=-----2fb65605d323----0-----------------clap_footer----e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div><div class="bl" aria-hidden="false" aria-describedby="188" aria-labelledby="188"><div class="iv ao ix acd ace jb am jc jd je iu"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l jf jg jh ji jj jk jl"><div><div class="bl" aria-hidden="false" aria-describedby="189" aria-labelledby="189"><p class="be b jm z gw"><button class="af ag ah ai aj ak al am an ao ap aq ar as at acf xt">2<span class="l h g f qm qn"></span></button></p></div></div></div></div><div class="xh l"><div><div class="bl" aria-hidden="false" aria-describedby="26" aria-labelledby="26"><a class="af jr ah iv aj ak al jq an ao ap aq ar as at jp ab q js jt" aria-label="responses" rel="noopener follow" href="https://medium.com/@learnwithwhiteboard_digest/what-are-webhooks-and-how-to-use-them-2fb65605d323?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----e47e49068028----0---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></a></div></div></div></div><div class="ab q xi xj"><div><div class="bl" aria-hidden="false" aria-describedby="191" aria-labelledby="191"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2fb65605d323&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40learnwithwhiteboard_digest%2Fwhat-are-webhooks-and-how-to-use-them-2fb65605d323&amp;source=-----e47e49068028----0-----------------bookmark_preview----e4064737_7505_40b6_aaf4_087a2126f0ca-------"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="gw xt"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div><div class="j i d"><div class="sg bg sh lt"></div></div></div></div></div></div></div></article></div></div><div class="tf tg th ti tj tk tl tm tn to tp tq tr ts tt tu tv tw tx ty tz"><div class="ua ub uc ud ue uf l"><article class="uf"><div class="uf qe l"><div class="bg uf"><div class="uf l"><div class="uf ug uh ui uj uk ul um un uo up uq ur us"><div class="ut"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="System Design: Building an In-Memory Key-Value Store (JS)" rel="noopener follow" href="https://medium.com/@geekpaul/system-design-building-an-in-memory-key-value-store-js-4d3aa9aec31c?source=read_next_recirc-----e47e49068028----1---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div class="uv uw ux uy uz"><img alt="System Design: Building an In-Memory Key-Value Store (JS)" class="bg va vb vc vd bw" src="./Design In-memory Streams._files/0_wg80F_uJi0s8lNuz.png" loading="lazy"></div></a></div><div class="uu ab ca cn"><div class="ve vf vg vh vi ab"><div class="pq l"><div><div class="bl" aria-hidden="false" aria-describedby="27" aria-labelledby="27"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@geekpaul?source=read_next_recirc-----e47e49068028----1---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div class="l go"><img alt="Arindam Paul" class="l ec bx vk vl cw" src="./Design In-memory Streams._files/0_muQIIHi5S4_sgN-X.jpg" width="20" height="20" loading="lazy"><div class="vj bx l vk vl eh n ax gn"></div></div></a></div></div></div><div class="vm l"><div><div class="bl" aria-hidden="false" aria-describedby="28" aria-labelledby="28"><a class="af ag ah ai aj ak al am an ao ap aq ar gt ab q" rel="noopener follow" href="https://medium.com/@geekpaul?source=read_next_recirc-----e47e49068028----1---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><p class="be b jm z vn vo vp vq vr vs vt vu bj">Arindam Paul</p></a></div></div></div></div><div class="vv vw vx vy vz wa wb wc wd we l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@geekpaul/system-design-building-an-in-memory-key-value-store-js-4d3aa9aec31c?source=read_next_recirc-----e47e49068028----1---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div title=""><h2 class="be ew oc oe wf wg mh of oh wh wi ml lf mn wj wk mo lj mq wl wm mr ln mt wn wo mu vn vp vq vs vu bj">System Design: Building an In-Memory Key-Value Store (JS)</h2></div><div class="wp l"><h3 class="be b gr z vn wq vp vq wr vs vu gw">Design a simple in memory key-value store which provides, basic get, set and delete operations. Once done, add transactional support to it…</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@geekpaul/system-design-building-an-in-memory-key-value-store-js-4d3aa9aec31c?source=read_next_recirc-----e47e49068028----1---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><span class="be b jm z gw"><div class="ab q"><span>8 min read</span><span class="gu l" aria-hidden="true"><span class="be b bf z gw">·</span></span><span>Jul 3</span></div></span></a><div class="ws wt wu wv ww l"><div class="ab co"><div class="am wx wy wz xa xb xc xd xe xf xg ab q"><div class="ab q iq"><div class="pw-multi-vote-icon go ir is it iu"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F4d3aa9aec31c&amp;operation=register&amp;redirect=https%3A%2F%2Fgeekpaul.medium.com%2Fsystem-design-building-an-in-memory-key-value-store-js-4d3aa9aec31c&amp;user=Arindam+Paul&amp;userId=2e1f48c56d56&amp;source=-----4d3aa9aec31c----1-----------------clap_footer----e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div><div class="bl" aria-hidden="false" aria-describedby="194" aria-labelledby="194"><div class="iv ao ix acd ace jb am jc jd je iu"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l jf jg jh ji jj jk jl"><div><div class="bl" aria-hidden="false" aria-describedby="195" aria-labelledby="195"><p class="be b jm z gw"><button class="af ag ah ai aj ak al am an ao ap aq ar as at acf xt">3<span class="l h g f qm qn"></span></button></p></div></div></div></div><div class="xh l"><div><div class="bl" aria-hidden="false" aria-describedby="29" aria-labelledby="29"><a class="af jr ah iv aj ak al jq an ao ap aq ar as at jp ab q js jt" aria-label="responses" rel="noopener follow" href="https://medium.com/@geekpaul/system-design-building-an-in-memory-key-value-store-js-4d3aa9aec31c?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----e47e49068028----1---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></a></div></div></div></div><div class="ab q xi xj"><div><div class="bl" aria-hidden="false" aria-describedby="197" aria-labelledby="197"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d3aa9aec31c&amp;operation=register&amp;redirect=https%3A%2F%2Fgeekpaul.medium.com%2Fsystem-design-building-an-in-memory-key-value-store-js-4d3aa9aec31c&amp;source=-----e47e49068028----1-----------------bookmark_preview----e4064737_7505_40b6_aaf4_087a2126f0ca-------"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="gw xt"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div><div class="j i d"><div class="sg bg sh lt"></div></div></div></div></div></div></div></article></div></div><div class="tf tg th ti tj tk tl tm tn to tp tq tr ts tt tu tv tw tx ty tz"><div class="ua ub uc ud ue uf l"><article class="uf"><div class="uf qe l"><div class="bg uf"><div class="uf l"><div class="uf ug uh ui uj uk ul um un uo up uq ur us"><div class="ut"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="Stream Processing Basics — Stateless Operations" rel="noopener follow" href="https://medium.com/event-driven-utopia/stream-processing-basics-stateless-operations-c6e86a8296e1?source=read_next_recirc-----e47e49068028----2---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div class="uv uw ux uy uz"><img alt="Stream Processing Basics — Stateless Operations" class="bg va vb vc vd bw" src="./Design In-memory Streams._files/1_jXRO9mIZ-T6lk-vipfs9Iw.png" loading="lazy"></div></a></div><div class="uu ab ca cn"><div class="ve vf vg vh vi ab"><div class="pq l"><div><div class="bl" aria-hidden="false" aria-describedby="30" aria-labelledby="30"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@dunith?source=read_next_recirc-----e47e49068028----2---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div class="l go"><img alt="Dunith Danushka" class="l ec bx vk vl cw" src="./Design In-memory Streams._files/1_6QgK80Oqp39NYWfviOmDag.png" width="20" height="20" loading="lazy"><div class="vj bx l vk vl eh n ax gn"></div></div></a></div></div></div><div class="vm l"><div><div class="bl" aria-hidden="false" aria-describedby="31" aria-labelledby="31"><a class="af ag ah ai aj ak al am an ao ap aq ar gt ab q" rel="noopener follow" href="https://medium.com/@dunith?source=read_next_recirc-----e47e49068028----2---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><p class="be b jm z vn vo vp vq vr vs vt vu bj">Dunith Danushka</p></a></div></div></div><div class="vm l"><p class="be b jm z gw">in</p></div><div class="l"><div><div class="bl" aria-hidden="false" aria-describedby="32" aria-labelledby="32"><a class="af ag ah ai aj ak al am an ao ap aq ar gt ab q" href="https://medium.com/event-driven-utopia?source=read_next_recirc-----e47e49068028----2---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------" rel="noopener follow"><p class="be b jm z vn vo vp vq vr vs vt vu bj">Tributary Data</p></a></div></div></div></div><div class="vv vw vx vy vz wa wb wc wd we l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/event-driven-utopia/stream-processing-basics-stateless-operations-c6e86a8296e1?source=read_next_recirc-----e47e49068028----2---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div title=""><h2 class="be ew oc oe wf wg mh of oh wh wi ml lf mn wj wk mo lj mq wl wm mr ln mt wn wo mu vn vp vq vs vu bj">Stream Processing Basics — Stateless Operations</h2></div><div class="wp l"><h3 class="be b gr z vn wq vp vq wr vs vu gw">A technology-agnostic explanation of stateless operators in stream processing.</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/event-driven-utopia/stream-processing-basics-stateless-operations-c6e86a8296e1?source=read_next_recirc-----e47e49068028----2---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><span class="be b jm z gw"><div class="ab q"><div class="qe ab"><div class="bl" aria-hidden="false" aria-describedby="34" aria-labelledby="34"><button class="l ax ao am" aria-label="Member-only story"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="33" aria-labelledby="33"><svg width="16" height="16" viewBox="0 0 64 64" fill="none"><path d="M39.64 40.83L33.87 56.7a1.99 1.99 0 0 1-3.74 0l-5.77-15.87a2.02 2.02 0 0 0-1.2-1.2L7.3 33.88a1.99 1.99 0 0 1 0-3.74l15.87-5.77a2.02 2.02 0 0 0 1.2-1.2L30.12 7.3a1.99 1.99 0 0 1 3.74 0l5.77 15.87a2.02 2.02 0 0 0 1.2 1.2l15.86 5.76a1.99 1.99 0 0 1 0 3.74l-15.87 5.77a2.02 2.02 0 0 0-1.2 1.2z" fill="#FFC017"></path></svg></div></div></div></button></div></div><span class="gu l" aria-hidden="true"><span class="be b bf z gw">·</span></span><span>5 min read</span><span class="gu l" aria-hidden="true"><span class="be b bf z gw">·</span></span>4 days ago</div></span></a><div class="ws wt wu wv ww l"><div class="ab co"><div class="am wx wy wz xa xb xc xd xe xf xg ab q"><div class="ab q iq"><div class="pw-multi-vote-icon go ir is it iu"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fevent-driven-utopia%2Fc6e86a8296e1&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fevent-driven-utopia%2Fstream-processing-basics-stateless-operations-c6e86a8296e1&amp;user=Dunith+Danushka&amp;userId=a927ff67ee5&amp;source=-----c6e86a8296e1----2-----------------clap_footer----e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div><div class="bl" aria-hidden="false" aria-describedby="201" aria-labelledby="201"><div class="iv ao ix acd ace jb am jc jd je iu"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l jf jg jh ji jj jk jl"><div><div class="bl" aria-hidden="false" aria-describedby="202" aria-labelledby="202"><p class="be b jm z gw"><button class="af ag ah ai aj ak al am an ao ap aq ar as at acf xt">121<span class="l h g f qm qn"></span></button></p></div></div></div></div><div class="xh l"><div><div class="bl" aria-hidden="false" aria-describedby="35" aria-labelledby="35"><a class="af jr ah iv aj ak al jq an ao ap aq ar as at jp ab q js jt" aria-label="responses" rel="noopener follow" href="https://medium.com/event-driven-utopia/stream-processing-basics-stateless-operations-c6e86a8296e1?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----e47e49068028----2---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></a></div></div></div></div><div class="ab q xi xj"><div><div class="bl" aria-hidden="false" aria-describedby="204" aria-labelledby="204"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc6e86a8296e1&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fevent-driven-utopia%2Fstream-processing-basics-stateless-operations-c6e86a8296e1&amp;source=-----e47e49068028----2-----------------bookmark_preview----e4064737_7505_40b6_aaf4_087a2126f0ca-------"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="gw xt"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div><div class="j i d"><div class="sg bg sh lt"></div></div></div></div></div></div></div></article></div></div><div class="tf tg th ti tj tk tl tm tn to tp tq tr ts tt tu tv tw tx ty tz"><div class="ua ub uc ud ue uf l"><article class="uf"><div class="uf qe l"><div class="bg uf"><div class="uf l"><div class="uf ug uh ui uj uk ul um un uo up uq ur us"><div class="ut"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="System Design — Achieving Consistency Using Transaction Outbox Pattern" rel="noopener follow" href="https://medium.com/@systemdesignbychk/system-design-achieving-consistency-using-transaction-outbox-pattern-351fcad33de0?source=read_next_recirc-----e47e49068028----3---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div class="uv uw ux uy uz"><img alt="System Design — Achieving Consistency Using Transaction Outbox Pattern" class="bg va vb vc vd bw" src="./Design In-memory Streams._files/1_zWDMCeterfUrICSSP5W34A.jpg" loading="lazy"></div></a></div><div class="uu ab ca cn"><div class="ve vf vg vh vi ab"><div class="pq l"><div><div class="bl" aria-hidden="false" aria-describedby="36" aria-labelledby="36"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@systemdesignbychk?source=read_next_recirc-----e47e49068028----3---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div class="l go"><img alt="System Design By CHK" class="l ec bx vk vl cw" src="./Design In-memory Streams._files/1_rPFZ8HjB22JLGNyDB8XZlg.png" width="20" height="20" loading="lazy"><div class="vj bx l vk vl eh n ax gn"></div></div></a></div></div></div><div class="vm l"><div><div class="bl" aria-hidden="false" aria-describedby="37" aria-labelledby="37"><a class="af ag ah ai aj ak al am an ao ap aq ar gt ab q" rel="noopener follow" href="https://medium.com/@systemdesignbychk?source=read_next_recirc-----e47e49068028----3---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><p class="be b jm z vn vo vp vq vr vs vt vu bj">System Design By CHK</p></a></div></div></div></div><div class="vv vw vx vy vz wa wb wc wd we l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@systemdesignbychk/system-design-achieving-consistency-using-transaction-outbox-pattern-351fcad33de0?source=read_next_recirc-----e47e49068028----3---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div title=""><h2 class="be ew oc oe wf wg mh of oh wh wi ml lf mn wj wk mo lj mq wl wm mr ln mt wn wo mu vn vp vq vs vu bj">System Design — Achieving Consistency Using Transaction Outbox Pattern</h2></div><div class="wp l"><h3 class="be b gr z vn wq vp vq wr vs vu gw">In today’s distributed systems, maintaining consistency across multiple services can be complex, particularly in scenarios like order…</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/@systemdesignbychk/system-design-achieving-consistency-using-transaction-outbox-pattern-351fcad33de0?source=read_next_recirc-----e47e49068028----3---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><span class="be b jm z gw"><div class="ab q"><span>3 min read</span><span class="gu l" aria-hidden="true"><span class="be b bf z gw">·</span></span><span>Jun 10</span></div></span></a><div class="ws wt wu wv ww l"><div class="ab co"><div class="am wx wy wz xa xb xc xd xe xf xg ab q"><div class="ab q iq"><div class="pw-multi-vote-icon go ir is it iu"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F351fcad33de0&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40systemdesignbychk%2Fsystem-design-achieving-consistency-using-transaction-outbox-pattern-351fcad33de0&amp;user=System+Design+By+CHK&amp;userId=ccf8ff243c25&amp;source=-----351fcad33de0----3-----------------clap_footer----e4064737_7505_40b6_aaf4_087a2126f0ca-------"><div><div class="bl" aria-hidden="false" aria-describedby="207" aria-labelledby="207"><div class="iv ao ix acd ace jb am jc jd je iu"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l jf jg jh ji jj jk jl"><div><div class="bl" aria-hidden="false" aria-describedby="208" aria-labelledby="208"><p class="be b jm z gw"><button class="af ag ah ai aj ak al am an ao ap aq ar as at acf xt">58<span class="l h g f qm qn"></span></button></p></div></div></div></div><div class="xh l"><div><div class="bl" aria-hidden="false" aria-describedby="38" aria-labelledby="38"><a class="af jr ah iv aj ak al jq an ao ap aq ar as at jp ab q js jt" aria-label="responses" rel="noopener follow" href="https://medium.com/@systemdesignbychk/system-design-achieving-consistency-using-transaction-outbox-pattern-351fcad33de0?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----e47e49068028----3---------------------e4064737_7505_40b6_aaf4_087a2126f0ca-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></a></div></div></div></div><div class="ab q xi xj"><div><div class="bl" aria-hidden="false" aria-describedby="210" aria-labelledby="210"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F351fcad33de0&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40systemdesignbychk%2Fsystem-design-achieving-consistency-using-transaction-outbox-pattern-351fcad33de0&amp;source=-----e47e49068028----3-----------------bookmark_preview----e4064737_7505_40b6_aaf4_087a2126f0ca-------"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="gw xt"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></div></div></div></div></div></article></div></div></div><div class="sg bg sh dj dk xk xl xm"></div><a class="be b bf z bj pr xq xr xs xt js xu rf rg gz xv xw xx rj xy xz ya yb yc rl rm ec bl rn pg" rel="noopener follow" href="https://medium.com/?source=post_page-----e47e49068028--------------------------------"><div class="l pg">See more recommendations</div></a></div></div></div><div class="h k j"><div class="sg bg sh zb"></div><div class="ab ca"><div class="ch bg dx dy dz ea"><div class="zc ab iq hf"><div class="zd ze l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----e47e49068028--------------------------------" rel="noopener follow"><p class="be b jm z gw">Help</p></a></div><div class="zd ze l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----e47e49068028--------------------------------" rel="noopener follow"><p class="be b jm z gw">Status</p></a></div><div class="zd ze l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----e47e49068028--------------------------------" rel="noopener follow"><p class="be b jm z gw">About</p></a></div><div class="zd ze l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----e47e49068028--------------------------------"><p class="be b jm z gw">Careers</p></a></div><div class="zd ze l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----e47e49068028--------------------------------" rel="noopener follow"><p class="be b jm z gw">Blog</p></a></div><div class="zd ze l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e47e49068028--------------------------------" rel="noopener follow"><p class="be b jm z gw">Privacy</p></a></div><div class="zd ze l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e47e49068028--------------------------------" rel="noopener follow"><p class="be b jm z gw">Terms</p></a></div><div class="zd ze l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----e47e49068028--------------------------------" rel="noopener follow"><p class="be b jm z gw">Text to speech</p></a></div><div class="zd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="https://medium.com/business?source=post_page-----e47e49068028--------------------------------"><p class="be b jm z gw">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20231124-091229-1a820a2bf5"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-e47e49068028","user-bf5235fee8bb"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"inDisabledExperiment":false,"loHomepageEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"65f7e0e6-1af2-4556-a79d-20cb9f45cef7","hybridDevServices":[],"originalSpanCarrier":{"ot-tracer-spanid":"3ed9363f41505d9e","ot-tracer-traceid":"1d7a6255e29ca96f","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002F@tg6897\u002Fdesign-in-memory-streams-e47e49068028","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20231124-091229-1a820a2bf5","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20231124-091229-1a820a2bf5","commit":"1a820a2bf5c40d3cb1bc56772908c6ea6d18e78c"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","isLoggedIn":false,"collectionByDomainOrSlug({\"domainOrSlug\":\"medium.com\"})":null,"postResult({\"id\":\"e47e49068028\"})":{"__ref":"Post:e47e49068028"},"recirc({\"paging\":{\"limit\":6},\"postId\":\"e47e49068028\"})":{"__typename":"RexRecircResult","items":[{"__typename":"RexRecircItem","feedId":"e4064737-7505-40b6-aaf4-087a2126f0ca","post":{"__ref":"Post:a77edb38b191"}},{"__typename":"RexRecircItem","feedId":"e4064737-7505-40b6-aaf4-087a2126f0ca","post":{"__ref":"Post:e3bf30d1044c"}},{"__typename":"RexRecircItem","feedId":"e4064737-7505-40b6-aaf4-087a2126f0ca","post":{"__ref":"Post:2fb65605d323"}},{"__typename":"RexRecircItem","feedId":"e4064737-7505-40b6-aaf4-087a2126f0ca","post":{"__ref":"Post:4d3aa9aec31c"}},{"__typename":"RexRecircItem","feedId":"e4064737-7505-40b6-aaf4-087a2126f0ca","post":{"__ref":"Post:c6e86a8296e1"}},{"__typename":"RexRecircItem","feedId":"e4064737-7505-40b6-aaf4-087a2126f0ca","post":{"__ref":"Post:351fcad33de0"}}]},"postCatalogRecirc({\"pagingOptions\":{\"limit\":4},\"postId\":\"e47e49068028\"})":{"__typename":"CatalogsConnection","catalogs":[{"__ref":"Catalog:d8e941a8265f"},{"__ref":"Catalog:0a856388a93a"}]},"authorCollectionRecircFeed({\"input\":{\"paging\":{\"limit\":4},\"postId\":\"e47e49068028\"}})":{"__typename":"AuthorCollectionRecircFeedResult","items":[{"__typename":"HomeFeedItem","post":{"__ref":"Post:52d33adceb91"},"feedId":"04055ea3-4e29-4f35-aea2-f8565f4b512c"},{"__typename":"HomeFeedItem","post":{"__ref":"Post:76744f7afa11"},"feedId":"04055ea3-4e29-4f35-aea2-f8565f4b512c"}]}},"LinkedAccounts:bf5235fee8bb":{"__typename":"LinkedAccounts","mastodon":null,"id":"bf5235fee8bb"},"UserViewerEdge:userId:bf5235fee8bb-viewerId:lo_637abe8e8c62":{"__typename":"UserViewerEdge","id":"userId:bf5235fee8bb-viewerId:lo_637abe8e8c62","isFollowing":false,"isUser":false},"NewsletterV3:832ec67a9974":{"__typename":"NewsletterV3","id":"832ec67a9974","type":"NEWSLETTER_TYPE_AUTHOR","slug":"bf5235fee8bb","name":"bf5235fee8bb","collection":null,"user":{"__ref":"User:bf5235fee8bb"}},"User:bf5235fee8bb":{"__typename":"User","id":"bf5235fee8bb","name":"Tushar Gupta","username":"tg6897","newsletterV3":{"__ref":"NewsletterV3:832ec67a9974"},"linkedAccounts":{"__ref":"LinkedAccounts:bf5235fee8bb"},"isSuspended":false,"imageId":"0*oTCZ2-qduIllbJVV","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":28},"customDomainState":null,"hasSubdomain":false,"bio":"","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:bf5235fee8bb-viewerId:lo_637abe8e8c62"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"allowNotes":true,"membership":null,"twitterScreenName":""},"Paragraph:7fe442d2f130_0":{"__typename":"Paragraph","id":"7fe442d2f130_0","name":"69ea","type":"H3","href":null,"layout":null,"metadata":null,"text":"Design In-memory Streams","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_1":{"__typename":"Paragraph","id":"7fe442d2f130_1","name":"8e0d","type":"P","href":null,"layout":null,"metadata":null,"text":"Data streaming has become the backbone of scalable systems as it helps process large volumes of real-time data which is further used in analytics or event-driven systems.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_2":{"__typename":"Paragraph","id":"7fe442d2f130_2","name":"d80c","type":"P","href":null,"layout":null,"metadata":null,"text":"Today we will work on designing an in-memory data streaming service taking the motivation from Kafka. I believe not only this will be helpful for interviews, but it will also help us improve as developers.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":95,"end":100,"href":"https:\u002F\u002Fkafka.apache.org\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_3":{"__typename":"Paragraph","id":"7fe442d2f130_3","name":"ecca","type":"P","href":null,"layout":null,"metadata":null,"text":"Further, in this article, we will integrate remote storage into this design so that we can run consumers in different processes or machines.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":17,"end":24,"href":"https:\u002F\u002Fmedium.com\u002F@tg6897\u002Fdesign-in-memory-streams-part-2-76744f7afa11","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_4":{"__typename":"Paragraph","id":"7fe442d2f130_4","name":"e1e9","type":"H4","href":null,"layout":null,"metadata":null,"text":"Kafka Brief and terminologies:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*raU1J6kQZuUGdGVoaMEKYA.png":{"__typename":"ImageMetadata","id":"1*raU1J6kQZuUGdGVoaMEKYA.png","originalHeight":1044,"originalWidth":2529,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7fe442d2f130_5":{"__typename":"Paragraph","id":"7fe442d2f130_5","name":"6761","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*raU1J6kQZuUGdGVoaMEKYA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_6":{"__typename":"Paragraph","id":"7fe442d2f130_6","name":"43cf","type":"P","href":null,"layout":null,"metadata":null,"text":"Although our design will not be completely based on Kafka, it shares some similarities. So starting with the basic terminologies:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_7":{"__typename":"Paragraph","id":"7fe442d2f130_7","name":"0e0d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Topics: Kafka groups similar types of data together in topics. Producers publish data to topics, and consumers consume data from topics. For example, to capture and analyze user behavior on a website, you can create a topic named “user_behavior” and publish data to it. Other analytics services can consume data from this topic for further processing.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":21,"end":42,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_8":{"__typename":"Paragraph","id":"7fe442d2f130_8","name":"24d2","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Partitions: The topic stores data in partitions. Partitions are a way to horizontally split data within a topic. Each partition represents an ordered, immutable sequence of records. Data within a partition is processed in order, so partitions are the basic units of parallelism in Kafka. Increasing the number of partitions can increase parallel data consumption from a topic, provided that the data is equally distributed among them.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":142,"end":181,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":182,"end":227,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_9":{"__typename":"Paragraph","id":"7fe442d2f130_9","name":"ec8f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Brokers: Brokers are responsible for storing and replicating the topic partitions, handling consumer requests for fetching messages, and serving producer requests for writing messages. Brokers act as intermediaries between producers and consumers, with producers publishing data to topics via brokers and consumers consuming data from topics via brokers.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":37,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":83,"end":184,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_10":{"__typename":"Paragraph","id":"7fe442d2f130_10","name":"a42d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Producers: Producers are clients responsible for pushing data to topics.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_11":{"__typename":"Paragraph","id":"7fe442d2f130_11","name":"2918","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Consumers: Consumers retrieve data from topics and process it. Each consumer can be assigned to multiple topic partitions, but a single topic partition cannot be assigned to multiple consumers to maintain data ordering guarantees within a partition.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":84,"end":121,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_12":{"__typename":"Paragraph","id":"7fe442d2f130_12","name":"6602","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Consumer Groups: A consumer group is a collection of consumers working together to consume data from topics in parallel. For example, suppose a consumer group has five consumers and is attached to a topic “X” that has five partitions. In that case, each consumer can be assigned one topic partition so that all consumers can process data in parallel.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":83,"end":119,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_13":{"__typename":"Paragraph","id":"7fe442d2f130_13","name":"7733","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Offsets: In Kafka, offsets are used to get the required data from a given topic partition, since we always need the next unprocessed data. Offsets are maintained per group for all topic partition IDs, and consumers use them to get the next set of unprocessed data. Once data is processed, the updated offset is committed. For example, if a consumer group “CG” has four consumers attached to the topic “X” with four partitions, and one consumer dies, its partition will be assigned to one of the remaining alive consumers. The consumer will then use the offset to retrieve the next set of unprocessed data for that partition, as the previous consumer might have processed some data, and we don’t want to process it again.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":151,"end":214,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":215,"end":263,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_14":{"__typename":"Paragraph","id":"7fe442d2f130_14","name":"3613","type":"P","href":null,"layout":null,"metadata":null,"text":"Although this basic understanding of Kafka components is enough, to follow through the rest of the article, if you want any further understanding refer to official documentation.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":155,"end":177,"href":"https:\u002F\u002Fkafka.apache.org\u002Fintro#intro_concepts_and_terms","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_15":{"__typename":"Paragraph","id":"7fe442d2f130_15","name":"bc67","type":"H4","href":null,"layout":null,"metadata":null,"text":"Problem Statement:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_16":{"__typename":"Paragraph","id":"7fe442d2f130_16","name":"3f7a","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The user can create multiple topics and should be able to provide the number of partitions and data partitioning strategies as well.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_17":{"__typename":"Paragraph","id":"7fe442d2f130_17","name":"5a51","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The user can choose from any underline storage implementation for each topic and can define custom serialization\u002Fdeserialization for the data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_18":{"__typename":"Paragraph","id":"7fe442d2f130_18","name":"d015","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The user can publish data to topics, and the defined partitioning strategy will be used to distribute data among partitions.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_19":{"__typename":"Paragraph","id":"7fe442d2f130_19","name":"668a","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The user can create multiple consumer groups and should be able to provide name and partition assignment strategies on the same","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_20":{"__typename":"Paragraph","id":"7fe442d2f130_20","name":"3d72","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The user can create multiple consumers and should be able to provide the consumer group they need to be attached to.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_21":{"__typename":"Paragraph","id":"7fe442d2f130_21","name":"1ff5","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Consumer groups can be attached to topics to consume data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_22":{"__typename":"Paragraph","id":"7fe442d2f130_22","name":"8752","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Multiple consumers should be able to consume data from topics parallelly.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_23":{"__typename":"Paragraph","id":"7fe442d2f130_23","name":"97e5","type":"OLI","href":null,"layout":null,"metadata":null,"text":"If multiple partitions are assigned to a consumer, it should be able to process data parallelly from all of them.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_24":{"__typename":"Paragraph","id":"7fe442d2f130_24","name":"715b","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Once a consumer is added or removed from the group, partitions need to be rebalanced accordingly.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_25":{"__typename":"Paragraph","id":"7fe442d2f130_25","name":"4255","type":"OLI","href":null,"layout":null,"metadata":null,"text":"If a consumer dies, Partitions need to be rebalanced accordingly among available consumer basis the defined partition assignment strategy","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_26":{"__typename":"Paragraph","id":"7fe442d2f130_26","name":"553c","type":"OLI","href":null,"layout":null,"metadata":null,"text":"If partitions of any topics are changed, the group should be able to rebalance and accommodate the new partitions.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_27":{"__typename":"Paragraph","id":"7fe442d2f130_27","name":"74b9","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The group needs to maintain offsets of topic partitions consumption, and if any partitions are rebalanced, It needs to be ensured that any data is not consumed again.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_28":{"__typename":"Paragraph","id":"7fe442d2f130_28","name":"6f2c","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Any partition cannot be assigned to two consumers at one time.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_29":{"__typename":"Paragraph","id":"7fe442d2f130_29","name":"1b5d","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Retry capabilities need to be added if data processing fails and the order of data consumption needs to be maintained in any given partition.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*PzzRWFnSlSto2itU.gif":{"__typename":"ImageMetadata","id":"0*PzzRWFnSlSto2itU.gif","originalHeight":214,"originalWidth":220,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7fe442d2f130_30":{"__typename":"Paragraph","id":"7fe442d2f130_30","name":"9144","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*PzzRWFnSlSto2itU.gif"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_31":{"__typename":"Paragraph","id":"7fe442d2f130_31","name":"1c6e","type":"P","href":null,"layout":null,"metadata":null,"text":"From an interview perspective, the requirements might seem too much and it is, but they will fit together nicely, so just stay with me.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_32":{"__typename":"Paragraph","id":"7fe442d2f130_32","name":"034f","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s start by decoupling the requirements and define them using individual components, with each component being responsible for a few features:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_33":{"__typename":"Paragraph","id":"7fe442d2f130_33","name":"5551","type":"ULI","href":null,"layout":null,"metadata":null,"text":"SerialStorage: This class provides wrappers over different storage data structures, such as arrays or linked lists, that the Topic can utilize. It exposes APIs for pushing and polling data from these structures.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":35,"end":114,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_34":{"__typename":"Paragraph","id":"7fe442d2f130_34","name":"1b72","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Topic: The Topic is responsible for maintaining Partitions (instances of SerialStorage) and using the defined partitioning strategy to push data into the relevant Partitions. It is also responsible for returning ranged data from any Partition.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":36,"end":173,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_35":{"__typename":"Paragraph","id":"7fe442d2f130_35","name":"0dd7","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Topic Partition ID: This references the partition of a topic. For example, T1\u003C\u003EP1 references the first partition of the topic T1.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_36":{"__typename":"Paragraph","id":"7fe442d2f130_36","name":"b440","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Broker: The Broker stores topics\u002Fpartitions and acts as a client for consumers to poll data and producers to push data.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":26,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":58,"end":119,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_37":{"__typename":"Paragraph","id":"7fe442d2f130_37","name":"1088","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Group Coordinator: Each Consumer Group has one Group Coordinator, which manages the group membership and partition assignments for all Consumers in the group. It is responsible for maintaining Consumer nodes and assigned\u002Funassigned partitions of all topics it is attached to. The Group Coordinator exposes APIs for adding\u002Fremoving Consumer nodes from the group and balances partitions between all connected Consumer nodes. The Group Coordinator also monitors the health of the Consumers and triggers rebalancing if any Consumer becomes unavailable or unresponsive. It communicates with Consumers via the GroupCoordinatorClient. There will always be only one Group Coordinator for a Consumer Group.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":72,"end":158,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":276,"end":421,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":628,"end":697,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_38":{"__typename":"Paragraph","id":"7fe442d2f130_38","name":"800a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"GroupCoordinatorClient: This class acts as an intermediary between Consumer nodes and the Group Coordinator. All communications between them are done via this class.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":46,"end":108,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_39":{"__typename":"Paragraph","id":"7fe442d2f130_39","name":"02eb","type":"ULI","href":null,"layout":null,"metadata":null,"text":"ConsumerMember: The Consumer is responsible for pulling data from the Broker for a given topic\u003C\u003Epartition and processing it. It uses the OffsetClient to get the offset for which data needs to be processed and commit the updated offset after processing it.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":48,"end":123,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_40":{"__typename":"Paragraph","id":"7fe442d2f130_40","name":"f41e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"OffsetClient: This class is responsible for maintaining offsets of a given Consumer Group for all Topic Partition IDs.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":44,"end":118,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_41":{"__typename":"Paragraph","id":"7fe442d2f130_41","name":"cf66","type":"H4","href":null,"layout":null,"metadata":null,"text":"Class Diagram","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_42":{"__typename":"Paragraph","id":"7fe442d2f130_42","name":"d9f0","type":"P","href":null,"layout":null,"metadata":null,"text":"Here is the class diagram, which gives an overview of our design. Refer to the implementation and code comments below to understand certain fields and classes.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*CkCNI9SsiPRmpCG45hZCzQ.png":{"__typename":"ImageMetadata","id":"1*CkCNI9SsiPRmpCG45hZCzQ.png","originalHeight":1090,"originalWidth":1861,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7fe442d2f130_43":{"__typename":"Paragraph","id":"7fe442d2f130_43","name":"fe7a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*CkCNI9SsiPRmpCG45hZCzQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_44":{"__typename":"Paragraph","id":"7fe442d2f130_44","name":"272a","type":"H3","href":null,"layout":null,"metadata":null,"text":"Implementation:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_45":{"__typename":"Paragraph","id":"7fe442d2f130_45","name":"426e","type":"P","href":null,"layout":null,"metadata":null,"text":"Diving the implementation into different components. (Please Read code comments for better understanding)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_46":{"__typename":"Paragraph","id":"7fe442d2f130_46","name":"1029","type":"H4","href":null,"layout":null,"metadata":null,"text":"Storage Classes","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_47":{"__typename":"Paragraph","id":"7fe442d2f130_47","name":"ea20","type":"P","href":null,"layout":null,"metadata":null,"text":"Storage classes will be wrappers over data structures, which will help maintain data in serial order.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_48":{"__typename":"Paragraph","id":"7fe442d2f130_48","name":"95e6","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see from the requirements, we will always append data to a topic partition and not delete\u002Fupdate any data. Also, we need to keep in mind, that there will be ranged queries for a provided limit and offset.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_49":{"__typename":"Paragraph","id":"7fe442d2f130_49","name":"046b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Data Class: Used to serialize and deserialize data to be pushed in storage classes. We can define our own Data classes by extending Base Data","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_50":{"__typename":"Paragraph","id":"7fe442d2f130_50","name":"a4ef","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Serial Storage: Used to store serialized data objects, and provide APIs to add\u002Fquery the same. We can define our own storage classes by extending SerialStorage like ArrayStorage or Linked List storage classes.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":165,"end":177,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":181,"end":200,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":165,"end":177,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":181,"end":200,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_51":{"__typename":"Paragraph","id":"7fe442d2f130_51","name":"3aa1","type":"PRE","href":null,"layout":null,"metadata":null,"text":"import json\nimport threading\n\n\nclass BaseData:\n    \"\"\"\n    Base class of data objects. Defines serialize\u002Fdeserialize methods for data\n    \"\"\"\n\n    def __init__(self, ttl=None):\n        self.ttl = ttl\n\n    @classmethod\n    def serialize(cls, data, encoding_scheme='utf-8'):\n        raise Exception(\"No serialize method defined\")\n\n    @classmethod\n    def deserialize(cls, data: bytes):\n        raise Exception(\"No deserialize method defined\")\n\n\nclass Data(BaseData):\n\n    def __init__(self, msg, ttl):\n        super(Data, self).__init__(ttl)\n        self.msg = msg\n\n    @classmethod\n    def serialize(cls, data, encoding_scheme='utf-8') -\u003E bytes:\n        \"\"\"\n        Serialize data into bytes\n        :param data:\n        :param encoding_scheme: encoding scheme of data\n        :return:\n        \"\"\"\n        return json.dumps({\"msg\": data.msg, \"ttl\": data.ttl}).encode(encoding_scheme)\n\n    @classmethod\n    def deserialize(cls, data, encoding_scheme='utf-8'):\n        \"\"\"\n        deserialize data and return the data object from bytes\u002Fstring\n        :param data:\n        :param encoding_scheme:\n        :return:\n        \"\"\"\n        if isinstance(data, bytes):\n            data = data.decode(encoding_scheme)\n        data = json.loads(data)\n        return cls(msg=data['msg'], ttl=data['ttl'])\n\n\nclass SerialStorage:\n    \"\"\"\n    Interface for serial storage\n    \"\"\"\n\n    def __init__(self, data_class=Data):\n        self.data_class = data_class\n\n    def add_data(self, data, ttl=None):\n        pass\n\n    def get_range_data(self, limit, offset):\n        pass\n\n\nclass LLNode:\n\n    def __init__(self, data):\n        self.data = data\n        self.next = None\n\n\nclass ArrayStorage(SerialStorage):\n\n    def __init__(self, data_class=Data):\n        super(ArrayStorage, self).__init__(data_class)\n        self.data = []\n        self.lock = threading.Lock() # to make serial storage th\n\n    def add_data(self, data, ttl=None):\n        with self.lock:\n            self.data.append(self.data_class.serialize(data))\n\n    def get_range_data(self, limit, offset):\n        return [self.data_class.deserialize(_data) for _data in self.data[limit:limit + offset]]\n\n\nclass LLStorage(SerialStorage):\n\n    def __init__(self, data_class=Data):\n        super(LLStorage, self).__init__(data_class)\n        self.manage_data = {}  # additional map to maintain nodes on any given offset , so that range query can be fast\n        self.head = None\n        self.tail = None\n        self.data_len = 0  # maintains current length of LL\n        self.lock = threading.Lock() # to make serial storage thread safe\n\n    def add_data(self, data, ttl=None):\n        with self.lock:\n            curr_node = LLNode(self.data_class.serialize(data))\n            if not self.head:\n                self.head = self.tail = curr_node\n            else:\n                self.tail.next = curr_node\n                self.tail = curr_node\n            self.manage_data[self.data_len] = curr_node  # add to map as well for fast access of nodes\n            self.data_len += 1\n\n    def get_range_data(self, limit, offset):\n        \"\"\"\n        returns data between provided limits\n        :param limit:\n        :param offset:\n        :return:\n        \"\"\"\n        data = []\n        curr = self.manage_data.get(limit)  # uses map to go to node faster instead of traversing\n        if not curr:\n            return data\n        for i in range(limit, limit + offset):\n            if not curr:\n                # if no further data available , stop\n                break\n            data.append(self.data_class.deserialize(curr.data))\n            curr = curr.next\n        return data","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"ruby"},"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_52":{"__typename":"Paragraph","id":"7fe442d2f130_52","name":"236b","type":"H4","href":null,"layout":null,"metadata":null,"text":"Topics and Data Partition Strategies:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_53":{"__typename":"Paragraph","id":"7fe442d2f130_53","name":"6b06","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Topic: Topics will be defined using the name, number of partitions, data partition strategy, and storage class. The topic will insert data into the relevant partition, and we can query the same using partition_id, limit, and offset.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":122,"end":232,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_54":{"__typename":"Paragraph","id":"7fe442d2f130_54","name":"0258","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Data Partition Strategy: It exposes a function to provide the next partition in which the topic should insert data. We can make any custom partition strategy by extending TopicDataPartitionStrategy, like the Round Robin partition strategy.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_55":{"__typename":"Paragraph","id":"7fe442d2f130_55","name":"ae5d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"class TopicDataPartitionStrategy:\n\n    def __init__(self, **kwargs):\n        pass\n\n    def get_next_partition(self, no_of_partitions):\n        pass\n\n    @classmethod\n    def get_partition_strategy_class(cls, class_name):\n        if class_name == 'RRPartitionStrategy':\n            return RRPartitionStrategy\n\n    def serialize(self):\n        raise Exception(\"No Default implementation\")\n\n    @classmethod\n    def deserialize(cls, obj_str):\n        raise Exception(\"No Default implementation\")\n\n\nclass RRPartitionStrategy(TopicDataPartitionStrategy):\n    \"\"\"\n    Round robin partition strategy: Uses each partition equally\n    \"\"\"\n\n    def __init__(self, **kwargs):\n        self.last_used = -1\n        super(RRPartitionStrategy, self).__init__()\n        self.last_used = int(kwargs.get('last_used', -1))\n\n    def get_next_partition(self, no_of_partitions):\n        to_use = (self.last_used + 1) % no_of_partitions\n        self.last_used = to_use\n        return to_use\n\n    def serialize(self):\n        return json.dumps({\"last_used\": self.last_used})\n\n    @classmethod\n    def deserialize(cls, obj_str):\n        return RRPartitionStrategy(**json.loads(obj_str))\n\nclass Topic:\n\n    def __init__(self, topic_name, partitions, strategy, storage_type=LLStorage, storage_metadata=None):\n        \"\"\"\n        Stores data in partitions\n        :param topic_name: Name of the topic\n        :param partitions: No of partitions to use\n        :param strategy: Partitioning strategy to use\n        :param storage_type: Serial Storage Class to use\n        \"\"\"\n        self.topic_name = topic_name\n        self.partitions = [storage_type() for _ in range(partitions)]\n        self.partition_strategy = strategy\n        self.storage_type = storage_type\n\n    def push_data(self, data, ttl=None):\n        \"\"\"\n        Get next partition from partition strategy and push the data\n        :param data:\n        :param ttl:\n        :return:\n        \"\"\"\n        next_partition = self.partition_strategy.get_next_partition(len(self.partitions))\n        print(\"pushing in partition\", next_partition)\n        self.partitions[next_partition].add_data(data, ttl)\n        return\n\n    def poll_data(self, partition, limit, offset):\n        return self.partitions[partition].get_range_data(limit, offset)\n\n    def add_partition(self):\n        self.partitions.append(self.storage_type())","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_56":{"__typename":"Paragraph","id":"7fe442d2f130_56","name":"f871","type":"H4","href":null,"layout":null,"metadata":null,"text":"Broker Class","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_57":{"__typename":"Paragraph","id":"7fe442d2f130_57","name":"6631","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Broker: It is responsible for managing topics and exposing APIs to create and manipulate them. It also handles push\u002Fpoll data from topics. Additionally, brokers maintain a list of consumer groups attached to each topic. When there are changes made to a topic, such as the number of partitions changing, the broker will notify all attached consumer groups so they can rebalance their consumers accordingly.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":30,"end":94,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_58":{"__typename":"Paragraph","id":"7fe442d2f130_58","name":"ceeb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"class Broker:\n    from collections import defaultdict\n    topics = {}\n    topics_subscription = defaultdict(set)\n\n    @classmethod\n    def create_topic(cls, topic_name, partitions, strategy: TopicDataPartitionStrategy, storage_type=LLStorage):\n        \"\"\"\n        Create new topic\n        :param storage_type: storage class to use\n        :param topic_name: Topic name\n        :param partitions: Number of partitions\n        :param strategy: Data Partition Strategy\n        :return:\n        \"\"\"\n        if cls.topics.get(topic_name):\n            raise Exception(\"topic already exists\")\n        cls.topics[topic_name] = Topic(topic_name, partitions, strategy, storage_type=storage_type)\n\n    @classmethod\n    def add_data_to_topic(cls, topic_name, data):\n        cls.topics[topic_name].push_data(data)\n\n    @classmethod\n    def poll_data(cls, topic_name, partition, offset, limit):\n        return cls.topics[topic_name].poll_data(partition, offset, limit)\n\n    @classmethod\n    def attach_to_topic(cls, topic_name, consumer_group, **kwargs):\n        # whenever consumer group want to attach to topic, we will store subscription\n        cls.topics_subscription[topic_name].add(consumer_group)\n        return cls.get_no_of_topic_partitions(topic_name)\n\n    @classmethod\n    def get_no_of_topic_partitions(cls, topic_name):\n        return len(cls.topics[topic_name].partitions)\n\n    @classmethod\n    def add_partition(cls, topic_name):\n        cls.topics[topic_name].add_partition()\n        cls.notify_subscribers(topic_name)\n\n    @classmethod\n    def add_subscription(cls, topic_name, consumer_group):\n        cls.topics_subscription[topic_name].add(consumer_group)\n\n    @classmethod\n    def remove_subscription(cls, topic_name, consumer_group):\n        cls.topics_subscription[topic_name].remove(consumer_group)\n\n    @classmethod\n    def notify_subscribers(cls, topic_name):\n        from consumer.in_memory_group_coordinator_helper import GroupCoordinatorClient\n        for consumer_group in cls.topics_subscription[topic_name]:\n            GroupCoordinatorClient.topic_partitions_changed(consumer_group, topic_name)\n","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_59":{"__typename":"Paragraph","id":"7fe442d2f130_59","name":"ce35","type":"H4","href":null,"layout":null,"metadata":null,"text":"Offset client","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_60":{"__typename":"Paragraph","id":"7fe442d2f130_60","name":"8dcb","type":"ULI","href":null,"layout":null,"metadata":null,"text":"PartitionTopic: This class defines an individual partition of the topic. we will assign one or more instances of this to consumers so that they can consume data from the same.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_61":{"__typename":"Paragraph","id":"7fe442d2f130_61","name":"d28a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Offset client: It maintains the offset of the individual consumer groups on all topics\u003C\u003Epartions it is consuming from.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_62":{"__typename":"Paragraph","id":"7fe442d2f130_62","name":"6934","type":"PRE","href":null,"layout":null,"metadata":null,"text":"class PartitionStatus(enum.Enum):\n    UNASSIGNED = 'unassigned'\n    ASSIGNED = 'assigned'\n\n\nclass PartitionTopic:\n\n    def __init__(self, topic_name, partition):\n        self.topic_name = topic_name\n        self.partition = partition\n\n    def __str__(self):\n        return f'{self.topic_name}::{self.partition}'\n\n    def __hash__(self):\n        return hash(self.__str__())\n\n    def __eq__(self, other):\n        if isinstance(other, self.__class__):\n            return self.__str__() == other.__str__()\n        return False\n\nclass OffsetClient:\n    offsets = defaultdict(dict)\n\n    @classmethod\n    def get_offset_key(cls, consumer_group, topic_name, partition):\n        return f'{consumer_group}_{topic_name}_{partition}'\n\n    @classmethod\n    def commit_offset(cls, consumer_group, topic, partition, offset):\n        cls.offsets[cls.get_offset_key(consumer_group, topic, partition)] = offset\n\n    @classmethod\n    def get_offset(cls, consumer_group, topic, partition):\n        return cls.offsets.get(cls.get_offset_key(consumer_group, topic, partition), 0)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_63":{"__typename":"Paragraph","id":"7fe442d2f130_63","name":"da28","type":"H4","href":null,"layout":null,"metadata":null,"text":"Partition Assignment Strategy","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_64":{"__typename":"Paragraph","id":"7fe442d2f130_64","name":"5223","type":"P","href":null,"layout":null,"metadata":null,"text":"PartitionAssignment Strategy: This class is responsible for distributing partitions among consumers based on the total partitions the consumer group is consuming from and the number of consumers present in it.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_65":{"__typename":"Paragraph","id":"7fe442d2f130_65","name":"904a","type":"P","href":null,"layout":null,"metadata":null,"text":"It calculates how many partitions should be assigned to each consumer. We can define custom partition assignment strategies by extending the PartitionAssignmentStrategy class.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":14,"end":70,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_66":{"__typename":"Paragraph","id":"7fe442d2f130_66","name":"5556","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from collections import defaultdict\n\n\nclass PartitionAssignmentStrategy:\n    \"\"\"\n    Provides a consumer_member_id\u003C\u003Enumber_of_topic_partition_ids mapping.\n    It basically tells us how many partitions to be assigned to each consumer\n    \"\"\"\n\n    def __init__(self, consumer_member_ids):\n        \"\"\"\n        :param consumer_member_ids: we will sort consumer member ids as we don't want shuffling to change in case of\n        ties between no of partitions\n        \"\"\"\n        self.consumer_member_ids = sorted(consumer_member_ids)\n\n    def get_partitions_assignment(self, no_of_partitions):\n        raise Exception(\"No Default Implementation\")\n\n\nclass EqualAssignmentStrategy(PartitionAssignmentStrategy):\n    \"\"\"\n    this will split the partitions equally among all consumer members\n    for eg. consumers : 5 and partitions : 5 , it will say assign each consumer one partition\n            consumers: 5 and partitions : 7 , it will say assign two partitions to two consumers , and all the rest one\n            consumer: 6 and partitions : 5 , it will say assign 5 consumers one partition and one will be unassigned\n    \"\"\"\n\n    def __init__(self, consumer_member_ids):\n        super(EqualAssignmentStrategy, self).__init__(consumer_member_ids)\n\n    def get_partitions(self, no_of_partitions):\n        print(\"Len partition, len consumer_members\", no_of_partitions, len(self.consumer_member_ids))\n        if not len(self.consumer_member_ids):\n            return {}\n        _equal = no_of_partitions \u002F\u002F len(self.consumer_member_ids)\n        _rem = no_of_partitions % len(self.consumer_member_ids)\n        sol = defaultdict(int)\n        for ix, k in enumerate(self.consumer_member_ids):\n            sol[k] += _equal + (1 if ix \u003C _rem else 0)\n        return sol","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_67":{"__typename":"Paragraph","id":"7fe442d2f130_67","name":"a1fe","type":"H4","href":null,"layout":null,"metadata":null,"text":"Defining GroupCoordinator","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_68":{"__typename":"Paragraph","id":"7fe442d2f130_68","name":"632b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Group Coordinator: Each consumer group has one group coordinator who manages the group membership and partition assignments for all consumers in the group. It exposes APIs for consumers to join\u002Fleave the group and handles the rebalancing of partitions when the group membership changes. The group coordinator also monitors the health of the consumers and triggers rebalancing if any consumer becomes unavailable or unresponsive.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":81,"end":156,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":354,"end":376,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_69":{"__typename":"Paragraph","id":"7fe442d2f130_69","name":"f4db","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Rebalancing: Rebalancing is assigning overall group topic_partition_ids between available consumers. \nAn example use case to understand it better:\n- Let’s say our consumer group is attached to 2 topics(T1, T2) each having 2 partitions(P1, P2). So overall topic_partitions in our group will be 4(T1\u003C\u003EP1,T1\u003C\u003EP2,T2\u003C\u003EP1,T2\u003C\u003EP2). Let’s say the consumer group has 2 consumers (C1, C2). One way to rebalance would be that C1 can be assigned (T1\u003C\u003EP1 and T2\u003C\u003EP1) and C2 can be assigned (T1\u003C\u003EP2 and T2\u003C\u003EP2). Similarly in this way, we can have a total number of 4C2 types of partition assignments.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":28,"end":99,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_70":{"__typename":"Paragraph","id":"7fe442d2f130_70","name":"a936","type":"P","href":null,"layout":null,"metadata":null,"text":"Rebalancing Edge Cases: There are a few things that we must keep in mind while rebalancing:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_71":{"__typename":"Paragraph","id":"7fe442d2f130_71","name":"1a9b","type":"OLI","href":null,"layout":null,"metadata":null,"text":"When a new consumer member joins a Kafka consumer group, the current partitions are rebalanced in order to assign the new consumer some partitions. For example, let’s say a consumer group has two consumer members (C1 and C2) and is attached to only one topic T1 with three partitions. Currently, one partition is assigned to C1, and two partitions are assigned to C2.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":84,"end":147,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_72":{"__typename":"Paragraph","id":"7fe442d2f130_72","name":"8f5c","type":"OLI","href":null,"layout":null,"metadata":null,"text":"If a new consumer “C3” joins the group, the coordinator will rebalance the partitions according to the assigned policy. If the policy is the equal assignment policy, the coordinator will remove one partition from C2 and assign it to C3.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":9,"end":119,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_73":{"__typename":"Paragraph","id":"7fe442d2f130_73","name":"5947","type":"OLI","href":null,"layout":null,"metadata":null,"text":"However, simply removing a partition from a consumer may cause problems if the consumer is still processing data from that partition and has not committed the offset yet. In such cases, if a partition is removed from C2 and assigned to C3, it may be possible that C2 is still in the middle of a polling cycle and has not committed the offset. As a result, C3 may start processing data from a stale offset, causing data to be processed multiple times.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":9,"end":170,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":171,"end":341,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_74":{"__typename":"Paragraph","id":"7fe442d2f130_74","name":"228c","type":"OLI","href":null,"layout":null,"metadata":null,"text":"To handle this, the coordinator will first issue a request to C2 to revoke some partitions. Once C2 revokes the partitions, it will notify the coordinator so that the revoked partitions are marked unassigned, and on further rebalance can be assigned to C3 ( we are monitoring for unassigned partitions regularly to rebalance). This ensures that each partition is assigned to only one group at any given time, preventing duplicate processing of data.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":37,"end":91,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":167,"end":208,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_75":{"__typename":"Paragraph","id":"7fe442d2f130_75","name":"29f6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"class GroupCoordinator:\n    \"\"\"\n    Manages consumers assigned to the group\n    constantly monitors the consumers and reassign if anything is killed\n    Rebalance partitions between consumers attached to group\n    \"\"\"\n\n    def __init__(self, name, partition_assignment_strategy='EqualAssignmentStrategy', is_leader=False):\n        \"\"\"\n        :param name: Consumer group name\n        :param partition_assignment_strategy: Partition assignment strategy\n        :param is_leader : Specify if the group coordinator is leader or not, only leader can rebalance partitions to\n        avoid race conditions.\n        \"\"\"\n        self.name = name\n        self.rebalance_lock = Lock()  # this lock will help prevent race conditions during partition rebalances\n        self.partition_assignment_strategy = PartitionAssignmentStrategy.get_partition_strategy(\n            partition_assignment_strategy)\n        self.broker_client = Broker\n        self.is_leader = is_leader\n        self.offsetClient = OffsetClient\n        self.partitions = {}  # overall topic_partitions assigned to the group\n        self.heart_beat = {}  # heart beat tracker of all consumers\n        self.consumer_nodes = set()  # consumer ids of consumer nodes assigned to the group\n        self.consumer_nodes_mapping = defaultdict(set)  # partition mappings assigned to consumer nodes\n\n        GroupCoordinatorClient.register_group_coordinator(name, self)\n\n        if not self.is_leader:\n            return\n\n        # start check on unassigned partitions\n        t1 = threading.Thread(target=self.check_unassigned_partitions, daemon=True)\n        t1.name = \"unassigned_partition\"\n        t1.start()\n\n        # start check on consumer group health\n        t2 = threading.Thread(target=self.check_consumer_health, daemon=True)\n        t2.name = \"consumer_healths\"\n        t2.start()\n\n    def notify_consumer_members_changed(self, *args, **kwargs):\n        \"\"\"\n        call this method if consumer members are changed.\n        :param args:\n        :param kwargs:\n        :return:\n        \"\"\"\n        self.rebalance_partitions()\n\n    def register_consumer_member(self, consumer_id):\n        \"\"\"\n        register consumer member to the group\n        :param consumer_id:\n        :return:\n        \"\"\"\n        print(f\"registering_consumer_member {consumer_id}\")\n        self.consumer_nodes.add(consumer_id)\n        self.notify_consumer_members_changed()\n\n    def mark_partitions_unassigned(self, consumer_id, topic_partition_ids):\n        \"\"\"\n        Remove partitions from consumer and mark it unassigned\n        :param topic_partition_ids: partitions to remove\n        :param consumer_id:: consumer id to remove partitions from\n        :return:\n        \"\"\"\n        print(f\"removing_partition_from {consumer_id} {topic_partition_ids}\")\n        with self.rebalance_lock:\n            for topic_partition_id in topic_partition_ids:\n                self.consumer_nodes_mapping[consumer_id].remove(topic_partition_id)\n                self.partitions[topic_partition_id] = PartitionStatus.UNASSIGNED.value\n\n    def get_assigned_partitions(self, consumer_id):\n        \"\"\"\n        get assigned partitions for a consumer member\n        :param consumer_id:\n        :return:\n        \"\"\"\n        return self.consumer_nodes_mapping[consumer_id]\n\n    def print_curr_assignment(self):\n        for cnsr_id in self.consumer_nodes:\n            for p in self.consumer_nodes_mapping[cnsr_id]:\n                print(f'{p} in {cnsr_id}')\n\n    def add_partition_mapping(self, consumer_member_id, topic_partition):\n        \"\"\"\n        Add partition mapping to consumer and mark it assigned.\n        Here we can directly add the partition, without notifying the consumer , since consumer is getting updated\n        partitions in every poll request, so this new partition will be returned in next get_partitions_assigned request.\n        :param consumer_member_id:\n        :param topic_partition:\n        :return:\n        \"\"\"\n        self.partitions[topic_partition] = PartitionStatus.ASSIGNED.value\n        self.consumer_nodes_mapping[consumer_member_id].add(topic_partition)\n\n    def notify_partitions_changed(self, topic_name):\n        \"\"\"\n        Listener in case partitions in topic is changed, to assign new partitions to the nodes\n        \"\"\"\n        for partition_id in range(self.broker_client.get_no_of_topic_partitions(topic_name)):\n            curr = PartitionTopic(topic_name, partition_id)\n            if curr not in self.partitions:\n                self.partitions[curr] = PartitionStatus.UNASSIGNED.value\n        self.rebalance_partitions()\n\n    def get_unassigned_partitions(self):\n        \"\"\"\n        Get unassigned partitions in the group\n        :return:\n        \"\"\"\n\n        return set([topic_partition_id for topic_partition_id, status in self.partitions.items() if\n                    status == PartitionStatus.UNASSIGNED.value])\n\n    def check_unassigned_partitions(self):\n        \"\"\"\n        Check unassigned partitions and trigger a re-balance if found any.\n        Note: consumer nodes may not have any partition , if no of consumers \u003E no of partitions\n        :return:\n        \"\"\"\n        while True:\n            with self.rebalance_lock:\n                unassigned = self.get_unassigned_partitions()\n            if unassigned:\n                print(f\"Found unassigned partitions, {unassigned}\")\n                self.rebalance_partitions()\n            time.sleep(5)\n\n    def get_consumer_nodes_in_group(self):\n        return self.consumer_nodes\n\n    def partitions_len_in_group(self):\n        return len(self.partitions)\n\n    def notify_remove_partition(self, consumer_id, partition_ids):\n        \"\"\"\n        Notify consumer member to remove partition.\n        Note: We cannot just blindly remove a partition from consumer, since it might be that consumer is still processing\n        data from that partition and has not committed offset yet. So in this case if we remove the partition and assign\n        to another one, same data can be processed multiple times.\n        :param consumer_id:\n        :param partition_ids:\n        :return:\n        \"\"\"\n        GroupCoordinatorClient.notify_remove_partition(consumer_id,\n                                                       partition_ids)\n\n    def rebalance_partitions(self):\n        \"\"\"\n        Re-balances the partitions between all assigned consumers\n        \"\"\"\n        if not self.is_leader:\n            print(\"not a leader\")\n            return\n        if not self.partitions_len_in_group():\n            return\n        print(\"REBALANCING\")\n        self.rebalance_lock.acquire()\n        members = self.get_consumer_nodes_in_group()\n        if not members:\n            print(\"no consumer member attached to group\")\n            self.rebalance_lock.release()\n            return\n\n        partitions_assignment = self.partition_assignment_strategy(members).get_partitions(\n            self.partitions_len_in_group())\n        print(f'Partitions assignments should be {partitions_assignment}')\n\n        for consumer_id, no_of_partitions in partitions_assignment.items():\n            curr_assigned_partitions_to_node = self.get_assigned_partitions(consumer_id)\n            _len_curr_assigned_partitions_to_node = len(curr_assigned_partitions_to_node)\n            print(f\"curr_assigned_partition_to_{consumer_id}_are_{curr_assigned_partitions_to_node}\")\n\n            # If consumer has less than required partitions, assign any unassigned partition to the consumer\n            while _len_curr_assigned_partitions_to_node \u003C no_of_partitions:\n                unassigned_partitions = self.get_unassigned_partitions()\n                if not unassigned_partitions:\n                    print(\"No unassigned partitions left\")\n                    break\n                print(f\"unassigned_partitions_are_{unassigned_partitions}\")\n                curr_unassigned_partition = unassigned_partitions.pop()\n                self.add_partition_mapping(consumer_id, curr_unassigned_partition)\n                _len_curr_assigned_partitions_to_node += 1\n\n            # If consumer has more than required partitions, remove the extra partitions so they can be distributed\n            # accordingly\n            while _len_curr_assigned_partitions_to_node \u003E no_of_partitions:\n                print(f\"removing extra partitions from {consumer_id}\")\n                no_of_partitions_to_remove = _len_curr_assigned_partitions_to_node - no_of_partitions\n                partitions_to_remove = random.sample(list(self.get_assigned_partitions(consumer_id)),\n                                                     no_of_partitions_to_remove)\n                threading.Thread(target=self.notify_remove_partition, args=(consumer_id, partitions_to_remove)).start()\n                _len_curr_assigned_partitions_to_node -= no_of_partitions_to_remove\n\n        self.rebalance_lock.release()\n        self.print_curr_assignment()\n        print(\"Rebalancing Completed\")\n\n    def notify_consumer_member_removed(self, consumer_member_id):\n        \"\"\"\n        remove_consumer_member from the group ie. mark it partitions unassigned and delete mappings\n        consumer_member_id : member id to remove\n        \"\"\"\n        with self.rebalance_lock:\n            for topic_partition_id in self.consumer_nodes_mapping[consumer_member_id]:\n                self.partitions[topic_partition_id] = PartitionStatus.UNASSIGNED.value\n            del self.consumer_nodes_mapping[consumer_member_id]\n            self.consumer_nodes.remove(consumer_member_id)\n\n    def attach_to_topic(self, topic_name):\n        \"\"\"\n        Get topics of partitions and mark them unassigned so that rebalance can assign them to relevant consumers\n        :param topic_name:\n        :return:\n        \"\"\"\n        if not self.is_leader:\n            print(\"Not a leader\")\n            return\n        print(f\"attaching to topic {topic_name}\")\n        with self.rebalance_lock:\n            for partition_id in range(self.broker_client.attach_to_topic(topic_name, self.name)):\n                topic_partition = PartitionTopic(topic_name, partition_id)\n                if topic_partition in self.partitions:\n                    continue\n                self.partitions[topic_partition] = PartitionStatus.UNASSIGNED.value\n\n        self.rebalance_partitions()\n\n    def check_consumer_health(self):\n        \"\"\"\n        Check consumer health from the continuous heart beat they are sending.\n        If we do not receive a heart beat for some time, we will assume the consumer to be dead and\n        remove it from the group.\n        :return:\n        \"\"\"\n        while True:\n            threshold = 10\n            for consumer_node in list(self.consumer_nodes):\n                if time.time() - self.heart_beat[consumer_node] \u003E threshold:\n                    self.notify_consumer_member_removed(consumer_node)\n            time.sleep(3)\n\n    def ping_heart_beat(self, consumer_id):\n        \"\"\"\n        Update heart beat of a consumer\n        :param consumer_id:\n        :return:\n        \"\"\"\n        self.heart_beat[consumer_id] = time.time()\n\n    def get_offset(self, topic_name, partition_id):\n        \"\"\"\n        get offset for a topic\u003C\u003Epartition ID\n        :param topic_name:\n        :param partition_id:\n        :return:\n        \"\"\"\n        return self.offsetClient.get_offset(self.name, topic_name, partition_id)\n\n    def commit_offset(self, topic_name, partition_id, value):\n        \"\"\"\n        commit offset for topic\u003C\u003Epartiton ID\n        :param topic_name:\n        :param partition_id:\n        :param value:\n        :return:\n        \"\"\"\n        return self.offsetClient.commit_offset(self.name, topic_name, partition_id, value)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_76":{"__typename":"Paragraph","id":"7fe442d2f130_76","name":"76bf","type":"H4","href":null,"layout":null,"metadata":null,"text":"GroupCoordinator Client","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_77":{"__typename":"Paragraph","id":"7fe442d2f130_77","name":"cee9","type":"P","href":null,"layout":null,"metadata":null,"text":"It exposes a simple interface so that the consumer and group coordinator can interact with each other.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_78":{"__typename":"Paragraph","id":"7fe442d2f130_78","name":"92fa","type":"PRE","href":null,"layout":null,"metadata":null,"text":"class GroupCoordinatorClient:\n    \"\"\"\n    This class acts as communication intermediary between consumer and consumerGroupCoordinator\n    \"\"\"\n\n    group_coordinator = {}\n    consumers = {}\n\n    @classmethod\n    def join_group_request(cls, group_name, consumer_id, consumer):\n        \"\"\"\n\n        :param group_name:\n        :param consumer_id:\n        :param consumer:\n        :return:\n        \"\"\"\n        cls.consumers[consumer.id] = consumer\n        cls.group_coordinator[group_name].register_consumer_member(consumer_id)\n\n    @classmethod\n    def get_assigned_partitions(cls, group_name, consumer_id):\n        return cls.group_coordinator[group_name].get_assigned_partitions(consumer_id)\n\n    @classmethod\n    def register_group_coordinator(cls, name, group_coordinator):\n        cls.group_coordinator[name] = group_coordinator\n\n    @classmethod\n    def notify_remove_partition(cls, consumer_id, topic_partition_ids):\n        return cls.consumers[consumer_id].notify_partition_removed(topic_partition_ids=topic_partition_ids)\n\n    @classmethod\n    def revoke_partition(cls, group_name, partition_ids, consumer_id):\n        cls.group_coordinator[group_name].mark_partitions_unassigned(consumer_id, partition_ids)\n\n    @classmethod\n    def send_heart_beat(cls, group_name, consumer_id):\n        cls.group_coordinator[group_name].ping_heart_beat(consumer_id=consumer_id)\n\n    @classmethod\n    def stop_consumer(cls, consumer_id):\n        cls.consumers[consumer_id].stop_consumer_gracefully()\n\n    @classmethod\n    def topic_partitions_changed(cls, group_name, topic_name):\n        cls.group_coordinator[group_name].notify_partitions_changed(topic_name)\n\n    @classmethod\n    def get_consumer_group_offset(cls, group_name, topic_name, partition):\n        return cls.group_coordinator[group_name].get_offset(topic_name, partition)\n\n    @classmethod\n    def commit_consumer_group_offset(cls, group_name, topic_name, partition, value):\n        return cls.group_coordinator[group_name].commit_offset(topic_name, partition,value)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_79":{"__typename":"Paragraph","id":"7fe442d2f130_79","name":"8b09","type":"H4","href":null,"layout":null,"metadata":null,"text":"Consumer member and Data Handler","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_80":{"__typename":"Paragraph","id":"7fe442d2f130_80","name":"4a59","type":"P","href":null,"layout":null,"metadata":null,"text":"The consumer member is responsible for joining a group and getting assigned partitions to consume data from. This assignment is a list of PartitionTopics(\u003Ctopic_id\u003E_\u003Cpartition_id\u003E) received from the group coordinator. A consumer can only join one group at a time and sends periodic heartbeats to the group coordinator to indicate its health.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":107,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":229,"end":262,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_81":{"__typename":"Paragraph","id":"7fe442d2f130_81","name":"5ded","type":"P","href":null,"layout":null,"metadata":null,"text":"For each assigned Topic\u003C\u003EPartition_id, the consumer member performs the following actions:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_82":{"__typename":"Paragraph","id":"7fe442d2f130_82","name":"5f49","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Gets the current offset from the Group Coordinator.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_83":{"__typename":"Paragraph","id":"7fe442d2f130_83","name":"0ebc","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Retrieves the next data from the broker for that topic\u003C\u003Epartition.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":66,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_84":{"__typename":"Paragraph","id":"7fe442d2f130_84","name":"8525","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Processes the data and commits the new offset.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_85":{"__typename":"Paragraph","id":"7fe442d2f130_85","name":"935b","type":"P","href":null,"layout":null,"metadata":null,"text":"There are a few interesting fields for the consumer member, such as:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_86":{"__typename":"Paragraph","id":"7fe442d2f130_86","name":"a53c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"max_polling_concurrency: This field defines the degree of parallel processing for all assigned partitions to the consumer. Processing for each topic_partition_id will be done on a parallel basis with a set of worker threads.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_87":{"__typename":"Paragraph","id":"7fe442d2f130_87","name":"b612","type":"ULI","href":null,"layout":null,"metadata":null,"text":"msg_to_consume: This field is used by the consumer to poll the next set of messages from the partition, i.e. it will poll from current_offset to current_offset+msg_to_consume.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_88":{"__typename":"Paragraph","id":"7fe442d2f130_88","name":"c8aa","type":"P","href":null,"layout":null,"metadata":null,"text":"Data Handler: The data handler processes the data consumed by the consumer member. We can define custom data handlers by extending the DataHandler class.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_89":{"__typename":"Paragraph","id":"7fe442d2f130_89","name":"7bd9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"class DataHandler:\n\n    def __init__(self):\n        pass\n\n    def handle(self, data):\n        raise Exception(\"Not Implemented\")\n\n\nclass DefaultDataHandler(DataHandler):\n\n    def handle(self, data):\n        for d in data:\n            print(f\"processing data {d}\")\n\n\nclass ConsumerMember:\n\n    def __init__(self, consumer_group_name, msg_to_consume=10, max_polling_concurrency=5, handler_class=None):\n        self.active = True\n        self.consumer_group = consumer_group_name\n        self.handler = handler_class or DefaultDataHandler()  # handler class to use\n        self.id = str(uuid.uuid4())\n        self.commit_lock = Lock()  # this lock will be used in polling cycle\n        self.group_coordinator_client = GroupCoordinatorClient  # group coordinator client to communicate with group coordinator\n        self.topic_client = Broker  # topic client to communicate with broker\n        self.msg_to_consume = msg_to_consume  # msg to consume from each partition\n        self.max_polling_concurrency = max_polling_concurrency  # max partitions to poll parallely\n        self.join_group()\n\n    def send_heart_beat(self):\n        \"\"\"\n        Send heart beat to coordinator\n        :return:\n        \"\"\"\n        while True:\n            if self.active:\n                self.group_coordinator_client.send_heart_beat(self.consumer_group, self.id)\n            else:\n                return False\n\n    def join_group(self):\n        \"\"\"\n        Join Consumer group\n        :return:\n        \"\"\"\n        self.active = True\n\n        # start heart beat\n        threading.Thread(target=self.send_heart_beat).start()\n\n        time.sleep(1)\n        self.group_coordinator_client.join_group_request(self.consumer_group, self.id, self)\n\n        # start polling\n        threading.Thread(target=self.poll).start()\n        \n    def get_assigned_partitions(self):\n        \"\"\"\n        Get assigned partitions from group coordinator\n        :return:\n        \"\"\"\n        return list(self.group_coordinator_client.get_assigned_partitions(self.consumer_group, self.id))\n\n    def notify_partition_removed(self, topic_partition_ids, *args, **kwargs):\n        \"\"\"\n        Since group coordinator cannot simply remove partition from consumer, as it may lead to uncommitted offsets.\n        This function receives request from group coordinator to remove partition and notifies back once it stops\n        polling so that group coordinator can remove the partitions from this consumer.\n        :param topic_partition_ids: partitions to remove\n        :param args:\n        :param kwargs:\n        :return:\n        \"\"\"\n        print(f\"removing topic partition ids {topic_partition_ids}\")\n        retry_count = 0\n        with self.commit_lock:\n            # take the commit lock so that polling stops, and will be released once partitions\n            # are removed and consumer fetches updated partitions from group coordinator.\n            # This is to ensure no uncommitted offset remains\n            while retry_count \u003C 3:\n                # commit lock to ensure no uncommitted offsets are left before removing the partition\n                try:\n                    # send request to group coordinator to remove partition\n                    self.group_coordinator_client.revoke_partition(self.consumer_group, topic_partition_ids,\n                                                                   consumer_id=self.id)\n\n                    return True\n                except Exception as e:\n                    print(f\"Unable to remove partition{e}\")\n                retry_count += 1\n\n            # if retries exceeded , terminate consumer\n            print(\"max retries exceeded, terminating consumer\")\n            self.active = False\n            return False\n\n    def stop_consumer_gracefully(self, *args, **kwargs):\n        \"\"\"\n        Mark consumer inactive\n        :param args:\n        :param kwargs:\n        :return:\n        \"\"\"\n        print(\"Stopping consumer\")\n        with self.commit_lock:\n            # take commit lock to avoid uncommitted partition\n            self.active = False\n            print(\"stopped_consumer\")\n            return True\n\n    def poll(self):\n        \"\"\"\n        This method polls the data from assigned partitions in parallel, processes and commit the updated offset\n        :return:\n        \"\"\"\n\n        if not self.active:\n            return False\n\n        # If no partitions is assigned, there is noting to do :(\n        while not self.get_assigned_partitions():\n            if not self.active:\n                return False\n            print(\"no_partition_assigned_to_poll\")\n        \n        while True:\n\n            # acquire lock for polling cycle\n            self.commit_lock.acquire()\n\n            if not self.active:\n                self.commit_lock.release()\n                break\n            \n            with concurrent.futures.ThreadPoolExecutor(max_workers=self.max_polling_concurrency) as executor:\n                # Process data from each assigned partition parallely\n                polling_result = [executor.submit(self.poll_data_from_partition, topic_partition_id) for\n                                  topic_partition_id in self.get_assigned_partitions()]\n\n                # Wait for polling cycle to complete before releasing commit lock\n                results = [task.result() for task in polling_result]\n\n            # release lock after polling cycle\n            self.commit_lock.release()\n            time.sleep(1)  # some delay to avoid lock starvation\n\n    def poll_data_from_partition(self, topic_partition):\n        \"\"\"\n        :param topic_partition:\n        Call offset client to get the current offset of topic\u003C\u003Epartition until which data is consumed\n        Call broker client to get data from topic partition from offset to offset+msg to consume\n        Process the data\n        Commit updated offset to offset client\n        Note: If committing new offset fails after data processing or anything in data processing fails itself,\n        consumer will be polling for the same data(as offset is not changed) and keeps processing same data again.\n        (Additional measures can be added to avoid this , like msg deduplication key)\n        :return:\n        \"\"\"\n        try:\n            if isinstance(topic_partition, str):\n                topic_partition = PartitionTopic(topic_name=topic_partition.split(\"::\")[0],\n                                                 partition=int(topic_partition.split(\"::\")[1]))\n            _topic_name = topic_partition.topic_name\n            _partition_id = topic_partition.partition\n            _curr_offset_of_partition = self.group_coordinator_client.get_consumer_group_offset(self.consumer_group,\n                                                                                                _topic_name,\n                                                                                                _partition_id)\n            if _curr_offset_of_partition is None:\n                raise Exception(\"unable to get latest offset\")\n            _data = self.topic_client.poll_data(_topic_name, _partition_id, _curr_offset_of_partition,\n                                                _curr_offset_of_partition + self.msg_to_consume)\n            if not _data:\n                return True\n            print(_data)\n            # handle data\n            self.handler.handle(_data)\n\n            # commit offset\n            result = self.group_coordinator_client.commit_consumer_group_offset(self.consumer_group, _topic_name,\n                                                                                _partition_id,\n                                                                                _curr_offset_of_partition + len(_data))\n\n            if not result:\n                raise Exception(\"unable to commit offset\")\n            print(f\"committed offset for topic_partition_id {_topic_name}_{_partition_id}\")\n            return True\n        except Exception as e:\n            print(f\"Error while processing data {e}\")\n            return False","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_90":{"__typename":"Paragraph","id":"7fe442d2f130_90","name":"6161","type":"H4","href":null,"layout":null,"metadata":null,"text":"Testing","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_91":{"__typename":"Paragraph","id":"7fe442d2f130_91","name":"fd6a","type":"P","href":null,"layout":null,"metadata":null,"text":"Our implementation is complete, we can now write a simple test to verify the functionality.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_92":{"__typename":"Paragraph","id":"7fe442d2f130_92","name":"d5ca","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def test():\n    from group_coordinator.group_coordinator import GroupCoordinator\n    from consumer.group_coordinator_client import GroupCoordinatorClient\n    from broker.broker import Broker\n    from consumer.consumer_member import ConsumerMember\n    from broker.partition_strategy.RR_partition_strategy import RRPartitionStrategy\n    from broker.topic import Data\n    topic_name = \"new_topic\"\n    group_name = \"new_group\"\n    \n    # create topic\n    Broker.create_topic(topic_name, 6, RRPartitionStrategy(), storage_type=ArrayStorage)\n    \n    # create group coordinator\n    consumer_group_coordinator = GroupCoordinator(group_name, is_leader=True)\n    \n    # create consumer members\n    c1 = ConsumerMember(consumer_group_name=group_name)\n    c2 = ConsumerMember(consumer_group_name=group_name)\n    \n    # attach group coordinator to topic(we can attach to multiple topics as well)\n    consumer_group_coordinator.attach_to_topic(topic_name)\n\n    while True:\n        x = input(\"choose action\")\n        if x == \"add_data_to_topic\":\n            # add 100 data items to topic\n            topic_to_add_data = str(input(\"Topic Name ?\"))\n            for i in range(100):\n                Broker.add_data_to_topic(topic_to_add_data, Data(msg=str(i), ttl=None))\n        elif x == \"print_offsets\":\n            # print all offsets\n            from offset_manager.offset_manager import OffsetClient\n            print(OffsetClient.offsets)\n        elif x == \"add_consumer\":\n            # add consumer to the group\n            c4 = ConsumerMember(group_name)\n        elif x == \"kill_consumer\":\n            # kill consumer\n            node_id = str(input(\"provide node id\"))\n            GroupCoordinatorClient.stop_consumer(node_id)\n        elif x == \"add_partition_to_topic\":\n            # add partition to topic\n            topic_to_add_partition = str(input(\"Topic Name ?\"))\n            Broker.add_partition(topic_to_add_partition)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_93":{"__typename":"Paragraph","id":"7fe442d2f130_93","name":"b453","type":"P","href":null,"layout":null,"metadata":null,"text":"Here, Initially, topic partitions will be balanced between 2 consumer nodes:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_94":{"__typename":"Paragraph","id":"7fe442d2f130_94","name":"a3d0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"After connecting to the topic","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*AXMPlLWb_8oyfTjmOoKLeA.png":{"__typename":"ImageMetadata","id":"1*AXMPlLWb_8oyfTjmOoKLeA.png","originalHeight":348,"originalWidth":896,"focusPercentX":null,"focusPercentY":null,"alt":"Initial rebalance after we attach the topic"},"Paragraph:7fe442d2f130_95":{"__typename":"Paragraph","id":"7fe442d2f130_95","name":"3948","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*AXMPlLWb_8oyfTjmOoKLeA.png"},"text":"Initial rebalance with 2 consumers","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_96":{"__typename":"Paragraph","id":"7fe442d2f130_96","name":"5b31","type":"ULI","href":null,"layout":null,"metadata":null,"text":"add_data_to_topic: Adds data to the provided topic. For testing, we will insert 100 records. Here you can check the data partition strategy in use.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*OEuSm93yjc5lGVrruBP-kw.png":{"__typename":"ImageMetadata","id":"1*OEuSm93yjc5lGVrruBP-kw.png","originalHeight":428,"originalWidth":1180,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7fe442d2f130_97":{"__typename":"Paragraph","id":"7fe442d2f130_97","name":"d698","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*OEuSm93yjc5lGVrruBP-kw.png"},"text":"Insert data in topic","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_98":{"__typename":"Paragraph","id":"7fe442d2f130_98","name":"f9ef","type":"ULI","href":null,"layout":null,"metadata":null,"text":"add_consumer: Add a new consumer, and rebalancing will assign it required partitions","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*K_BluB42V--SyoOL-nGeJw.png":{"__typename":"ImageMetadata","id":"1*K_BluB42V--SyoOL-nGeJw.png","originalHeight":360,"originalWidth":978,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7fe442d2f130_99":{"__typename":"Paragraph","id":"7fe442d2f130_99","name":"1253","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*K_BluB42V--SyoOL-nGeJw.png"},"text":"Rebalance after a new consumer added","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_100":{"__typename":"Paragraph","id":"7fe442d2f130_100","name":"30e1","type":"H4","href":null,"layout":null,"metadata":null,"text":"Conclusion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*pP0Jy4uQ1aClkwEz.gif":{"__typename":"ImageMetadata","id":"0*pP0Jy4uQ1aClkwEz.gif","originalHeight":272,"originalWidth":500,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7fe442d2f130_101":{"__typename":"Paragraph","id":"7fe442d2f130_101","name":"1c49","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*pP0Jy4uQ1aClkwEz.gif"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_102":{"__typename":"Paragraph","id":"7fe442d2f130_102","name":"96ea","type":"P","href":null,"layout":null,"metadata":null,"text":"So that’s it, a complete implementation of an in-memory streaming service. Thanks for staying with me this long and I hope it has been a good learning experience.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_103":{"__typename":"Paragraph","id":"7fe442d2f130_103","name":"7f82","type":"P","href":null,"layout":null,"metadata":null,"text":"There might be some edge cases that I missed or was too lazy to fix. Feel free to point out and fix the same.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_104":{"__typename":"Paragraph","id":"7fe442d2f130_104","name":"4314","type":"P","href":null,"layout":null,"metadata":null,"text":"You can find the complete code here.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":31,"end":36,"href":"https:\u002F\u002Fgithub.com\u002FTUSHARZ\u002Fin_memory_streams","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_105":{"__typename":"Paragraph","id":"7fe442d2f130_105","name":"fa02","type":"P","href":null,"layout":null,"metadata":null,"text":"Feel free to drop any questions, comments, or improvements and if you enjoyed the article please support and follow for more.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_106":{"__typename":"Paragraph","id":"7fe442d2f130_106","name":"39b6","type":"H4","href":null,"layout":null,"metadata":null,"text":"Bonus","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_107":{"__typename":"Paragraph","id":"7fe442d2f130_107","name":"72dd","type":"P","href":null,"layout":null,"metadata":null,"text":"Well, this is too much work for just an in-memory solution. So let’s integrate remote storage into our design so we can run consumers in different processes or machines.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7fe442d2f130_108":{"__typename":"Paragraph","id":"7fe442d2f130_108","name":"b30e","type":"P","href":null,"layout":null,"metadata":null,"text":"We will cover this in this article: Design In-memory Streams: Part 2. This is the continuation of the story… | by Tushar Gupta | May, 2023 | Medium","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":36,"end":147,"href":"https:\u002F\u002Fmedium.com\u002F@tg6897\u002Fdesign-in-memory-streams-part-2-76744f7afa11","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Tag:low-level-design":{"__typename":"Tag","id":"low-level-design","displayTitle":"Low Level Design","normalizedTagSlug":"low-level-design"},"Tag:system-design-interview":{"__typename":"Tag","id":"system-design-interview","displayTitle":"System Design Interview","normalizedTagSlug":"system-design-interview"},"Tag:kafka":{"__typename":"Tag","id":"kafka","displayTitle":"Kafka","normalizedTagSlug":"kafka"},"Tag:techno":{"__typename":"Tag","id":"techno","displayTitle":"Techno","normalizedTagSlug":"techno"},"Tag:data-streaming":{"__typename":"Tag","id":"data-streaming","displayTitle":"Data Streaming","normalizedTagSlug":"data-streaming"},"Post:e47e49068028":{"__typename":"Post","id":"e47e49068028","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"b02c","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"3884","startIndex":4,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"5452","startIndex":15,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"ccec","startIndex":41,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"d0c1","startIndex":44,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"4081","startIndex":52,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"94e4","startIndex":56,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"4ee5","startIndex":59,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"fbd5","startIndex":63,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"7add","startIndex":67,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"0396","startIndex":76,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"de83","startIndex":79,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"1c79","startIndex":90,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:7fe442d2f130_0"},{"__ref":"Paragraph:7fe442d2f130_1"},{"__ref":"Paragraph:7fe442d2f130_2"},{"__ref":"Paragraph:7fe442d2f130_3"},{"__ref":"Paragraph:7fe442d2f130_4"},{"__ref":"Paragraph:7fe442d2f130_5"},{"__ref":"Paragraph:7fe442d2f130_6"},{"__ref":"Paragraph:7fe442d2f130_7"},{"__ref":"Paragraph:7fe442d2f130_8"},{"__ref":"Paragraph:7fe442d2f130_9"},{"__ref":"Paragraph:7fe442d2f130_10"},{"__ref":"Paragraph:7fe442d2f130_11"},{"__ref":"Paragraph:7fe442d2f130_12"},{"__ref":"Paragraph:7fe442d2f130_13"},{"__ref":"Paragraph:7fe442d2f130_14"},{"__ref":"Paragraph:7fe442d2f130_15"},{"__ref":"Paragraph:7fe442d2f130_16"},{"__ref":"Paragraph:7fe442d2f130_17"},{"__ref":"Paragraph:7fe442d2f130_18"},{"__ref":"Paragraph:7fe442d2f130_19"},{"__ref":"Paragraph:7fe442d2f130_20"},{"__ref":"Paragraph:7fe442d2f130_21"},{"__ref":"Paragraph:7fe442d2f130_22"},{"__ref":"Paragraph:7fe442d2f130_23"},{"__ref":"Paragraph:7fe442d2f130_24"},{"__ref":"Paragraph:7fe442d2f130_25"},{"__ref":"Paragraph:7fe442d2f130_26"},{"__ref":"Paragraph:7fe442d2f130_27"},{"__ref":"Paragraph:7fe442d2f130_28"},{"__ref":"Paragraph:7fe442d2f130_29"},{"__ref":"Paragraph:7fe442d2f130_30"},{"__ref":"Paragraph:7fe442d2f130_31"},{"__ref":"Paragraph:7fe442d2f130_32"},{"__ref":"Paragraph:7fe442d2f130_33"},{"__ref":"Paragraph:7fe442d2f130_34"},{"__ref":"Paragraph:7fe442d2f130_35"},{"__ref":"Paragraph:7fe442d2f130_36"},{"__ref":"Paragraph:7fe442d2f130_37"},{"__ref":"Paragraph:7fe442d2f130_38"},{"__ref":"Paragraph:7fe442d2f130_39"},{"__ref":"Paragraph:7fe442d2f130_40"},{"__ref":"Paragraph:7fe442d2f130_41"},{"__ref":"Paragraph:7fe442d2f130_42"},{"__ref":"Paragraph:7fe442d2f130_43"},{"__ref":"Paragraph:7fe442d2f130_44"},{"__ref":"Paragraph:7fe442d2f130_45"},{"__ref":"Paragraph:7fe442d2f130_46"},{"__ref":"Paragraph:7fe442d2f130_47"},{"__ref":"Paragraph:7fe442d2f130_48"},{"__ref":"Paragraph:7fe442d2f130_49"},{"__ref":"Paragraph:7fe442d2f130_50"},{"__ref":"Paragraph:7fe442d2f130_51"},{"__ref":"Paragraph:7fe442d2f130_52"},{"__ref":"Paragraph:7fe442d2f130_53"},{"__ref":"Paragraph:7fe442d2f130_54"},{"__ref":"Paragraph:7fe442d2f130_55"},{"__ref":"Paragraph:7fe442d2f130_56"},{"__ref":"Paragraph:7fe442d2f130_57"},{"__ref":"Paragraph:7fe442d2f130_58"},{"__ref":"Paragraph:7fe442d2f130_59"},{"__ref":"Paragraph:7fe442d2f130_60"},{"__ref":"Paragraph:7fe442d2f130_61"},{"__ref":"Paragraph:7fe442d2f130_62"},{"__ref":"Paragraph:7fe442d2f130_63"},{"__ref":"Paragraph:7fe442d2f130_64"},{"__ref":"Paragraph:7fe442d2f130_65"},{"__ref":"Paragraph:7fe442d2f130_66"},{"__ref":"Paragraph:7fe442d2f130_67"},{"__ref":"Paragraph:7fe442d2f130_68"},{"__ref":"Paragraph:7fe442d2f130_69"},{"__ref":"Paragraph:7fe442d2f130_70"},{"__ref":"Paragraph:7fe442d2f130_71"},{"__ref":"Paragraph:7fe442d2f130_72"},{"__ref":"Paragraph:7fe442d2f130_73"},{"__ref":"Paragraph:7fe442d2f130_74"},{"__ref":"Paragraph:7fe442d2f130_75"},{"__ref":"Paragraph:7fe442d2f130_76"},{"__ref":"Paragraph:7fe442d2f130_77"},{"__ref":"Paragraph:7fe442d2f130_78"},{"__ref":"Paragraph:7fe442d2f130_79"},{"__ref":"Paragraph:7fe442d2f130_80"},{"__ref":"Paragraph:7fe442d2f130_81"},{"__ref":"Paragraph:7fe442d2f130_82"},{"__ref":"Paragraph:7fe442d2f130_83"},{"__ref":"Paragraph:7fe442d2f130_84"},{"__ref":"Paragraph:7fe442d2f130_85"},{"__ref":"Paragraph:7fe442d2f130_86"},{"__ref":"Paragraph:7fe442d2f130_87"},{"__ref":"Paragraph:7fe442d2f130_88"},{"__ref":"Paragraph:7fe442d2f130_89"},{"__ref":"Paragraph:7fe442d2f130_90"},{"__ref":"Paragraph:7fe442d2f130_91"},{"__ref":"Paragraph:7fe442d2f130_92"},{"__ref":"Paragraph:7fe442d2f130_93"},{"__ref":"Paragraph:7fe442d2f130_94"},{"__ref":"Paragraph:7fe442d2f130_95"},{"__ref":"Paragraph:7fe442d2f130_96"},{"__ref":"Paragraph:7fe442d2f130_97"},{"__ref":"Paragraph:7fe442d2f130_98"},{"__ref":"Paragraph:7fe442d2f130_99"},{"__ref":"Paragraph:7fe442d2f130_100"},{"__ref":"Paragraph:7fe442d2f130_101"},{"__ref":"Paragraph:7fe442d2f130_102"},{"__ref":"Paragraph:7fe442d2f130_103"},{"__ref":"Paragraph:7fe442d2f130_104"},{"__ref":"Paragraph:7fe442d2f130_105"},{"__ref":"Paragraph:7fe442d2f130_106"},{"__ref":"Paragraph:7fe442d2f130_107"},{"__ref":"Paragraph:7fe442d2f130_108"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:bf5235fee8bb"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002F@tg6897\u002Fdesign-in-memory-streams-e47e49068028","primaryTopic":null,"topics":[],"isPublished":true,"latestPublishedVersion":"7fe442d2f130","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":1},"createdAt":1672931778291,"firstPublishedAt":1684059180855,"latestPublishedAt":1684060361309,"clapCount":57,"allowResponses":true,"isLimitedState":false,"title":"Design In-memory Streams","isSeries":false,"sequence":null,"uniqueSlug":"design-in-memory-streams-e47e49068028","socialTitle":"","socialDek":"","noIndex":null,"canonicalUrl":"","metaDescription":"","readingTime":20.34433962264151,"previewContent":{"__typename":"PreviewContent","subtitle":"Data streaming has become the backbone of scalable systems as it helps process large volumes of real-time data which is further used in…"},"previewImage":{"__ref":"ImageMetadata:1*CkCNI9SsiPRmpCG45hZCzQ.png"},"isShortform":false,"seoTitle":"","updatedAt":1684060366665,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:low-level-design"},{"__ref":"Tag:system-design-interview"},{"__ref":"Tag:kafka"},{"__ref":"Tag:techno"},{"__ref":"Tag:data-streaming"}],"pendingCollection":null,"statusForCollection":null,"detectedLanguage":"en","wordCount":5113,"layerCake":0},"ImageMetadata:0*kHwVnlY4KH19k1Mx":{"__typename":"ImageMetadata","id":"0*kHwVnlY4KH19k1Mx","focusPercentX":null,"focusPercentY":null,"alt":null},"User:b204920440ba":{"__typename":"User","id":"b204920440ba","name":"Suresh Podeti","username":"sureshpodeti","mediumMemberAt":0,"socialStats":{"__typename":"SocialStats","followerCount":234},"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"customDomainState":null,"hasSubdomain":false,"bio":"Co-Founder at Rupant Technologies.","imageId":"1*H_EnDOcdsYqeLA5LLTzX1Q.jpeg","membership":null},"Post:a77edb38b191":{"__typename":"Post","id":"a77edb38b191","title":"WebSockets","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"In the dynamic world of web applications, responsiveness and real-time communication have become crucial aspects of user experience…","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:0*kHwVnlY4KH19k1Mx"},"creator":{"__ref":"User:b204920440ba"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fmedium.com\u002F@sureshpodeti\u002Fwebsockets-a77edb38b191","collection":null,"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":0},"visibility":"PUBLIC","clapCount":6,"pendingCollection":null,"statusForCollection":null,"pinnedAt":0,"latestPublishedAt":1698300360168,"firstPublishedAt":1698300360168,"readingTime":2.2792452830188683,"isLocked":false,"sequence":null,"isSeries":false,"uniqueSlug":"websockets-a77edb38b191"},"ImageMetadata:1*QgyRjMvfMwM9UdFRvHEhrQ.png":{"__typename":"ImageMetadata","id":"1*QgyRjMvfMwM9UdFRvHEhrQ.png","focusPercentX":null,"focusPercentY":null,"alt":null},"User:a1babd0c10b6":{"__typename":"User","id":"a1babd0c10b6","name":"York Wei","username":"the.york.wei","mediumMemberAt":0,"socialStats":{"__typename":"SocialStats","followerCount":222},"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"customDomainState":null,"hasSubdomain":false,"bio":"Just sharing my thoughts on technology, software, and distributed system design.","imageId":"1*o4Px_sFBZdfrTgjJSFEHpA.jpeg","membership":null},"Post:e3bf30d1044c":{"__typename":"Post","id":"e3bf30d1044c","title":"System Design: Twitter","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"We are designing a system like the social media platform Twitter. Users can post short text and media content. Viewers can search and…","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:1*QgyRjMvfMwM9UdFRvHEhrQ.png"},"creator":{"__ref":"User:a1babd0c10b6"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fmedium.com\u002F@the.york.wei\u002Fsystem-design-twitter-e3bf30d1044c","collection":null,"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":1},"visibility":"LOCKED","clapCount":51,"pendingCollection":null,"statusForCollection":null,"pinnedAt":0,"latestPublishedAt":1690003017389,"firstPublishedAt":1690003017389,"readingTime":2.379559748427673,"isLocked":true,"sequence":null,"isSeries":false,"uniqueSlug":"system-design-twitter-e3bf30d1044c"},"ImageMetadata:0*ms15sm3quRbb0Ky4.gif":{"__typename":"ImageMetadata","id":"0*ms15sm3quRbb0Ky4.gif","focusPercentX":null,"focusPercentY":null,"alt":"What are Webhooks and How to Use Them"},"User:f0c8fcbec7a2":{"__typename":"User","id":"f0c8fcbec7a2","name":"Learn With Whiteboard","username":"learnwithwhiteboard_digest","mediumMemberAt":0,"socialStats":{"__typename":"SocialStats","followerCount":1092},"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"customDomainState":null,"hasSubdomain":false,"bio":"Get byte-size whiteboard lessons to help you increase your tech and non tech vocabulary.","imageId":"1*aJ-0u8l-tql1EEz7WQ7Wzw.jpeg","membership":null},"Post:2fb65605d323":{"__typename":"Post","id":"2fb65605d323","title":"What are Webhooks and How to Use Them","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"Webhooks 101: Everything You Need to Know About Real-Time Web Integration","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:0*ms15sm3quRbb0Ky4.gif"},"creator":{"__ref":"User:f0c8fcbec7a2"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fmedium.com\u002F@learnwithwhiteboard_digest\u002Fwhat-are-webhooks-and-how-to-use-them-2fb65605d323","collection":null,"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":0},"visibility":"PUBLIC","clapCount":2,"pendingCollection":null,"statusForCollection":null,"pinnedAt":0,"latestPublishedAt":1700484114384,"firstPublishedAt":1700484114384,"readingTime":7.235849056603774,"isLocked":false,"sequence":null,"isSeries":false,"uniqueSlug":"what-are-webhooks-and-how-to-use-them-2fb65605d323"},"ImageMetadata:0*wg80F_uJi0s8lNuz.png":{"__typename":"ImageMetadata","id":"0*wg80F_uJi0s8lNuz.png","focusPercentX":null,"focusPercentY":null,"alt":null},"User:2e1f48c56d56":{"__typename":"User","id":"2e1f48c56d56","name":"Arindam Paul","username":"geekpaul","mediumMemberAt":0,"socialStats":{"__typename":"SocialStats","followerCount":330},"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"geekpaul.medium.com"}},"hasSubdomain":true,"bio":"Staff Software Engineer at Uber","imageId":"0*muQIIHi5S4_sgN-X.jpg","membership":null},"Post:4d3aa9aec31c":{"__typename":"Post","id":"4d3aa9aec31c","title":"System Design: Building an In-Memory Key-Value Store (JS)","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"Design a simple in memory key-value store which provides, basic get, set and delete operations. Once done, add transactional support to it…","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:0*wg80F_uJi0s8lNuz.png"},"creator":{"__ref":"User:2e1f48c56d56"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fgeekpaul.medium.com\u002Fsystem-design-building-an-in-memory-key-value-store-js-4d3aa9aec31c","collection":null,"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":0},"visibility":"PUBLIC","clapCount":3,"pendingCollection":null,"statusForCollection":null,"pinnedAt":0,"latestPublishedAt":1688403056654,"firstPublishedAt":1688402947230,"readingTime":7.037735849056604,"isLocked":false,"sequence":null,"isSeries":false,"uniqueSlug":"system-design-building-an-in-memory-key-value-store-js-4d3aa9aec31c"},"ImageMetadata:1*jXRO9mIZ-T6lk-vipfs9Iw.png":{"__typename":"ImageMetadata","id":"1*jXRO9mIZ-T6lk-vipfs9Iw.png","focusPercentX":null,"focusPercentY":null,"alt":null},"User:a927ff67ee5":{"__typename":"User","id":"a927ff67ee5","name":"Dunith Danushka","username":"dunith","mediumMemberAt":1698827033000,"socialStats":{"__typename":"SocialStats","followerCount":2273},"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"dunith.medium.com"}},"hasSubdomain":true,"bio":"Editor of Tributary Data. Technologist, Writer, Senior Developer Advocate at Redpanda. Opinions are my own.","imageId":"1*6QgK80Oqp39NYWfviOmDag.png","membership":{"__ref":"Membership:565abbfcf58b"}},"Collection:daae533d1864":{"__typename":"Collection","id":"daae533d1864","slug":"event-driven-utopia","name":"Tributary Data","domain":null,"description":"This publication covers insightful articles, solution blueprints, opinions, and cutting-edge trends in the fields of data engineering, analytics, and streaming data.","subscriberCount":1068,"avatar":{"__ref":"ImageMetadata:1*BSaPBIKtXqmo4Hcyg09JEQ.png"}},"Membership:565abbfcf58b":{"__typename":"Membership","tier":"MEMBER","id":"565abbfcf58b"},"ImageMetadata:1*BSaPBIKtXqmo4Hcyg09JEQ.png":{"__typename":"ImageMetadata","id":"1*BSaPBIKtXqmo4Hcyg09JEQ.png"},"Post:c6e86a8296e1":{"__typename":"Post","id":"c6e86a8296e1","title":"Stream Processing Basics — Stateless Operations","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"A technology-agnostic explanation of stateless operators in stream processing.","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:1*jXRO9mIZ-T6lk-vipfs9Iw.png"},"creator":{"__ref":"User:a927ff67ee5"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Fevent-driven-utopia\u002Fstream-processing-basics-stateless-operations-c6e86a8296e1","collection":{"__ref":"Collection:daae533d1864"},"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":0},"visibility":"LOCKED","clapCount":71,"pendingCollection":null,"statusForCollection":"APPROVED","pinnedAt":0,"latestPublishedAt":1700494183364,"firstPublishedAt":1700494183364,"readingTime":4.40377358490566,"isLocked":true,"sequence":null,"isSeries":false,"uniqueSlug":"stream-processing-basics-stateless-operations-c6e86a8296e1"},"ImageMetadata:1*zWDMCeterfUrICSSP5W34A.jpeg":{"__typename":"ImageMetadata","id":"1*zWDMCeterfUrICSSP5W34A.jpeg","focusPercentX":null,"focusPercentY":null,"alt":null},"User:ccf8ff243c25":{"__typename":"User","id":"ccf8ff243c25","name":"System Design By CHK","username":"systemdesignbychk","mediumMemberAt":0,"socialStats":{"__typename":"SocialStats","followerCount":521},"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"customDomainState":{"__typename":"CustomDomainState","live":null},"hasSubdomain":false,"bio":"System Design, Design Refactoring and Product Development. Author — Chandrakant Kori (https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fsystem-design-interview\u002F)","imageId":"1*rPFZ8HjB22JLGNyDB8XZlg.png","membership":null},"Post:351fcad33de0":{"__typename":"Post","id":"351fcad33de0","title":"System Design — Achieving Consistency Using Transaction Outbox Pattern","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"In today’s distributed systems, maintaining consistency across multiple services can be complex, particularly in scenarios like order…","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:1*zWDMCeterfUrICSSP5W34A.jpeg"},"creator":{"__ref":"User:ccf8ff243c25"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fmedium.com\u002F@systemdesignbychk\u002Fsystem-design-achieving-consistency-using-transaction-outbox-pattern-351fcad33de0","collection":null,"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":0},"visibility":"PUBLIC","clapCount":56,"pendingCollection":null,"statusForCollection":null,"pinnedAt":0,"latestPublishedAt":1686393570224,"firstPublishedAt":1686393455241,"readingTime":2.5207547169811324,"isLocked":false,"sequence":null,"isSeries":false,"uniqueSlug":"system-design-achieving-consistency-using-transaction-outbox-pattern-351fcad33de0"},"User:cd694379bdff":{"__typename":"User","username":"william.dai","id":"cd694379bdff","customDomainState":null,"hasSubdomain":false},"CatalogViewerEdge:catalogId:d8e941a8265f-viewerId:lo_637abe8e8c62":{"__typename":"CatalogViewerEdge","followersCount":198,"id":"catalogId:d8e941a8265f-viewerId:lo_637abe8e8c62"},"ImageMetadata:1*5eWqBgW5YPFY1SXPu8YkZw.jpeg":{"__typename":"ImageMetadata","id":"1*5eWqBgW5YPFY1SXPu8YkZw.jpeg","alt":"Databricks role-based and specialty certification line-up."},"Post:a55f84478c66":{"__typename":"Post","previewImage":{"__ref":"ImageMetadata:1*5eWqBgW5YPFY1SXPu8YkZw.jpeg"},"id":"a55f84478c66"},"CatalogItemV2:{\"catalogItemId\":\"64aa0d844b220edd4bf735cb\"}":{"__typename":"CatalogItemV2","catalogItemId":"64aa0d844b220edd4bf735cb","entity":{"__ref":"Post:a55f84478c66"}},"ImageMetadata:0*zcJa6-vVfQ1ESpQh.png":{"__typename":"ImageMetadata","id":"0*zcJa6-vVfQ1ESpQh.png","alt":null},"Post:9a325b2f1b17":{"__typename":"Post","previewImage":{"__ref":"ImageMetadata:0*zcJa6-vVfQ1ESpQh.png"},"id":"9a325b2f1b17"},"CatalogItemV2:{\"catalogItemId\":\"640c272f665be4da892df879\"}":{"__typename":"CatalogItemV2","catalogItemId":"640c272f665be4da892df879","entity":{"__ref":"Post:9a325b2f1b17"}},"ImageMetadata:1*Cw-ig4gq9DXIqEXANhNvqQ.jpeg":{"__typename":"ImageMetadata","id":"1*Cw-ig4gq9DXIqEXANhNvqQ.jpeg","alt":null},"Post:255c5de9f67d":{"__typename":"Post","previewImage":{"__ref":"ImageMetadata:1*Cw-ig4gq9DXIqEXANhNvqQ.jpeg"},"id":"255c5de9f67d"},"CatalogItemV2:{\"catalogItemId\":\"63fc775f35ac6e382f606006\"}":{"__typename":"CatalogItemV2","catalogItemId":"63fc775f35ac6e382f606006","entity":{"__ref":"Post:255c5de9f67d"}},"ImageMetadata:0*H92fOk6xK_oDEIkT":{"__typename":"ImageMetadata","id":"0*H92fOk6xK_oDEIkT","alt":null},"Post:c445b6c0712d":{"__typename":"Post","previewImage":{"__ref":"ImageMetadata:0*H92fOk6xK_oDEIkT"},"id":"c445b6c0712d"},"CatalogItemV2:{\"catalogItemId\":\"63eb589f651cc18fd371e228\"}":{"__typename":"CatalogItemV2","catalogItemId":"63eb589f651cc18fd371e228","entity":{"__ref":"Post:c445b6c0712d"}},"ImageMetadata:1*sYHiUkJdawisp4LSYh-5vQ.jpeg":{"__typename":"ImageMetadata","id":"1*sYHiUkJdawisp4LSYh-5vQ.jpeg","alt":null},"Post:f787b185aa57":{"__typename":"Post","previewImage":{"__ref":"ImageMetadata:1*sYHiUkJdawisp4LSYh-5vQ.jpeg"},"id":"f787b185aa57"},"CatalogItemV2:{\"catalogItemId\":\"63eb28ddf0060edddb8da34b\"}":{"__typename":"CatalogItemV2","catalogItemId":"63eb28ddf0060edddb8da34b","entity":{"__ref":"Post:f787b185aa57"}},"Catalog:d8e941a8265f":{"__typename":"Catalog","id":"d8e941a8265f","name":"New_Reading_List","postItemsCount":174,"predefined":null,"creator":{"__ref":"User:cd694379bdff"},"viewerEdge":{"__ref":"CatalogViewerEdge:catalogId:d8e941a8265f-viewerId:lo_637abe8e8c62"},"itemsConnection:(limit:5)":{"__typename":"CatalogItemsConnection","items":[{"__ref":"CatalogItemV2:{\"catalogItemId\":\"64aa0d844b220edd4bf735cb\"}"},{"__ref":"CatalogItemV2:{\"catalogItemId\":\"640c272f665be4da892df879\"}"},{"__ref":"CatalogItemV2:{\"catalogItemId\":\"63fc775f35ac6e382f606006\"}"},{"__ref":"CatalogItemV2:{\"catalogItemId\":\"63eb589f651cc18fd371e228\"}"},{"__ref":"CatalogItemV2:{\"catalogItemId\":\"63eb28ddf0060edddb8da34b\"}"}]}},"User:2eb23a991a63":{"__typename":"User","username":"AMGAS14","id":"2eb23a991a63","customDomainState":null,"hasSubdomain":false},"CatalogViewerEdge:catalogId:0a856388a93a-viewerId:lo_637abe8e8c62":{"__typename":"CatalogViewerEdge","followersCount":413,"id":"catalogId:0a856388a93a-viewerId:lo_637abe8e8c62"},"ImageMetadata:1*4OR13xMgpAi0luqiE_3T9w.png":{"__typename":"ImageMetadata","id":"1*4OR13xMgpAi0luqiE_3T9w.png","alt":null},"Post:32aa13046ed5":{"__typename":"Post","previewImage":{"__ref":"ImageMetadata:1*4OR13xMgpAi0luqiE_3T9w.png"},"id":"32aa13046ed5"},"CatalogItemV2:{\"catalogItemId\":\"6560763a96830477e969ecce\"}":{"__typename":"CatalogItemV2","catalogItemId":"6560763a96830477e969ecce","entity":{"__ref":"Post:32aa13046ed5"}},"ImageMetadata:1*paPlyErkyfOkRPVUNlyBig.png":{"__typename":"ImageMetadata","id":"1*paPlyErkyfOkRPVUNlyBig.png","alt":null},"Post:82f616be7d34":{"__typename":"Post","previewImage":{"__ref":"ImageMetadata:1*paPlyErkyfOkRPVUNlyBig.png"},"id":"82f616be7d34"},"CatalogItemV2:{\"catalogItemId\":\"65607630e22833704177bf94\"}":{"__typename":"CatalogItemV2","catalogItemId":"65607630e22833704177bf94","entity":{"__ref":"Post:82f616be7d34"}},"ImageMetadata:0*KGAoMj_kp91ianj5":{"__typename":"ImageMetadata","id":"0*KGAoMj_kp91ianj5","alt":null},"Post:8155785e1354":{"__typename":"Post","previewImage":{"__ref":"ImageMetadata:0*KGAoMj_kp91ianj5"},"id":"8155785e1354"},"CatalogItemV2:{\"catalogItemId\":\"656076276a50e8e07147aecc\"}":{"__typename":"CatalogItemV2","catalogItemId":"656076276a50e8e07147aecc","entity":{"__ref":"Post:8155785e1354"}},"ImageMetadata:0*6MLxWzm6mAWT2SfO":{"__typename":"ImageMetadata","id":"0*6MLxWzm6mAWT2SfO","alt":""},"Post:7efca1965baa":{"__typename":"Post","previewImage":{"__ref":"ImageMetadata:0*6MLxWzm6mAWT2SfO"},"id":"7efca1965baa"},"CatalogItemV2:{\"catalogItemId\":\"65607616246ebe7414ce0adc\"}":{"__typename":"CatalogItemV2","catalogItemId":"65607616246ebe7414ce0adc","entity":{"__ref":"Post:7efca1965baa"}},"ImageMetadata:1*DGWMpvCoARAD_L-cdDSFaQ.png":{"__typename":"ImageMetadata","id":"1*DGWMpvCoARAD_L-cdDSFaQ.png","alt":null},"Post:8a432ed232a4":{"__typename":"Post","previewImage":{"__ref":"ImageMetadata:1*DGWMpvCoARAD_L-cdDSFaQ.png"},"id":"8a432ed232a4"},"CatalogItemV2:{\"catalogItemId\":\"656075f4b712fdac7700a70a\"}":{"__typename":"CatalogItemV2","catalogItemId":"656075f4b712fdac7700a70a","entity":{"__ref":"Post:8a432ed232a4"}},"Catalog:0a856388a93a":{"__typename":"Catalog","id":"0a856388a93a","name":"Natural Language Processing","postItemsCount":889,"predefined":null,"creator":{"__ref":"User:2eb23a991a63"},"viewerEdge":{"__ref":"CatalogViewerEdge:catalogId:0a856388a93a-viewerId:lo_637abe8e8c62"},"itemsConnection:(limit:5)":{"__typename":"CatalogItemsConnection","items":[{"__ref":"CatalogItemV2:{\"catalogItemId\":\"6560763a96830477e969ecce\"}"},{"__ref":"CatalogItemV2:{\"catalogItemId\":\"65607630e22833704177bf94\"}"},{"__ref":"CatalogItemV2:{\"catalogItemId\":\"656076276a50e8e07147aecc\"}"},{"__ref":"CatalogItemV2:{\"catalogItemId\":\"65607616246ebe7414ce0adc\"}"},{"__ref":"CatalogItemV2:{\"catalogItemId\":\"656075f4b712fdac7700a70a\"}"}]}},"ImageMetadata:1*sjVOwlMIKGOI8ehdXtepsg.png":{"__typename":"ImageMetadata","id":"1*sjVOwlMIKGOI8ehdXtepsg.png","focusPercentX":null,"focusPercentY":null,"alt":"Class Diagram"},"Post:52d33adceb91":{"__typename":"Post","id":"52d33adceb91","title":"Design  In-Memory DB with indexing","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"Here we will design,implement a complete In-memory database with indexing.Helpful for machine coding\u002Fsystemdesign round in  SDE interviews.","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:1*sjVOwlMIKGOI8ehdXtepsg.png"},"creator":{"__ref":"User:bf5235fee8bb"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fmedium.com\u002F@tg6897\u002Fdesign-in-memory-db-with-indexing-52d33adceb91","collection":null,"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":1},"visibility":"PUBLIC","clapCount":34,"pendingCollection":null,"statusForCollection":null,"pinnedAt":0,"latestPublishedAt":1671951628789,"firstPublishedAt":1671951628789,"readingTime":9.415094339622641,"isLocked":false,"sequence":null,"isSeries":false,"uniqueSlug":"design-in-memory-db-with-indexing-52d33adceb91"},"ImageMetadata:1*ToCNOXaPjaPzFkRRVmj_Mw.png":{"__typename":"ImageMetadata","id":"1*ToCNOXaPjaPzFkRRVmj_Mw.png","focusPercentX":null,"focusPercentY":null,"alt":null},"Post:76744f7afa11":{"__typename":"Post","id":"76744f7afa11","title":"Design In-memory Streams: Part 2","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"This is the continuation of the story Design In-memory Streams in which we designed a data streaming service in memory.","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:1*ToCNOXaPjaPzFkRRVmj_Mw.png"},"creator":{"__ref":"User:bf5235fee8bb"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fmedium.com\u002F@tg6897\u002Fdesign-in-memory-streams-part-2-76744f7afa11","collection":null,"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":0},"visibility":"PUBLIC","clapCount":2,"pendingCollection":null,"statusForCollection":null,"pinnedAt":0,"latestPublishedAt":1684138197071,"firstPublishedAt":1684060167599,"readingTime":15.504716981132075,"isLocked":false,"sequence":null,"isSeries":false,"uniqueSlug":"design-in-memory-streams-part-2-76744f7afa11"}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT","inDisabledExperiment":false}}</script><script src="./Design In-memory Streams._files/manifest.b035d484.js.download"></script><script src="./Design In-memory Streams._files/3057.5e22bbb0.js.download"></script><script src="./Design In-memory Streams._files/main.b1da0f20.js.download"></script><script src="./Design In-memory Streams._files/instrumentation.d6d5fe73.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/reporting.2021fe63.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/120.a1050cd4.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/1752.0a0e21e3.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/6733.1d85727b.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/4711.043615ac.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/8695.09acff9e.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/4341.09a484a0.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/3154.23d7fa54.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/5203.e7a22052.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/1957.fe63a49e.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/9599.a664b775.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/1711.02ed88a9.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/5268.5f96ae45.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/9114.49b6b911.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/5459.80a6ee18.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/6804.4b5be6c2.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/9174.7b097d16.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/4129.ee8ae2c8.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/8580.feeb2549.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/1802.694a29bf.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/2295.fc4d4022.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/4078.da7800a7.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/8883.c8b03d13.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/2550.1e47c72a.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/9408.a4724b16.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/397.2e086ee7.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/9150.42fafb2e.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/5005.b5d4a37c.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/2393.c616f1d3.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/5404.d8739341.chunk.js.download"></script>
<script src="./Design In-memory Streams._files/PostPage.MainContent.e3ef0896.chunk.js.download"></script><script>window.main();</script><script defer="" src="./Design In-memory Streams._files/v84a3a4012de94ce1a686ba8c167c359c1696973893317" integrity="sha512-euoFGowhlaLqXsPWQ48qSkBSCFs3DPRyiwVu3FjR96cMPx+Fr+gpWRhIafcHwqwCqWS42RZhIudOvEI+Ckf6MA==" data-cf-beacon="{&quot;rayId&quot;:&quot;82bab347b910a90e&quot;,&quot;version&quot;:&quot;2023.10.0&quot;,&quot;token&quot;:&quot;0b5f665943484354a59c39c6833f7078&quot;}" crossorigin="anonymous"></script>
<script src="./Design In-memory Streams._files/client" async=""></script></body></html>